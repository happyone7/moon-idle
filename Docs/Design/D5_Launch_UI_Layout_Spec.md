# D5 — 발사 애니메이션 UI 레이아웃 구현 스펙

| 항목 | 내용 |
|------|------|
| **문서 ID** | D5_Launch_UI_Layout_Spec |
| **작성자** | 총괄PD |
| **작성일** | 2026-02-25 |
| **버전** | v1.0 |
| **상태** | 구현 가이드 (확정) |
| **참조 문서** | `D5_Rocket_ASCII_Art_Design.md`, `js/tabs/launch.js`, `js/rocket-ascii.js` |

---

## 1. 현재 문제점 분석

### 1.1 의도 vs 현실

| 구분 | D5 문서 의도 | 현재 실제 렌더링 |
|------|-------------|-----------------|
| **로켓 아트** | 화면 중앙에 크게 표시 | `top:40%`에 13px로 배치 — OK |
| **이펙트 아트** (화염, 폭발, 잔해 등) | 로켓과 통합된 전체 화면 연출 | `bottom:12px`에 11px로 조그맣게 표시 |
| **배경 씬** (지구, 달, 우주) | 로켓 뒤 전체 배경으로 작동 | `fullScene`만 중앙 배치, 나머지는 하단 |
| **실패 폭발** | 로켓이 폭발로 교체되며 화면 전체 연출 | 로켓은 그대로 + 하단에 작은 폭발 텍스트 |

### 1.2 근본 원인

현재 `launch-anim-wrap` 내부 레이아웃이 **3개 독립 레이어**로 분리되어 있음:

```
┌─────────────────────────────────────────┐
│ [launch-stage-label]  z:3  top:8px      │ ← 단계 이름 (OK)
│                                         │
│ [launch-rocket-cnt]   z:2  top:40%      │ ← 로켓 아트 (고정 위치)
│   └ [launch-rocket-pre]  13px           │
│                                         │
│ [launch-stage-info]   z:3  bottom:12px  │ ← ★ 여기에 이펙트가 나옴 (작음!)
│                                         │
│ [launch-parallax]     z:1  배경          │ ← 패럴랙스 (OK)
└─────────────────────────────────────────┘
```

**문제**: `launch-stage-info`는 원래 "보조 텍스트 정보" 용도이나,
여기에 화염/폭발/배경씬 ASCII 아트까지 모두 밀어넣고 있음.
11px, `bottom:12px` 고정이라 아무리 큰 아트를 넣어도 **하단에 조그맣게** 나옴.

---

## 2. 목표 레이아웃

### 2.1 화면 레이어 구조 (올바른 설계)

```
┌═══════════════════════════════════════════════════════════════════┐
│                    .launch-anim-wrap (전체 화면)                    │
│                                                                   │
│  z:1 ┌───────────────────────────────────────────────────┐       │
│      │         [launch-parallax] — 패럴랙스 배경           │       │
│      │         지상 → 구름 → 대기 → 우주 스크롤            │       │
│      └───────────────────────────────────────────────────┘       │
│                                                                   │
│  z:2 ┌───────────────────────────────────────────────────┐       │
│      │      [launch-scene] — 메인 씬 영역 (신규)          │       │
│      │                                                     │       │
│      │  ┌─────────────────────────────────────────────┐   │       │
│      │  │           로켓 + 이펙트 통합 아트             │   │       │
│      │  │                                               │   │       │
│      │  │              *                                │   │       │
│      │  │             /|\                               │   │       │
│      │  │            / | \                              │   │       │
│      │  │           / VEGA \                            │   │       │
│      │  │          /_________\                          │   │       │
│      │  │          |  [NAV]  |                          │   │       │
│      │  │          |_________|                          │   │       │
│      │  │          /_________\                          │   │       │
│      │  │            \| | |/        ← 화염 이펙트       │   │       │
│      │  │           \\| | |//                           │   │       │
│      │  │          \\\| | |///                          │   │       │
│      │  │         \\\\| | |////                         │   │       │
│      │  │                                               │   │       │
│      │  │         ~~ LIFTOFF ~~     ← 상태 텍스트       │   │       │
│      │  └─────────────────────────────────────────────┘   │       │
│      └───────────────────────────────────────────────────┘       │
│                                                                   │
│  z:3 ┌───────────────────────────────────────────────────┐       │
│      │  [launch-stage-label] — "[ LIFTOFF ]" 상단 라벨   │       │
│      └───────────────────────────────────────────────────┘       │
│                                                                   │
│  z:3 ┌───────────────────────────────────────────────────┐       │
│      │  [launch-telem-info] — 보조 텔레메트리 (작은 글씨) │       │
│      │  "속도: 7.8km/s  고도: 200km"                      │       │
│      └───────────────────────────────────────────────────┘       │
│                                                                   │
└═══════════════════════════════════════════════════════════════════┘
```

### 2.2 핵심 변경점

| 요소 | 현재 | 변경 후 |
|------|------|--------|
| **이펙트 아트** | `#launch-stage-info`에 11px bottom:12px | 로켓과 **통합**되어 중앙 영역에 13px 표시 |
| **풀씬 아트** | 로켓 숨김 + info가 중앙으로 이동 | `#launch-scene`이 전체 씬 표시 (크기 충분) |
| **실패 폭발** | 로켓 유지 + 하단에 작은 폭발 | 로켓이 폭발 아트로 **교체** |
| **보조 텍스트** | info에 아트+텍스트 혼재 | 텔레메트리 텍스트만 (속도/고도 등) |

---

## 3. 단계별 전체 화면 예시 (완성형)

### 범례

```
┌─── 각 예시의 화면 구조 ───┐
│ [STAGE LABEL]  상단 라벨   │  ← z:3, 항상 표시
│                             │
│  (패럴랙스 배경)            │  ← z:1, 반투명
│                             │
│  ┌── 메인 씬 (z:2) ──┐    │
│  │  로켓 + 이펙트 통합 │    │  ← 화면의 중심부
│  └───────────────────┘    │
│                             │
│  [텔레메트리]  하단 보조    │  ← z:3, 작은 글씨
│ [HUD]  우측 오버레이        │  ← 별도 패널
└─────────────────────────────┘
```

---

### 3.1 LIFTOFF — 점화/이륙 (stage 4)

#### 프레임 1: 점화 시퀀스 (0ms)

로켓 아트 + 아래에 점화 이펙트가 **한 덩어리**로 중앙 표시.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│              [ LIFTOFF ]                          │  ← 상단 라벨 --green
│                                                   │
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │  ← 패럴랙스 배경 (지상)
│   ─────────────────────────────────────────       │     반투명, z:1
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│                   *                               │
│                  /|\                               │
│                 / | \                              │
│                /  |  \                             │
│               / VEGA  \                            │  ← 로켓 아트 --green 13px
│              /_________\                           │     중앙 고정, z:2
│              |  [NAV]  |                           │
│              | .-----. |                           │
│              | | SYS | |                           │
│              | '-----' |                           │
│              |  [ENG]  |                           │
│              |_________|                           │
│              /_________\                           │
│                | . | . |                           │  ← 점화 불꽃 --amber
│               .|. .|. .|.                          │     로켓 아트 하단에 통합
│             IGNITION SEQ                           │
│                                                   │
│   속도: 0 m/s    고도: 0 m                         │  ← 텔레메트리 (작은 보조 텍스트)
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 2: 화염 분출 — 이륙 (250ms)

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│              [ LIFTOFF ]                          │  ← --green
│                                                   │
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │  ← 패럴랙스 배경
│   ─────────────────────────────────────────       │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│                   *                               │
│                  /|\                               │
│                 / | \                              │
│                /  |  \                             │  ← 로켓 아트 --green
│               / VEGA  \                            │     .launching 클래스
│              /_________\                           │     (미세 상하 진동)
│              |  [NAV]  |                           │
│              | | SYS | |                           │
│              |  [ENG]  |                           │
│              |_________|                           │
│              /_________\                           │
│                \| | |/                             │  ← 화염 이펙트 --amber
│               \\| | |//                            │     로켓 아트 하단에 통합
│              \\\| | |///                           │     amber→red 그래디언트
│                                                   │
│             ~~ LIFTOFF ~~                          │  ← 상태 텍스트 --amber
│                                                   │
│   속도: 120 m/s    고도: 180 m                     │
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 3: 타워 클리어 (550ms)

배경이 아래로 스크롤되기 시작 (패럴랙스 활성화).

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│              [ LIFTOFF ]                          │
│                                                   │
│   · * · * · * · * · * · * · * · * · * · *         │  ← 패럴랙스 배경
│   ~~~  ~~   ~~~  ~~   ~~~  ~~   ~~~  ~~           │     지상이 내려가고
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │     구름이 올라옴
│   ─────────────────────────────────────────       │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│                   *                               │
│                  /|\                               │  ← 로켓 중앙 고정
│                 / | \                              │     .launching 진동
│                / VEGA  \                           │
│              /_________\                           │
│              |  [NAV]  |                           │
│              |_________|                           │
│              /_________\                           │
│                \| | |/                             │  ← 화염 확대 --amber
│               \\| | |//                            │
│              \\\| | |///                           │
│             \\\\| | |////                          │
│                                                   │
│            TOWER CLEAR                             │
│                                                   │
│   속도: 340 m/s    고도: 2.1 km                    │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.2 MAX-Q — 최대 동압 (stage 5)

#### 프레임 1: 진동 경고

로켓 전체에 `shake-md` 진동 적용. 이펙트 아트가 **로켓 옆** 또는 **아래**에 통합.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            !! MAX-Q !!                            │  ← --amber 깜빡임
│                                                   │
│   ~~~  ~~   ~~~  ~~   ~~~  ~~   ~~~  ~~           │  ← 패럴랙스: 구름대
│   ·   ·   ·   ·   ·   ·   ·   ·   ·   ·          │
│                                                   │
│                   *                               │
│                  /|\ !!                            │
│                 / | \  !          MAX-Q            │  ← 이펙트 텍스트를 로켓 옆에
│                /  |  \       동압: ████████░░      │     통합 배치 (같은 <pre> 안)
│               / VEGA  \                            │
│              /_________\                           │
│              |  [NAV]  |      VIBRATION            │
│              | | SYS | |      ▓▓▓▓▓▓░░            │
│              |  [ENG]  |                           │
│              |_________|                           │
│              /_________\                           │  ← 전체 씬이 좌우 1px
│               \\| | |//                            │     진동 (shake-md)
│              \\\| | |///                           │
│             \\\\| | |////                          │
│            \\\\\| | |/////                         │
│                                                   │
│   속도: 1,240 m/s    고도: 11 km    동압: 34 kPa   │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.3 STG SEP — 단분리 (stage 7)

#### 프레임 2: 분리 완료

2단이 위로, 1단이 아래로 벌어지는 장면을 **하나의 통합 아트**로 표시.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            [ STG SEP ]                            │  ← --green
│                                                   │
│  ·   ·   ·   ·   ·   ·   ·   ·   ·   ·           │  ← 패럴랙스: 고층 대기
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│              *                                    │
│             /|\                                    │  ← 2단 (상단) --green
│            / | \                                   │
│           /  |  \                                  │
│          /HERMES \                                 │
│         /_________\                                │
│         | [AVION] |       STG SEP OK              │
│         |---------|       2단 점화                  │
│         |[PROP-2] |                                │
│         |_________|                                │
│           \| |/                                    │  ← 2단 엔진 화염
│          \\| |//                                   │
│                                                   │
│                  v v v                             │  ← 1단 낙하 --green-dim
│                [PROP-1]                            │     (opacity 0.5)
│               /_________\                          │
│                                                   │
│   속도: 5,200 m/s    고도: 85 km                   │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.4 ORBIT — 궤도 진입 (stage 8, fullScene)

로켓이 숨겨지고 **전체 씬 아트가 화면 중앙을 채움**.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            [ ORBIT ]                              │  ← --cyan
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │  ← 패럴랙스: 우주 (별)
│  .   *   .   *   .   *   .   *   .   *            │
│                                                   │
│                                                   │
│                              *                    │
│     .  *  .               . /|\                    │  ← fullScene 아트
│    *      .  *            / | \                    │     화면 중앙에 크게 (13px)
│     . * .   .            /  |  \                   │     --cyan 글로우
│      .  * .             /________\   ORBIT INSERT  │
│     *  .  *  .          |________|   속도: 7.8km/s │
│     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~     고도: 200 km  │
│      ~~ EARTH HORIZON ~~                           │
│                                                   │
│                                                   │
│                                                   │
│   속도: 28,080 km/h    고도: 200 km                │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.5 TLI — 달 전이 궤도 (stage 9, fullScene)

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            [ TLI BURN ]                           │  ← --amber
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│  .   *   .   *   .   *   .   *   .   *            │
│                                                   │
│                                                   │
│                                 .  (  )           │
│     .  *  .                    (    )             │  ← fullScene 아트
│    *      .         ===>  *   (  @  )             │     지구 ← 로켓 → 달
│     . * .                /|\   (  )               │     통합 씬
│     ~~~~~~~~~~~~           ()                     │
│      ~~ EARTH ~~                                  │
│                                                   │
│                         TLI BURN                  │
│                         V = 10.9 km/s             │
│                                                   │
│                                                   │
│   속도: 39,240 km/h    고도: 전이 궤도              │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.6 LOI — 달 궤도 포획 (stage 10, fullScene)

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            [ LOI BURN ]                           │  ← --cyan
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│                                                   │
│          .  (    )                                 │
│         (        )                                 │  ← fullScene: 달 + 로켓
│        (  MOON    )       *  <---                  │     큰 달 실루엣 + 역분사
│         (        )       /|\                       │     --cyan 달 글로우
│          (      )       [==]                       │
│           (  )       LOI BURN                     │
│                      감속 연소 중                   │
│                                                   │
│                                                   │
│   속도: 1,680 m/s    달 고도: 100 km               │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 3.7 LANDING — 달 착륙 (stage 11, fullScene)

#### 프레임 2: 역분사

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│            [ LANDING ]                            │  ← --amber
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│                                                   │
│             /|\                                    │
│            / | \       RETRO BURN                  │  ← fullScene:
│           [=====]      고도: 500m                  │     역분사 화염 (위로)
│             |||        속도: 50m/s                  │
│            \|||/                                   │
│           \\|||//                                  │
│          ___________                               │
│         /  .  o  .  \                              │  ← 달 표면
│        / .  MOON  .  \                             │
│                                                   │
│                                                   │
│   속도: 50 m/s    달 고도: 500 m                   │
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 4: 착륙 완료 + 깃발

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│          [ MISSION COMPLETE ]                     │  ← --green + success-glow
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│                                                   │
│                           _                       │
│             /|\          | |                       │
│            / | \         | |   MISSION             │  ← fullScene: 착륙 장면
│           [=====]  ------' |   COMPLETE            │     깃발 + 달 기지
│           _|   |_          |                       │     --green + 글로우
│          / |   | \         |                       │
│        ___________________________                 │
│        .  .  o  .  .  .  o  .  .                   │  ← 달 표면
│          .  . LUNAR BASE .  .                      │
│                                                   │
│        ** TOUCHDOWN CONFIRMED **                   │  ← --green 깜빡임
│                                                   │
│   고도: 0 m    속도: 0 m/s    착륙 성공!            │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

## 4. 실패 애니메이션 전체 화면 예시

### 4.1 LIFTOFF 실패 — 지상 폭발 (ground zone)

#### 프레임 1: 엔진 이상 경고

로켓은 그대로, 경고 텍스트와 이펙트가 **로켓에 통합 표시**.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        !! LIFTOFF ANOMALY !!                      │  ← --amber 깜빡임
│                                                   │
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │  ← 패럴랙스: 지상
│   ─────────────────────────────────────────       │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│                   *                               │
│                  /|\                               │  ← 로켓 --amber
│                 / | \                              │     .warning-glow
│                /  |  \                             │     .shake-sm 진동
│               / VEGA  \                            │
│              /_________\                           │
│              |  [NAV]  |                           │
│              | .-----. |                           │
│              | | SYS | |                           │
│              | '-----' |                           │
│              |  [ENG]  |                           │
│              |_________|                           │
│              /_________\                           │
│                | . | . |                           │
│               .|!  !  !|.                          │  ← 점화 불규칙 --amber
│             !! ENGINE ANOMALY !!                   │
│                                                   │
│   !! ANOMALY DETECTED !!                           │  ← 텔레메트리 --red
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 2: 폭발 — 로켓 아트가 폭발로 교체

**핵심**: 로켓 `<pre>` 자체의 `textContent`가 폭발 아트로 바뀜.
로켓이 사라지고 폭발 아트가 같은 위치(화면 중앙)에 표시.

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        !! LIFTOFF ANOMALY !!                      │  ← --red
│                                                   │
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │  ← 배경 (정지)
│   ─────────────────────────────────────────       │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│               ★ 화면 전체 레드 플래시 ★              │  ← .flash-red 효과
│                                                   │
│              \  * . /                              │
│            . * ╔═╗ * .                             │  ← 폭발 아트 --red
│           * ░░░║!║░░░ *                            │     화면 중앙, 13px
│            ░▒▓▓███▓▓▒░                             │     .fail-glow
│             ░▒▓████▓▒░                             │     text-shadow: red
│               \|/  \|/                             │
│                                                   │
│             !!FIRE ON PAD!!                        │
│            ABORT ABORT ABORT                       │
│                                                   │
│                                                   │
│   // MISSION LOST — RUD                            │  ← 텔레메트리 --red
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 3: 잔해 — 연기 확산

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        // MISSION LOST                            │  ← --red
│                                                   │
│   [T]  |   [T]  |   [T]  |   [T]  |  [T]         │
│   ─────────────────────────────────────────       │
│   ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓       │
│                                                   │
│               .   ·   .                           │
│             ·   .   ·                             │  ← 잔해 아트 --red→dim
│              ░  ▒▓▒  ░                            │     페이드아웃 중
│            ░░▒▓█████▓▒░░                           │
│            ───══╤══───                             │
│            ▓▓ PAD LOST ▓▓                          │
│                                                   │
│            ~~ RUD — T+0 ~~                         │
│                                                   │
│                                                   │
│                                                   │
│   // RUD CONFIRMED                                 │  ← --green-dim (고요)
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 4.2 MAX-Q 실패 — 공중분해 (ground zone)

#### 프레임 1: 구조 경고

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        !! MAX-Q ANOMALY !!                        │  ← --amber
│                                                   │
│   ~~~  ~~   ~~~  ~~   ~~~  ~~   ~~~  ~~           │
│                                                   │
│                   *                               │
│                  /|\ !!          STRUCTURAL        │  ← 로켓 + 경고가 통합
│                 / | \  !         ALERT !!          │     .shake-md (강한 진동)
│                /  |  \                             │
│               / VEGA  \           동압: ████████████│
│              /_________\          한계 초과!        │
│              |  [NAV]  |                           │
│              |  [ENG]  |                           │
│              |_________|                           │
│              /_________\                           │
│               \\| | |//                            │
│              \\\| | |///                           │
│                                                   │
│                                                   │
│   !! 동압 초과 — 구조 경고 !!                       │
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 2: 공중분해

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        // BREAKUP                                 │  ← --red
│                                                   │
│   ~~~  ~~   ~~~  ~~   ~~~  ~~   ~~~  ~~           │
│                                                   │
│            ★ 화면 플래시 RED ★                     │
│                                                   │
│           .  \  * /  .                             │
│          * .  ╔╗  . *                              │  ← 폭발 아트 --red
│         / * . ║║ . * \                             │     중앙 13px
│        *  ░▒▓█║║█▓▒░  *                           │     .exploding + .fail-glow
│         . ▒▓██╚╝██▓▒ .                            │
│        * ░▒▓█████▓▒░  *                           │
│           ░▒▓███▓▒░                                │
│                                                   │
│          !! BREAKUP !!                             │
│                                                   │
│                                                   │
│   // 동체 공중분해 확인                              │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 4.3 ORBIT 실패 — 엔진 고장 / 표류 (space zone)

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        !! ORBIT ANOMALY !!                        │  ← --red
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │  ← 우주 배경 (정지)
│  .   *   .   *   .   *   .   *   .   *            │
│                                                   │
│                                                   │
│          .  *  .                                   │
│         *       *                                  │  ← 실패 씬 --red
│        . [ENGINE] .      NAV ERROR                 │     중앙 표시
│        . [CUTOFF] .      궤도 삽입                  │
│         *   !   *        오차 초과                  │
│          .  *  .                                   │
│        ~~~~~~~~~~~~~~~~                            │
│         ~~ EARTH ~~                                │
│                                                   │
│                                                   │
│   // 궤도 삽입 실패 — 대기권 재진입                   │
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

### 4.4 LANDING 실패 — 달 표면 충돌 (lunar zone)

#### 프레임 2: 충돌 폭발

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        // IMPACT                                  │  ← --red
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│            ★ 화면 전체 레드 플래시 ★              │  ← .flash-red
│                                                   │
│            ░▒▓████▓▒░                              │
│           ░▒▓███████▓▒░                            │  ← 충돌 폭발 아트
│          ░▒▓██████████▓▒░                          │     --red, 중앙 크게
│           ░▒▓███████▓▒░                            │     text-shadow: 16px red
│            ░▒▓████▓▒░                              │
│           ___________                              │
│           . . CRASH . .                            │
│             ~IMPACT~                               │
│                                                   │
│                                                   │
│                                                   │
│   // 착륙 실패 — 표면 충돌                          │
│                                                   │
└═══════════════════════════════════════════════════┘
```

#### 프레임 3: 크레이터 생성 (고요한 달 표면)

```
┌═══════════════════════════════════════════════════┐
│                                                   │
│        // MISSION LOST                            │  ← --red → dim 페이드
│                                                   │
│  *   .   *   .   *   .   *   .   *   .            │
│                                                   │
│                                                   │
│              .  ·  .                               │
│            _____________                           │
│           /  .  ·  .  \                            │  ← 달 표면 + 크레이터
│          / ·   RUD   . \                           │     --green-dim (고요)
│          \ .  ·  .  · /                            │
│           \_____●_____/                            │  ← ● 충돌 마커
│            // MOON //                              │
│                                                   │
│          착륙 실패 — 표면 충돌                      │
│                                                   │
│                                                   │
│   // 침묵                                          │  ← 아무 소리 없음
│                                                   │
└═══════════════════════════════════════════════════┘
```

---

## 5. 구현 방법 — 코드 수정 가이드

### 5.1 핵심 변경: 이펙트 아트를 로켓 영역과 통합

**현재 문제적 구조** (`launch.js` L580-585):
```javascript
// 현재: 3개 독립 요소 (로켓은 중앙, 이펙트는 하단에 분리됨)
animWrap.innerHTML = `
  <div id="launch-stage-label" ...top:8px...></div>
  <div id="launch-rocket-cnt" ...top:40%...>
    <pre id="launch-rocket-pre">${launchArt}</pre>
  </div>
  <pre id="launch-stage-info" ...bottom:12px...></pre>
`;
```

**수정된 구조**:
```javascript
// 변경: 메인 씬 영역을 중앙에 크게, 텔레메트리는 보조 역할만
animWrap.innerHTML = `
  <div id="launch-stage-label"
       style="position:absolute;top:8px;left:50%;transform:translateX(-50%);
              z-index:3;text-align:center;font-size:20px;letter-spacing:4px;
              color:var(--green);text-shadow:0 0 12px rgba(0,230,118,0.6);
              pointer-events:none;"></div>

  <div id="launch-scene"
       style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
              z-index:2;text-align:center;">
    <pre class="rocket-art-core launch-rocket-ascii" id="launch-rocket-pre"
         style="color:#00e676;text-shadow:0 0 8px rgba(0,230,118,0.6);
                font-size:13px;line-height:1.35;white-space:pre;">
${launchArt}</pre>
  </div>

  <pre id="launch-telem-info"
       style="position:absolute;bottom:8px;left:50%;transform:translateX(-50%);
              z-index:3;font-size:10px;line-height:1.4;white-space:pre;
              color:var(--green-mid);text-shadow:0 0 4px rgba(0,230,118,0.2);
              text-align:center;pointer-events:none;"></pre>
`;
```

### 5.2 _applyStageFrame() 수정

**현재**: 이펙트 아트를 `stageInfoEl`(하단 11px)에 넣음

**변경**: 이펙트 아트를 **로켓 아래에 연결**하거나, fullScene일 때 **씬 영역 자체를 교체**

```javascript
function _applyStageFrame(frame, rocketEl, stageInfoEl) {
  if (!frame) return;

  // ── fullScene 프레임: 로켓 숨기고 씬 전체를 아트로 교체 ──
  if (frame.fullScene) {
    if (rocketEl) rocketEl.style.display = 'none';
    // 씬 컨테이너에 직접 표시 (로켓 위치 = 화면 중앙)
    const sceneEl = document.getElementById('launch-scene');
    if (sceneEl) {
      // 임시 <pre>를 만들어 씬 아트 표시
      sceneEl.innerHTML = `<pre class="rocket-art-core launch-rocket-ascii"
        style="font-size:13px;line-height:1.4;white-space:pre;color:var(${frame.color});
               text-shadow:0 0 8px ${_getGlowColor(frame.color)};text-align:center;">
${frame.art.join('\n')}</pre>`;
    }
    return;
  }

  // ── 비-fullScene: 로켓 유지 + 이펙트를 stageInfoEl에 ──
  // (이미 stageInfoEl은 하단 보조 텍스트용으로 변경됨)
  if (rocketEl) rocketEl.style.display = '';

  // ★ 핵심: 이펙트 아트를 로켓 아트 아래에 추가 (연결)
  // → 로켓 <pre>의 textContent를 "로켓아트 + \n + 이펙트아트"로 합치거나
  // → 별도 이펙트 <pre>를 로켓 컨테이너 하단에 배치
  const effectEl = document.getElementById('launch-effect-pre');
  if (effectEl) {
    effectEl.textContent = frame.art.join('\n');
    effectEl.style.color = `var(${frame.color})`;
  }

  // 보조 텔레메트리는 작은 상태 텍스트만 (선택적)
  // stageInfoEl은 더 이상 아트를 담지 않음

  // ... 기존 effect 클래스 적용 (shake, glow 등) ...
}
```

### 5.3 실패 폭발: 로켓 아트 자체를 교체

**현재** (launch.js L833-840):
```javascript
// 기존: 로켓은 그대로, 하단 info에 폭발 텍스트
if (rocketEl && fi >= 1) {
  rocketEl.classList.add('exploding', 'fail-glow');
  const legacyFrames = FAIL_FRAMES_BY_ZONE[zone] || [];
  if (legacyFrames[fi - 1]) {
    rocketEl.textContent = legacyFrames[fi - 1];  // ← 이미 교체는 하고 있음!
  }
}
```

**해결**: 이 부분은 이미 로켓을 교체하고 있으나, **STAGE_FAIL_FRAMES** 쪽도 씬 영역에 표시해야 함:

```javascript
// 실패 프레임 표시
stageFailFrames.forEach((frame, fi) => {
  setTimeout(() => {
    // 씬 전체를 실패 프레임으로 교체 (fullScene처럼 동작)
    const sceneEl = document.getElementById('launch-scene');
    if (sceneEl && fi >= 1) {
      // 로켓 아트를 폭발 아트로 교체
      sceneEl.innerHTML = `<pre class="rocket-art-core launch-rocket-ascii
        exploding fail-glow"
        style="font-size:13px;line-height:1.4;white-space:pre;
               color:var(--red);text-shadow:0 0 12px rgba(255,23,68,0.8);">
${frame.art.join('\n')}</pre>`;
    } else {
      // 첫 프레임: 경고 표시 (로켓 유지 + 경고 이펙트)
      _applyStageFrame(frame, rocketEl, stageInfoEl);
    }
  }, failFrameStart + fi * failScale.frameDuration);
});
```

### 5.4 CSS 추가 (최소 변경)

```css
/* launch-scene: 메인 씬 영역 — 항상 화면 중앙 */
#launch-scene {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2;
  text-align: center;
}

/* 텔레메트리 보조 텍스트 — 작게, 하단 */
#launch-telem-info {
  position: absolute;
  bottom: 8px; left: 50%;
  transform: translateX(-50%);
  z-index: 3;
  font-size: 10px;
  color: var(--green-mid);
  pointer-events: none;
}
```

---

## 6. 요소별 크기/위치 정리표

| 요소 | 위치 | 크기 | z-index | 용도 |
|------|------|------|---------|------|
| `#launch-parallax` | 전체 영역 | 100%×100% | 1 | 패럴랙스 배경 |
| `#launch-scene` | `top:50%; left:50%` (중앙) | auto (내용 기준) | 2 | 로켓+이펙트 통합 씬 |
| `#launch-rocket-pre` | scene 내부 | 13px, line-height:1.35 | - | 로켓/폭발/풀씬 아트 |
| `#launch-stage-label` | `top:8px` (상단) | 20px, bold | 3 | 단계 이름 라벨 |
| `#launch-telem-info` | `bottom:8px` (하단) | 10px | 3 | 보조 텔레메트리 텍스트 |
| `#lc-hud` | 우상단 오버레이 | 220px 폭 | 4 | 텔레메트리 HUD 패널 |

---

## 7. 렌더링 흐름 정리 (수정 후)

```
발사 클릭
  ↓
_runPreLaunchIgnition()  — T-3~T-0 카운트다운
  ↓
_runLaunchAnimation()
  ↓
┌─ 레이아웃 생성 ──────────────────────────────────┐
│  #launch-parallax (배경)                          │
│  #launch-scene (중앙)                             │
│    └ #launch-rocket-pre (로켓 아트)               │
│  #launch-stage-label (상단 라벨)                  │
│  #launch-telem-info (하단 보조)                   │
└──────────────────────────────────────────────────┘
  ↓
각 단계마다:
  ├─ 성공 프레임 → _applyStageFrame()
  │   ├─ fullScene=false: 로켓 유지 + 이펙트를 로켓 아래에 통합
  │   └─ fullScene=true:  #launch-scene 전체를 씬 아트로 교체 (크게!)
  │
  └─ 실패 단계:
      ├─ 정상 프레임 1~2개 → 경고 이펙트
      ├─ ANOMALY 감지 → .shake + .warning-glow
      ├─ 실패 확정 → STAGE_FAIL_FRAMES 표시
      │   └─ fi≥1: #launch-scene을 폭발 아트로 교체 (크게!)
      └─ MISSION LOST 메시지
  ↓
결과 오버레이 (#launch-overlay)
```

---

## 부록 A: 이펙트 아트가 "작게" 나오는 모든 원인과 해결

| # | 원인 | 현재 코드 위치 | 해결 |
|---|------|---------------|------|
| 1 | `#launch-stage-info` font-size: 11px | index.html L1822 | 13px로 통일 또는 씬에 통합 |
| 2 | `bottom:12px` 고정 → 하단에만 표시 | launch.js L585 | 씬 중앙 영역으로 이동 |
| 3 | 비-fullScene 이펙트가 로켓과 분리 | launch.js L509-512 | 로켓 컨테이너에 이펙트 연결 |
| 4 | 실패 프레임이 stageInfoEl에 표시 | launch.js L831 | 씬 영역에서 로켓을 교체 |
| 5 | fullScene만 중앙 이동 | launch.js L473-494 | 비-fullScene도 중앙 씬에 통합 |

---

## 부록 B: 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| v1.0 | 2026-02-25 | 초안 — 현재 문제 분석 + 8단계×성공/실패 전체 화면 예시 + 구현 가이드 |
