<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOON IDLE — 달 탐사 로켓 제작소</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  /* ===== DESIGN TOKENS ===== */
  :root {
    --bg: #010800;
    --panel-bg: #020d04;
    --green: #00e676;
    --green-dim: #1a5c34;
    --green-mid: #00994d;
    --amber: #ffab00;
    --red: #ff1744;
    --font: 'Share Tech Mono', monospace;
    --border: 1px solid #1a5c34;
    --glow: 0 0 6px #00e67680;
    --glow-strong: 0 0 12px #00e676, 0 0 24px #00e67650;
    --amber-glow: 0 0 8px #ffab0080;
  }

  /* ===== GLOBAL RESET ===== */
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    border-radius: 0 !important;
  }

  html, body {
    width: 100%;
    min-height: 100vh;
    background: var(--bg);
    color: var(--green);
    font-family: var(--font);
    font-size: 16px;
    overflow-x: hidden;
  }

  /* ===== CRT SCANLINES ===== */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: 9999;
    pointer-events: none;
    background: repeating-linear-gradient(
      to bottom,
      transparent 0px,
      transparent 2px,
      rgba(0, 0, 0, 0.18) 2px,
      rgba(0, 0, 0, 0.18) 4px
    );
  }

  /* ===== CRT VIGNETTE ===== */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    z-index: 9998;
    pointer-events: none;
    background: radial-gradient(
      ellipse at center,
      transparent 60%,
      rgba(0, 0, 0, 0.6) 100%
    );
  }

  /* ===== CRT FLICKER ===== */
  @keyframes crt-flicker {
    0%   { opacity: 1; }
    93%  { opacity: 1; }
    93.5%{ opacity: 0.94; }
    94%  { opacity: 1; }
    96%  { opacity: 1; }
    96.5%{ opacity: 0.96; }
    97%  { opacity: 1; }
    100% { opacity: 1; }
  }

  body {
    animation: crt-flicker 8s step-end infinite;
  }

  /* ===== SCROLLBAR ===== */
  ::-webkit-scrollbar {
    width: 4px;
    height: 4px;
  }
  ::-webkit-scrollbar-track {
    background: var(--bg);
  }
  ::-webkit-scrollbar-thumb {
    background: var(--green-dim);
  }
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--green-dim) transparent;
  }

  /* ===== PANEL HEADER :: before ===== */
  .panel-header::before {
    content: '// ';
  }

  /* ===========================
     1. TITLE SCREEN
     =========================== */
  #title-screen {
    position: fixed;
    inset: 0;
    z-index: 5000;
    background: var(--bg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    padding: 24px;
  }

  .title-logo {
    font-size: 52px;
    letter-spacing: 12px;
    text-transform: uppercase;
    color: var(--green);
    text-shadow: var(--glow-strong);
    margin-bottom: 6px;
    text-align: center;
  }

  .title-subtitle {
    font-size: 14px;
    letter-spacing: 4px;
    color: var(--green-mid);
    text-transform: uppercase;
    text-align: center;
    margin-bottom: 8px;
  }

  #boot-log.boot-log {
    width: 100%;
    max-width: 540px;
    height: 200px;
    overflow-y: auto;
    border: var(--border);
    background: var(--panel-bg);
    padding: 10px 14px;
    font-size: 13px;
    color: var(--green-mid);
    line-height: 1.6;
  }

  #save-strip.title-save-strip {
    font-size: 13px;
    color: var(--green-dim);
    letter-spacing: 2px;
    border: var(--border);
    padding: 5px 14px;
    max-width: 540px;
    width: 100%;
    text-align: center;
  }

  .title-btns {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 4px;
  }

  .title-btn {
    background: none;
    border: 2px solid var(--green-dim);
    color: var(--green);
    font-family: var(--font);
    font-size: 15px;
    letter-spacing: 3px;
    padding: 9px 28px;
    cursor: pointer;
    text-transform: uppercase;
    transition: all 0.15s;
  }

  .title-btn:hover {
    border-color: var(--green);
    text-shadow: var(--glow);
  }

  .title-btn.primary {
    border-color: var(--green);
    text-shadow: var(--glow);
  }

  /* ===========================
     2. WORLD BACKGROUND
     =========================== */
  #world-bg {
    position: fixed;
    bottom: 0;
    left: 200px;
    right: 0;
    height: 240px;
    z-index: 1;
    overflow-x: auto;
    overflow-y: hidden;
    cursor: grab;
  }
  #world-bg:active { cursor: grabbing; }
  #world-bg::-webkit-scrollbar { height: 6px; }
  #world-bg::-webkit-scrollbar-track { background: #010800; }
  #world-bg::-webkit-scrollbar-thumb { background: #1a5c34; }

  #world-scene {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 3200px;
    height: 220px;
    transition: transform 0.8s ease;
  }

  #sky-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 160px;
  }

  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: var(--green-dim);
    opacity: 0.6;
  }

  #buildings-layer {
    position: absolute;
    bottom: 32px;
    left: 0;
    width: 100%;
  }

  #ground-line {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 32px;
    background: linear-gradient(to bottom, #0a1a08, #020d04);
    border-top: 2px solid var(--green-dim);
  }

  #workers-layer {
    position: absolute;
    bottom: 32px;
    left: 0;
    width: 100%;
  }

  /* ===== WORLD BUILDINGS ===== */
  .world-building {
    position: absolute;
    bottom: 0;
  }

  /* Mine */
  .wb-mine {
    width: 70px;
    height: 85px;
    background: #0a1808;
    border: 2px solid var(--green-dim);
    border-bottom: none;
    position: relative;
  }
  .wb-mine::before {
    content: '';
    position: absolute;
    top: -8px;
    left: 10px;
    right: 10px;
    height: 8px;
    background: #0a2010;
    border: 2px solid var(--green-dim);
    border-bottom: none;
  }
  .wb-mine::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 5px;
    width: 60px;
    height: 4px;
    background: var(--green-dim);
  }
  .wb-mine .conveyor {
    position: absolute;
    bottom: 20px;
    right: -20px;
    width: 22px;
    height: 8px;
    background: #0a1a08;
    border: 1px solid var(--green-dim);
    transform: rotate(-20deg);
  }
  .mine-light {
    position: absolute;
    top: 6px;
    right: 8px;
    width: 6px;
    height: 6px;
    background: var(--amber);
    box-shadow: 0 0 6px var(--amber);
    animation: mine-blink 2s step-start infinite;
  }
  @keyframes mine-blink {
    0%,100% { opacity: 1; }
    50%      { opacity: 0.2; }
  }

  /* Refinery */
  .wb-refinery {
    width: 100px;
    height: 100px;
    display: flex;
    align-items: flex-end;
    gap: 6px;
    position: absolute;
    bottom: 0;
  }
  .refinery-tank {
    width: 40px;
    background: #081408;
    border: 2px solid var(--green-dim);
    border-bottom: none;
    position: relative;
  }
  .refinery-tank.tall  { height: 90px; }
  .refinery-tank.short { height: 65px; }
  .refinery-tank::before {
    content: '';
    position: absolute;
    top: -6px;
    left: -2px;
    right: -2px;
    height: 6px;
    background: #0a1a08;
    border: 2px solid var(--green-dim);
  }
  .refinery-pipe {
    position: absolute;
    bottom: 30px;
    left: 40px;
    width: 20px;
    height: 3px;
    background: var(--green-dim);
  }

  /* Research Lab */
  .wb-research {
    width: 110px;
    height: 75px;
    background: #060f08;
    border: 2px solid var(--green-dim);
    border-bottom: none;
    position: relative;
  }
  .wb-research::before {
    content: '';
    position: absolute;
    top: -10px;
    left: 30px;
    right: 30px;
    height: 10px;
    background: #060f08;
    border: 2px solid var(--green-dim);
    border-bottom: none;
  }
  .research-windows {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px;
    padding: 8px 6px;
  }
  .research-win {
    height: 12px;
    background: var(--panel-bg);
    border: 1px solid var(--green-dim);
  }
  .research-win.lit {
    background: rgba(0,230,118,0.15);
    box-shadow: 0 0 4px #00e67640;
  }

  /* Electronics Lab */
  .wb-eleclab {
    width: 90px;
    height: 60px;
    background: #050a06;
    border: 2px solid var(--green-dim);
    border-bottom: none;
    position: relative;
  }
  .elec-circuit {
    position: absolute;
    top: 10px;
    left: 8px;
    right: 8px;
    height: 1px;
    background: var(--green-dim);
  }
  .elec-circuit::before {
    content: '';
    position: absolute;
    top: -3px;
    left: 20px;
    width: 6px;
    height: 7px;
    background: var(--green-dim);
  }
  .elec-circuit::after {
    content: '';
    position: absolute;
    top: -3px;
    right: 20px;
    width: 6px;
    height: 7px;
    background: var(--green-dim);
  }
  .elec-led {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 5px;
    height: 5px;
    background: var(--green);
    box-shadow: var(--glow);
    animation: elec-pulse 1.4s ease-in-out infinite;
  }
  @keyframes elec-pulse {
    0%,100% { opacity: 1; }
    50%      { opacity: 0.3; }
  }

  /* Ops Center */
  .wb-ops {
    width: 120px;
    height: 80px;
    background: #060e07;
    border: 2px solid var(--green-dim);
    border-bottom: none;
    position: relative;
  }
  .ops-windows {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 3px;
    padding: 8px 6px 6px;
  }
  .ops-win {
    height: 10px;
    background: var(--panel-bg);
    border: 1px solid #0d2016;
  }
  .ops-win.lit {
    background: rgba(0,230,118,0.1);
  }
  .ops-sign {
    position: absolute;
    bottom: 6px;
    left: 0;
    right: 0;
    height: 12px;
    border-top: 1px solid var(--green-dim);
  }

  /* Launch Pad */
  .wb-launchpad {
    width: 80px;
    height: 160px;
    position: absolute;
    bottom: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .lp-gantry {
    width: 6px;
    height: 130px;
    background: var(--green-dim);
    margin-left: 20px;
    position: relative;
  }
  .lp-gantry::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 0;
    width: 30px;
    height: 2px;
    background: var(--green-dim);
  }
  .lp-gantry::after {
    content: '';
    position: absolute;
    top: 50px;
    left: 0;
    width: 25px;
    height: 2px;
    background: var(--green-dim);
  }
  .lp-rocket {
    position: absolute;
    bottom: 20px;
    left: 28px;
    width: 20px;
    height: 50px;
    background: #0a1808;
    border: 1px solid var(--green);
  }
  .lp-rocket::before {
    content: '';
    position: absolute;
    top: -10px;
    left: 3px;
    right: 3px;
    height: 10px;
    background: #0a1808;
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    border: 1px solid var(--green);
  }
  .lp-base {
    width: 70px;
    height: 10px;
    background: #0a1a08;
    border: 2px solid var(--green-dim);
    border-bottom: none;
  }

  /* Solar Array */
  .wb-solar {
    width: 120px;
    height: 30px;
    position: absolute;
    bottom: 0;
    display: flex;
    gap: 3px;
    align-items: flex-end;
  }
  .solar-panel {
    width: 22px;
    height: 18px;
    background: #041028;
    border: 1px solid #1a3c6a;
    transform: rotate(-10deg);
    position: relative;
  }
  .solar-panel::after {
    content: '';
    position: absolute;
    inset: 2px;
    background: linear-gradient(135deg, #062040 0%, #0a3060 100%);
    border: 1px solid #1a3c6a;
  }
  .solar-pole {
    width: 2px;
    height: 20px;
    background: var(--green-dim);
    align-self: flex-end;
  }

  /* Smoke */
  .smoke-puff {
    position: absolute;
    top: -8px;
    width: 4px;
    height: 4px;
    background: #1a3020;
    border-radius: 50%;
    animation: smoke-rise 2s ease-out infinite;
  }
  @keyframes smoke-rise {
    0%   { transform: translateY(0); opacity: 0.8; }
    100% { transform: translateY(-30px) translateX(8px); opacity: 0; }
  }

  /* Workers */
  .worker {
    position: absolute;
    bottom: 0;
    width: 6px;
    height: 14px;
    background: var(--green);
  }
  .worker::before {
    content: '';
    position: absolute;
    top: -5px;
    left: 0;
    width: 6px;
    height: 5px;
    background: var(--green-mid);
  }
  @keyframes worker-walk-r {
    0%   { left: 80px; }
    100% { left: 3100px; transform: scaleX(-1); }
  }
  @keyframes worker-walk-l {
    0%   { left: 3100px; transform: scaleX(-1); }
    100% { left: 80px; }
  }
  .worker-1 { animation: worker-walk-r 28s linear infinite; }
  .worker-2 { animation: worker-walk-l 32s linear infinite; animation-delay: -10s; }
  .worker-3 { animation: worker-walk-r 24s linear infinite; animation-delay: -5s; }
  .worker-4 { animation: worker-walk-l 30s linear infinite; animation-delay: -18s; }
  .worker-5 { animation: worker-walk-r 26s linear infinite; animation-delay: -22s; }

  /* ===========================
     3. GAME UI #app
     =========================== */
  #app {
    position: relative;
    z-index: 10;
    max-width: 1200px;
    margin: 0 auto;
    margin-left: 200px;
    min-height: 100vh;
    padding-bottom: 250px;
    display: none;
  }
  #app.visible { display: block; }

  /* ===== 3a. Resource Bar ===== */
  #res-bar {
    position: sticky;
    top: 0;
    z-index: 200;
    background: rgba(1,8,0,0.97);
    border-bottom: var(--border);
    padding: 8px 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    flex-wrap: wrap;
    box-shadow: 0 2px 12px rgba(0,0,0,0.8);
  }

  .res-bar-inner {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: center;
    flex: 1;
  }

  .res-cell {
    border: var(--border);
    padding: 4px 12px;
    font-size: 15px;
    color: var(--green);
    white-space: nowrap;
    text-shadow: var(--glow);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1px;
  }
  .res-cell .res-name {
    font-size: 11px;
    color: var(--green-dim);
    letter-spacing: 2px;
    text-transform: uppercase;
  }
  .res-cell .res-val {
    font-size: 17px;
    font-weight: normal;
  }
  .res-cell .res-rate {
    font-size: 12px;
    color: var(--green-mid);
  }
  .res-cell.amber .res-val {
    color: var(--amber);
    text-shadow: var(--amber-glow);
  }

  #ms-cell { border-color: var(--amber); }

  .res-bar-right {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
  }

  /* ===== 3b. Nav Tabs ===== */
  #nav-tabs {
    display: flex;
    border-bottom: var(--border);
    background: rgba(1,8,0,0.95);
    position: sticky;
    top: 72px;
    z-index: 150;
  }

  .nav-tab {
    flex: 1;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    color: var(--green-dim);
    font-family: var(--font);
    font-size: 15px;
    letter-spacing: 2px;
    padding: 10px 8px;
    cursor: pointer;
    text-transform: uppercase;
    transition: all 0.15s;
    text-align: center;
    border-right: var(--border);
  }
  .nav-tab:last-child { border-right: none; }
  .nav-tab:hover { color: var(--green); }
  .nav-tab.active {
    color: var(--green);
    border-bottom-color: var(--green);
    text-shadow: var(--glow-strong);
    background: rgba(0,230,118,0.04);
  }
  .nav-tab.new-unlock { animation: tab-unlock 0.8s ease; }
  @keyframes tab-unlock {
    0%   { color: var(--amber); text-shadow: 0 0 20px var(--amber); }
    100% { color: var(--green); }
  }

  /* ===== 3c. Tab Panes ===== */
  .tab-pane {
    display: none;
    padding: 14px 12px;
  }
  .tab-pane.active { display: block; }

  /* Panels */
  .panel {
    background: rgba(2,13,4,0.96);
    border: var(--border);
    padding: 12px 16px;
    margin-bottom: 12px;
  }
  .panel-header {
    font-size: 17px;
    letter-spacing: 3px;
    color: var(--green);
    text-transform: uppercase;
    border-bottom: var(--border);
    padding-bottom: 8px;
    margin-bottom: 10px;
    text-shadow: var(--glow);
  }

  /* Buttons */
  .btn {
    background: none;
    border: 2px solid var(--green-dim);
    color: var(--green);
    font-family: var(--font);
    font-size: 15px;
    letter-spacing: 2px;
    padding: 7px 16px;
    cursor: pointer;
    text-transform: uppercase;
    transition: all 0.12s;
  }
  .btn:hover:not(:disabled) {
    border-color: var(--green);
    text-shadow: var(--glow);
  }
  .btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
  .btn-amber {
    border-color: var(--amber);
    color: var(--amber);
  }
  .btn-sm {
    font-size: 13px;
    padding: 4px 10px;
    letter-spacing: 1px;
  }
  .btn-full {
    display: block;
    width: 100%;
    text-align: center;
    margin-top: 8px;
  }

  /* Sound button */
  #sound-btn {
    background: none;
    border: 1px solid var(--green-dim);
    color: var(--green-dim);
    font-family: var(--font);
    font-size: 13px;
    letter-spacing: 1px;
    padding: 4px 10px;
    cursor: pointer;
    text-transform: uppercase;
    transition: all 0.12s;
  }
  #sound-btn:hover {
    color: var(--green);
    border-color: var(--green);
  }

  /* Progress bars */
  .prog-wrap {
    border: 1px solid var(--green-dim);
    height: 8px;
    background: var(--bg);
    overflow: hidden;
    margin: 4px 0;
  }
  .prog-fill {
    height: 100%;
    background: var(--green-mid);
    transition: width 0.3s;
  }
  .prog-fill.amber { background: var(--amber); }

  /* Offline banner */
  #offline-banner {
    display: none;
    background: rgba(255,171,0,0.08);
    border: 1px solid var(--amber);
    color: var(--amber);
    padding: 7px 14px;
    font-size: 14px;
    margin: 8px 12px;
  }

  /* Notifications */
  #notif {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 8000;
    display: flex;
    flex-direction: column;
    gap: 7px;
    pointer-events: none;
  }
  .notif-item {
    background: var(--panel-bg);
    border: 1px solid var(--green-dim);
    color: var(--green);
    font-size: 14px;
    padding: 8px 16px;
    text-shadow: var(--glow);
    animation: notif-in 0.2s ease, notif-out 0.4s ease 2.6s forwards;
    max-width: 340px;
  }
  .notif-item.amber { border-color: var(--amber); color: var(--amber); }
  .notif-item.red   { border-color: var(--red);   color: var(--red);   }
  @keyframes notif-in {
    from { opacity: 0; transform: translateX(40px); }
    to   { opacity: 1; transform: none; }
  }
  @keyframes notif-out {
    to { opacity: 0; transform: translateX(40px); }
  }

  /* ===========================
     PRODUCTION TAB
     =========================== */
  .bld-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 10px;
  }
  .bld-card {
    border: var(--border);
    background: var(--panel-bg);
    padding: 10px 14px;
    cursor: pointer;
    transition: border-color 0.15s;
  }
  .bld-card:hover { border-color: var(--green); }
  .bld-card-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 4px;
  }
  .bld-name {
    font-size: 16px;
    color: var(--green);
    letter-spacing: 1px;
  }
  .bld-cnt {
    color: var(--amber);
    font-size: 15px;
  }
  .bld-desc {
    font-size: 13px;
    color: var(--green-mid);
    margin-bottom: 8px;
  }
  .bld-rate {
    font-size: 13px;
    color: var(--green-mid);
    margin-bottom: 6px;
  }
  .bld-cost {
    font-size: 13px;
    color: var(--green-dim);
    margin-bottom: 8px;
  }

  /* ===========================
     RESEARCH TAB
     =========================== */
  #research-layout {
    display: flex;
    height: calc(100vh - 200px);
    min-height: 500px;
    gap: 0;
  }
  #panel-left-research {
    width: 22%;
    flex-shrink: 0;
    background: var(--panel-bg);
    border-right: var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  #panel-center-research {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--bg);
  }
  #panel-right-research {
    width: 25%;
    flex-shrink: 0;
    background: var(--panel-bg);
    border-left: var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .r-panel-header {
    padding: 8px 12px;
    background: #041208;
    border-bottom: var(--border);
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--green);
    text-shadow: var(--glow);
  }
  .r-panel-header::before { content: '> '; }
  .r-panel-scroll {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
    scrollbar-width: thin;
    scrollbar-color: var(--green-dim) transparent;
  }

  /* Research queue card */
  .res-queue-card {
    border: var(--border);
    padding: 8px 10px;
    margin-bottom: 8px;
    background: #010f04;
  }
  .rqc-title {
    font-size: 13px;
    color: var(--green);
    text-shadow: var(--glow);
    margin-bottom: 4px;
  }
  .rqc-sub {
    font-size: 11px;
    color: var(--green-dim);
    letter-spacing: 1px;
    margin-bottom: 4px;
  }
  .rqc-flash {
    font-size: 12px;
    color: var(--amber);
    text-shadow: var(--amber-glow);
    animation: pulse-amber 0.5s ease-in-out 3;
  }
  @keyframes pulse-amber {
    0%,100% { opacity: 1; }
    50%      { opacity: 0.4; }
  }

  /* Tech tree */
  #tree-container {
    flex: 1;
    overflow: auto;
    padding: 14px;
    scrollbar-width: thin;
    scrollbar-color: var(--green-dim) transparent;
    position: relative;
  }
  .branch-headers {
    display: flex;
    gap: 4px;
    margin-bottom: 10px;
    min-width: 800px;
  }
  .branch-header {
    flex: 1;
    text-align: center;
    padding: 5px;
    border: var(--border);
    background: #041208;
    font-size: 12px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--green);
    text-shadow: var(--glow);
  }
  .branch-header.locked {
    border-color: #1a1f1a;
    color: #3a4a3a;
    text-shadow: none;
  }
  #tree-svg {
    display: block;
    min-width: 800px;
  }
  .tech-node { cursor: pointer; }

  /* Right detail panel */
  .detail-tech-id {
    font-size: 11px;
    letter-spacing: 3px;
    color: var(--green-dim);
    text-transform: uppercase;
    margin-bottom: 2px;
  }
  .detail-tech-name {
    font-size: 16px;
    color: var(--green);
    text-shadow: var(--glow-strong);
    margin-bottom: 2px;
    letter-spacing: 1px;
  }
  .detail-divider {
    border: none;
    border-top: var(--border);
    margin: 8px 0;
  }
  .status-badge {
    display: inline-block;
    padding: 3px 10px;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    border: 1px solid;
    margin-bottom: 8px;
  }
  .status-complete  { color: var(--green);  border-color: var(--green);     background: #011a0a; }
  .status-available { color: var(--green);  border-color: var(--green-mid); background: #010f04; }
  .status-locked    { color: #3a4a3a;       border-color: #2a2f2a;          background: #1a1f1a; }

  .detail-row {
    display: flex;
    justify-content: space-between;
    font-size: 13px;
    padding: 3px 0;
    border-bottom: 1px solid #091608;
  }
  .detail-row .dr-key {
    color: var(--green-dim);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 12px;
  }
  .detail-row .dr-val {
    color: var(--green);
    text-align: right;
  }

  .btn-research {
    display: block;
    width: 100%;
    margin-top: 12px;
    background: none;
    border: 2px solid var(--green-mid);
    color: var(--green);
    font-family: var(--font);
    font-size: 15px;
    letter-spacing: 2px;
    padding: 9px;
    cursor: pointer;
    text-transform: uppercase;
    transition: all 0.15s;
  }
  .btn-research:hover:not(:disabled) {
    border-color: var(--green);
    text-shadow: var(--glow-strong);
  }
  .btn-research:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .rp-section {
    margin-top: 12px;
    border-top: 1px solid #0d2016;
    padding-top: 10px;
  }
  .rp-section-title {
    font-size: 11px;
    letter-spacing: 2px;
    color: var(--green-dim);
    text-transform: uppercase;
    margin-bottom: 6px;
  }
  .lab-item {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: var(--green-mid);
    padding: 3px 0;
    border-bottom: 1px solid #091608;
  }
  .lab-item .lab-rate {
    color: var(--green);
    text-shadow: var(--glow);
  }
  .overview-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    margin-top: 8px;
  }
  .ov-card {
    border: var(--border);
    background: #010f04;
    padding: 8px;
    text-align: center;
  }
  .ov-num {
    font-size: 22px;
    color: var(--green);
    text-shadow: var(--glow-strong);
    line-height: 1.2;
  }
  .ov-num.amber {
    color: var(--amber);
    text-shadow: var(--amber-glow);
  }
  .ov-label {
    font-size: 11px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--green-dim);
    margin-top: 2px;
  }

  /* ===========================
     ASSEMBLY TAB
     =========================== */
  .assembly-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }
  @media (max-width: 700px) {
    .assembly-layout { grid-template-columns: 1fr; }
  }
  .rocket-art-wrap {
    text-align: center;
    padding: 10px;
    border: var(--border);
    background: var(--bg);
    min-height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #rocket-art-display {
    font-size: 13px;
    white-space: pre;
    line-height: 1.3;
    color: var(--green-dim);
    text-shadow: none;
  }
  #rocket-art-display .done {
    color: var(--green);
    text-shadow: var(--glow);
  }
  .parts-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #0e2a18;
    padding: 6px 0;
    font-size: 14px;
    gap: 8px;
  }
  .part-done    { color: var(--green); text-shadow: var(--glow); }
  .part-pending { color: var(--green-dim); }

  .quality-selector {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 12px;
  }
  .q-btn { flex: 1; min-width: 100px; }
  .q-btn.selected {
    border-color: var(--amber);
    color: var(--amber);
    box-shadow: 0 0 8px var(--amber);
  }

  .slot-card {
    border: var(--border);
    background: var(--panel-bg);
    padding: 10px 14px;
    margin-bottom: 10px;
  }
  .slot-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
  }
  .slot-title { font-size: 14px; color: var(--green); letter-spacing: 1px; }
  .slot-state.idle  { color: var(--green-mid); }
  .slot-state.busy  { color: var(--amber); }
  .slot-state.ready { color: var(--green); text-shadow: var(--glow); }

  .science-box {
    border: var(--border);
    background: var(--bg);
    padding: 10px 14px;
    font-size: 13px;
    color: var(--green-mid);
    margin-top: 10px;
    line-height: 1.7;
  }
  .science-box .val    { color: var(--green); }
  .science-box .ms-val { color: var(--amber); }

  /* ===========================
     LAUNCH TAB
     =========================== */
  .launch-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }
  @media (max-width: 700px) {
    .launch-layout { grid-template-columns: 1fr; }
  }

  .ready-slot-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #0e2a18;
    padding: 7px 0;
    font-size: 14px;
    gap: 8px;
  }

  .telemetry-wrap {
    border: var(--border);
    background: var(--bg);
    padding: 12px 14px;
    font-size: 13px;
    min-height: 180px;
  }
  .telem-line {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 4px 0;
    border-bottom: 1px solid #0a1a0a;
    color: var(--green-mid);
  }
  .telem-time  { color: var(--green-mid); min-width: 55px; font-size: 13px; }
  .telem-event { min-width: 170px; color: var(--green); text-transform: uppercase; font-size: 13px; }
  .telem-bar   { flex: 1; height: 6px; border: 1px solid var(--green-dim); }
  .telem-bar-fill { height: 100%; background: var(--green-mid); transition: width 0.5s; }
  .telem-pct   { color: var(--green); font-size: 13px; min-width: 38px; text-align: right; }

  .launch-anim-wrap {
    text-align: center;
    padding: 14px;
    min-height: 160px;
    position: relative;
    overflow: hidden;
    border: var(--border);
    background: var(--bg);
  }
  .launch-rocket-ascii {
    font-size: 12px;
    white-space: pre;
    color: var(--green);
    display: inline-block;
  }
  .launch-rocket-ascii.launching {
    animation: rocket-launch 3s ease-in forwards;
  }
  @keyframes rocket-launch {
    0%   { transform: translateY(0); }
    100% { transform: translateY(-400px); }
  }
  .exhaust-anim {
    font-size: 12px;
    white-space: pre;
    color: var(--amber);
    text-shadow: 0 0 6px var(--amber);
    display: inline-block;
    animation: exhaust-flicker 0.15s step-start infinite;
  }
  @keyframes exhaust-flicker {
    0%,100% { opacity: 1; }
    50%      { opacity: 0.4; }
  }

  .launch-result {
    display: none;
    border: 1px solid var(--amber);
    background: rgba(255,171,0,0.05);
    padding: 14px;
    font-size: 14px;
    color: var(--amber);
    margin-top: 12px;
  }
  .launch-result.show { display: block; }
  .launch-result-title {
    font-size: 17px;
    letter-spacing: 3px;
    text-transform: uppercase;
    text-shadow: 0 0 12px var(--amber);
    margin-bottom: 8px;
  }
  .launch-result-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 5px;
    font-size: 13px;
    margin-bottom: 10px;
  }
  .launch-result-stat-lbl { color: var(--green-mid); }
  .launch-result-stat-val { color: var(--amber); }

  /* ===========================
     MISSION TAB
     =========================== */
  .phase-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 7px 0;
    border-bottom: 1px solid #0e2a18;
    font-size: 14px;
  }
  .phase-name {
    min-width: 200px;
    color: var(--green-mid);
    text-transform: uppercase;
    font-size: 13px;
  }
  .phase-bar-wrap {
    flex: 1;
    height: 8px;
    border: 1px solid var(--green-dim);
    background: var(--bg);
  }
  .phase-bar-fill {
    height: 100%;
    background: var(--green-mid);
    transition: width 0.5s;
  }
  .phase-bar-fill.done { background: var(--green); }
  .phase-status {
    min-width: 80px;
    font-size: 13px;
    text-align: right;
    color: var(--green-mid);
  }
  .phase-status.done   { color: var(--green); }
  .phase-status.locked { color: #0e2a18; }

  .history-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    margin-top: 8px;
  }
  .history-table th {
    background: #021508;
    color: var(--green-mid);
    text-align: left;
    padding: 6px 10px;
    border: var(--border);
    letter-spacing: 1px;
    font-weight: normal;
    text-transform: uppercase;
  }
  .history-table td {
    padding: 5px 10px;
    border: 1px solid #0e2a18;
    color: var(--green);
  }
  .history-table tr:hover td {
    background: rgba(0,230,118,0.04);
  }

  .prestige-panel {
    border: 1px solid var(--amber);
    background: rgba(255,171,0,0.04);
    padding: 14px;
    margin-top: 12px;
  }
  .prestige-stat {
    font-size: 14px;
    color: var(--amber);
    margin-bottom: 8px;
    line-height: 1.7;
  }

  /* ===========================
     4. LAUNCH OVERLAY
     =========================== */
  #launch-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(1,8,0,0.97);
    z-index: 7000;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    text-align: center;
    padding: 24px;
  }
  #launch-overlay.show { display: flex; }
  .lo-title {
    font-size: 28px;
    letter-spacing: 8px;
    text-transform: uppercase;
    color: var(--amber);
    text-shadow: 0 0 20px var(--amber);
    margin-bottom: 14px;
  }
  .lo-rocket {
    font-size: 12px;
    white-space: pre;
    color: var(--amber);
    text-shadow: 0 0 6px #ffab0080;
    margin-bottom: 14px;
    animation: rocket-launch 4s ease-in forwards;
  }
  .lo-stats {
    font-size: 16px;
    color: var(--green);
    margin-bottom: 18px;
    line-height: 2.2;
    text-shadow: var(--glow);
  }
  .lo-ms {
    font-size: 20px;
    color: var(--amber);
    letter-spacing: 3px;
    margin-bottom: 24px;
  }
  .lo-btns {
    display: flex;
    gap: 14px;
    justify-content: center;
    flex-wrap: wrap;
  }

  /* ===== LEFT RESOURCE PANEL ===== */
  #res-left {
    position: fixed;
    left: 0; top: 0; bottom: 0;
    width: 200px;
    background: rgba(2,13,4,0.96);
    border-right: 1px solid #1a5c34;
    z-index: 600;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 6px 8px;
    display: none;
    font-size: 13px;
  }
  #res-left.visible { display: block; }
  #res-left::-webkit-scrollbar { width: 3px; }
  #res-left::-webkit-scrollbar-thumb { background: #1a5c34; }
  .rl-title {
    color: #1a5c34;
    font-size: 11px;
    letter-spacing: 2px;
    text-transform: uppercase;
    border-bottom: 1px solid #1a5c34;
    padding: 4px 0 3px;
    margin-bottom: 6px;
  }
  .rl-item { padding: 3px 0 5px; margin-bottom: 4px; border-bottom: 1px solid #0a1a0a; }
  .rl-label { color: #00994d; font-size: 12px; }
  .rl-val { color: #00e676; font-size: 14px; font-weight: bold; }
  .rl-rate { color: #00994d; font-size: 11px; }
  .rl-bar { height: 4px; background: #1a5c34; margin-top: 2px; }
  .rl-bar-fill { height: 100%; background: #00994d; transition: width 0.8s; }
  .rl-bar-fill.amber { background: #ffab00; }
  .rl-ms-row {
    margin-top: 8px;
    padding: 6px 4px;
    border: 1px solid #7a5100;
    background: rgba(255,171,0,0.05);
  }
  .rl-ms-label { color: #7a5100; font-size: 11px; letter-spacing: 1px; }
  .rl-ms-val { color: #ffab00; font-size: 16px; font-weight: bold; }

  /* ===== BUILDING HOVER OVERLAY ===== */
  #bld-ov {
    position: fixed;
    display: none;
    z-index: 9600;
    background: rgba(1,8,0,0.97);
    border: 1px solid #00e676;
    min-width: 240px;
    max-width: 320px;
    box-shadow: 0 0 18px rgba(0,230,118,0.15);
    font-family: 'Share Tech Mono', monospace;
    font-size: 13px;
    color: #00e676;
  }
  .bov-hd {
    padding: 7px 12px;
    font-size: 14px;
    border-bottom: 1px solid #1a5c34;
    color: #c8ffd4;
  }
  .bov-row { padding: 4px 12px; color: #00994d; font-size: 12px; }
  .bov-row span { color: #00e676; }
  .bov-sep { border-top: 1px solid #1a5c34; margin: 2px 0; }
  .bov-btns { display: flex; gap: 6px; padding: 6px 10px 8px; flex-wrap: wrap; }
  .bov-btn {
    padding: 5px 12px;
    border: 1px solid #00e676;
    color: #00e676;
    cursor: pointer;
    font-family: 'Share Tech Mono', monospace;
    font-size: 12px;
    background: transparent;
    white-space: nowrap;
  }
  .bov-btn:hover { background: #00e676; color: #010800; }
  .bov-btn.amber { border-color: #ffab00; color: #ffab00; }
  .bov-btn.amber:hover { background: #ffab00; color: #010800; }
  .bov-btn.disabled { opacity: 0.35; cursor: not-allowed; pointer-events: none; }
</style>
</head>
<body>

  <!-- ===========================
       1. TITLE SCREEN
       =========================== -->
  <div id="title-screen">
    <div class="title-logo">MOON IDLE</div>
    <div class="title-subtitle">달 탐사 로켓 제작소 / LUNAR EXPLORATION SIM</div>
    <div id="boot-log" class="boot-log"></div>
    <div id="save-strip" class="title-save-strip">// 저장 데이터 없음</div>
    <div class="title-btns">
      <button class="title-btn primary" id="new-game-btn">새 게임</button>
      <button class="title-btn" id="continue-btn" style="display:none">이어하기</button>
      <button class="title-btn" id="settings-btn">설정</button>
    </div>
  </div>

  <!-- LEFT RESOURCE PANEL -->
  <div id="res-left">
    <div class="rl-title">&#9726; 자원</div>
    <div id="rl-inner"></div>
    <div id="rl-ms-box"></div>
  </div>

  <!-- ===========================
       2. WORLD BACKGROUND
       =========================== -->
  <div id="world-bg">
    <div id="world-scene">
      <div id="sky-layer"></div>
      <div id="buildings-layer"></div>
      <div id="ground-line"></div>
      <div id="workers-layer">
        <div class="worker worker-1"></div>
        <div class="worker worker-2"></div>
        <div class="worker worker-3"></div>
        <div class="worker worker-4"></div>
        <div class="worker worker-5"></div>
      </div>
    </div>
  </div>

  <!-- ===========================
       3. GAME UI
       =========================== -->
  <div id="app">

    <!-- 3a. Resource Bar -->
    <div id="res-bar">
      <div id="res-bar-inner" class="res-bar-inner"></div>
      <div class="res-bar-right">
        <span id="ms-display" style="color:var(--amber);font-size:14px;display:none"></span>
        <button id="bgm-prev-btn" onclick="typeof BGM!=='undefined'&&BGM.next()" title="다음 BGM" style="font-size:12px;padding:3px 8px;border:1px solid #1a5c34;background:transparent;color:#00994d;cursor:pointer;font-family:'Share Tech Mono',monospace;">BGM◀▶</button>
        <span id="bgm-track-label" style="font-size:11px;color:#1a5c34;min-width:90px;">[BGM: 앰비언트]</span>
        <button id="sound-btn">SND:ON</button>
      </div>
    </div>

    <!-- 3b. Nav Tabs -->
    <div id="nav-tabs">
      <button class="nav-tab active" id="nav-tab-production" data-tab="production">생산 허브</button>
      <button class="nav-tab" id="nav-tab-research" data-tab="research">연구소</button>
      <button class="nav-tab" id="nav-tab-assembly" data-tab="assembly" style="display:none">조립동</button>
      <button class="nav-tab" id="nav-tab-launch" data-tab="launch" style="display:none">발사 통제</button>
      <button class="nav-tab" id="nav-tab-mission" data-tab="mission" style="display:none">미션 현황</button>
    </div>

    <!-- Offline Banner -->
    <div id="offline-banner"></div>

    <!-- ===== PRODUCTION TAB ===== -->
    <div class="tab-pane active" id="pane-production">
      <div class="panel">
        <div class="panel-header">생산 허브</div>
        <div id="prod-status" style="font-size:14px;color:var(--green-mid);margin-bottom:10px;border-bottom:var(--border);padding-bottom:8px;"></div>
        <div id="bld-grid" class="bld-grid"></div>
      </div>
    </div>

    <!-- ===== RESEARCH TAB ===== -->
    <div class="tab-pane" id="pane-research">
      <div id="research-layout">
        <div id="panel-left-research">
          <div class="r-panel-header">연구 현황</div>
          <div class="r-panel-scroll" id="research-left-content"></div>
        </div>
        <div id="panel-center-research">
          <div class="r-panel-header">기술 트리</div>
          <div id="tree-container">
            <div class="branch-headers" id="branch-headers"></div>
            <svg id="tree-svg" height="480"></svg>
          </div>
        </div>
        <div id="panel-right-research">
          <div class="r-panel-header">기술 상세</div>
          <div class="r-panel-scroll" id="research-right-content">
            <div id="tech-detail-panel"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== ASSEMBLY TAB ===== -->
    <div class="tab-pane" id="pane-assembly">
      <div class="panel">
        <div class="panel-header">로켓 조립동</div>
        <div class="assembly-layout">
          <div>
            <div class="rocket-art-wrap"><pre id="rocket-art-display"></pre></div>
            <div class="panel" style="margin-top:10px">
              <div class="panel-header">부품 현황</div>
              <div id="parts-checklist"></div>
            </div>
            <div class="science-box" id="science-box"></div>
          </div>
          <div>
            <div class="panel">
              <div class="panel-header">품질 등급</div>
              <div class="quality-selector" id="quality-selector"></div>
            </div>
            <div class="panel" style="margin-top:10px">
              <div class="panel-header">조립 슬롯</div>
              <div id="assembly-slots-wrap"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== LAUNCH TAB ===== -->
    <div class="tab-pane" id="pane-launch">
      <div class="panel">
        <div class="panel-header">발사 통제</div>
        <div class="launch-layout">
          <div>
            <div class="panel"><div class="panel-header">발사 준비</div><div id="ready-list-wrap"></div></div>
            <div class="launch-result" id="launch-result">
              <div class="launch-result-title">발사 성공</div>
              <div class="launch-result-stats" id="lr-stats"></div>
              <div id="lr-ms" style="color:var(--amber);font-size:16px;margin-bottom:10px;"></div>
            </div>
          </div>
          <div>
            <div class="panel">
              <div class="panel-header">발사 시퀀스</div>
              <div class="launch-anim-wrap" id="launch-anim-wrap"><div style="color:var(--green-mid);font-size:14px;">// 발사 대기 중</div></div>
              <div id="telem-wrap"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== MISSION TAB ===== -->
    <div class="tab-pane" id="pane-mission">
      <div class="panel"><div class="panel-header">미션 진행 현황</div><div id="phase-progress-wrap"></div></div>
      <div class="panel"><div class="panel-header">발사 기록</div><div id="history-wrap"></div></div>
      <div id="prestige-wrap"></div>
    </div>

  </div><!-- /#app -->

  <!-- ===========================
       4. LAUNCH OVERLAY
       =========================== -->
  <div id="launch-overlay">
    <div class="lo-title">// 달 탐사 성공</div>
    <pre class="lo-rocket" id="lo-rocket-art"></pre>
    <div class="lo-stats" id="lo-stats"></div>
    <div class="lo-ms" id="lo-ms"></div>
    <div class="lo-btns">
      <button class="btn btn-amber" id="btn-prestige">문스톤 획득 후 재시작</button>
      <button class="btn" id="btn-continue-game">계속 진행</button>
    </div>
  </div>

  <!-- Notifications -->
  <div id="notif"></div>

  <!-- Building Hover Overlay -->
  <div id="bld-ov">
    <div class="bov-hd" id="bov-hd">건물명</div>
    <div class="bov-row" id="bov-cnt"></div>
    <div class="bov-row" id="bov-prod"></div>
    <div class="bov-row" id="bov-cost"></div>
    <div class="bov-sep"></div>
    <div class="bov-btns">
      <button class="bov-btn" id="bov-buy">[ 구매 ]</button>
      <button class="bov-btn" onclick="closeBldOv()">[닫기]</button>
    </div>
  </div>

<script src="js/game-data.js"></script>
<script src="js/game-state.js"></script>
<script src="js/unlock.js"></script>
<script src="js/world.js"></script>
<script src="js/tabs/production.js"></script>
<script src="js/tabs/research.js"></script>
<script src="js/tabs/assembly.js"></script>
<script src="js/tabs/launch.js"></script>
<script src="js/tabs/mission.js"></script>
<script src="js/audio-bgm.js"></script>
<script src="js/main.js"></script>
</body>
</html>
