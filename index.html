<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOON IDLE — 달 탐사 로켓 제작소</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
/* ===== DESIGN TOKENS (v7a 기준) =====
 *  --bg         #010800  배경
 *  --panel-bg   #020d04  패널 배경
 *  --green      #00e676  활성 텍스트·테두리
 *  --green-dim  #1a5c34  비활성 테두리·헤더
 *  --green-mid  #00994d  서브 텍스트·레이트
 *  --amber      #ffab00  돈·경고
 *  --red        #ff1744  에러·크리티컬
 *  --white      #c8ffd4  강조 텍스트
 * ======================================= */
:root {
  --bg: #010800;
  --panel-bg: #020d04;
  --green: #00e676;
  --green-dim: #1a5c34;
  --green-mid: #00994d;
  --amber: #ffab00;
  --red: #ff1744;
  --white: #c8ffd4;
  --font: 'Share Tech Mono', monospace;
  --border: 1px solid #1a5c34;
  --glow: 0 0 6px #00e67680;
  --glow-strong: 0 0 12px #00e676, 0 0 24px #00e67650;
  --amber-glow: 0 0 8px #ffab0080;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { width: 100%; height: 100%; overflow: hidden; background: var(--bg); color: var(--green); font-family: var(--font); font-size: 15px; }

/* CRT scanlines */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 9999; pointer-events: none;
  background: repeating-linear-gradient(to bottom, transparent 0px, transparent 2px, rgba(0,0,0,0.12) 2px, rgba(0,0,0,0.12) 4px);
}
/* CRT vignette */
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 9998; pointer-events: none;
  background: radial-gradient(ellipse at center, transparent 55%, rgba(0,0,0,0.65) 100%);
}

@keyframes crt-flicker {
  0%,90%,94%,100% { opacity: 1; }
  91% { opacity: 0.93; } 92% { opacity: 1; }
  95% { opacity: 0.88; } 96% { opacity: 1; }
}

/* Scrollbars */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--green-dim); }
* { scrollbar-width: thin; scrollbar-color: var(--green-dim) transparent; }

/* ===========================
   TITLE SCREEN
   =========================== */
#title-screen {
  position: fixed; inset: 0; z-index: 5000;
  background: var(--bg);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 16px; padding: 24px;
}
.title-logo { font-size: 52px; letter-spacing: 12px; color: var(--green); text-shadow: var(--glow-strong); margin-bottom: 6px; text-align: center; text-transform: uppercase; }
.title-subtitle { font-size: 14px; letter-spacing: 4px; color: var(--green-mid); text-transform: uppercase; text-align: center; }
#boot-log { width: 100%; max-width: 540px; height: 200px; overflow-y: auto; border: var(--border); background: var(--panel-bg); padding: 10px 14px; font-size: 13px; color: var(--green-mid); line-height: 1.6; }
.boot-line { display: block; }
#save-strip { font-size: 13px; color: var(--green-dim); letter-spacing: 2px; border: var(--border); padding: 5px 14px; max-width: 540px; width: 100%; text-align: center; }
.title-btns { display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; margin-top: 4px; }
.title-btn { background: none; border: 2px solid var(--green-dim); color: var(--green); font-family: var(--font); font-size: 15px; letter-spacing: 3px; padding: 9px 28px; cursor: pointer; text-transform: uppercase; transition: all 0.15s; }
.title-btn:hover { border-color: var(--green); text-shadow: var(--glow); }
.title-btn.primary { border-color: var(--green); text-shadow: var(--glow); }
/* Continue button — amber emphasis */
#continue-btn { border-color: var(--amber); color: var(--amber); text-shadow: var(--amber-glow); }
#continue-btn:hover { background: rgba(255,171,0,0.1); border-color: #ffc300; }
/* Settings button on title screen */
.title-settings { margin-top: 8px; }
.title-btn-sm { background: none; border: 1px solid var(--green-dim); color: var(--green-dim); font-family: var(--font); font-size: 11px; letter-spacing: 2px; padding: 4px 12px; cursor: pointer; text-transform: uppercase; transition: all 0.15s; }
.title-btn-sm:hover { border-color: var(--green); color: var(--green); }
@keyframes title-fade-out { from { opacity: 1; } to { opacity: 0; pointer-events: none; } }
.fade-out { animation: title-fade-out 0.8s ease forwards; pointer-events: none; }

/* ===========================
   SAVE SLOT MODAL
   =========================== */
#save-slot-modal {
  display: none; position: fixed; inset: 0; z-index: 6000;
  background: rgba(1,8,0,0.88); align-items: center; justify-content: center;
}
.ssm-box {
  background: var(--panel-bg); border: 2px solid var(--green-dim);
  padding: 28px 32px; min-width: 480px; max-width: 560px; width: 90%;
  display: flex; flex-direction: column; gap: 16px;
}
.ssm-title {
  font-size: 17px; letter-spacing: 4px; text-transform: uppercase;
  color: var(--white); text-shadow: var(--glow); border-bottom: 1px solid var(--green-dim);
  padding-bottom: 10px;
}
.ssm-warn-title { color: var(--amber); text-shadow: var(--amber-glow); }
.ssm-slots { display: flex; flex-direction: column; gap: 10px; }
.ssm-slot {
  border: 1px solid var(--green-dim); padding: 12px 16px; cursor: pointer;
  transition: border-color 0.15s, background 0.15s;
}
.ssm-slot:not(.ssm-disabled):hover { border-color: var(--green); background: rgba(0,230,118,0.06); }
.ssm-slot.ssm-disabled { opacity: 0.38; cursor: default; }
.ssm-slot-num { font-size: 12px; letter-spacing: 3px; color: var(--green-mid); margin-bottom: 4px; }
.ssm-slot-info { font-size: 13px; color: var(--white); }
.ssm-slot-date { font-size: 11px; color: var(--green-dim); margin-top: 2px; }
.ssm-slot-action { font-size: 12px; color: var(--green); margin-top: 6px; letter-spacing: 2px; }
.ssm-slot-action.ssm-warn { color: var(--amber); }
.ssm-cancel {
  background: none; border: 1px solid var(--green-dim); color: var(--green-mid);
  font-family: var(--font); font-size: 13px; letter-spacing: 2px; padding: 7px 18px;
  cursor: pointer; align-self: flex-end; transition: all 0.15s;
}
.ssm-cancel:hover { border-color: var(--green); color: var(--green); }
.ssm-confirm-text { font-size: 14px; color: var(--green-mid); line-height: 1.7; }
.ssm-confirm-btns { display: flex; gap: 12px; justify-content: flex-end; }
.ssm-btn {
  background: none; border: 1px solid var(--green-dim); color: var(--green-mid);
  font-family: var(--font); font-size: 13px; letter-spacing: 2px; padding: 7px 18px;
  cursor: pointer; transition: all 0.15s;
}
.ssm-btn:hover { border-color: var(--green); color: var(--green); }
.ssm-btn-warn { border-color: var(--amber); color: var(--amber); }
.ssm-btn-warn:hover { background: rgba(255,171,0,0.12); }

/* ===========================
   APP WRAPPER
   =========================== */
#app {
  position: relative;
  z-index: 10;
  display: none;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
  animation: crt-flicker 10s infinite;
}
#app.visible { display: flex; }

/* ===========================
   TOP BAR
   =========================== */
#topbar {
  height: 42px;
  flex-shrink: 0;
  background: var(--panel-bg);
  border-bottom: 2px solid var(--green-dim);
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 0 16px;
  font-size: 14px;
  white-space: nowrap;
  overflow: hidden;
}
#topbar .logo { color: var(--green); font-size: 17px; font-weight: bold; letter-spacing: 1px; }
#topbar .sep  { color: var(--green-dim); }
#topbar .clk  { color: var(--white); font-size: 13px; min-width: 72px; }
#topbar .mny  { color: var(--amber); font-size: 17px; font-weight: bold; }
#topbar .sys  { color: var(--green-mid); font-size: 12px; }
#topbar .tb-r { display: flex; align-items: center; gap: 8px; margin-left: auto; flex-shrink: 0; }

/* ===========================
   MAIN ROW
   =========================== */
#main { flex: 1; display: flex; overflow: hidden; }

/* ===========================
   LEFT PANEL
   =========================== */
#res-left {
  width: 22%;
  min-width: 200px;
  max-width: 270px;
  background: var(--panel-bg);
  border-right: 1px solid var(--green-dim);
  overflow-y: auto;
  overflow-x: hidden;
  flex-shrink: 0;
  padding: 8px;
  font-size: 13px;
}
#res-left::-webkit-scrollbar { width: 3px; }
/* Section header */
.sh { color: var(--green-dim); font-size: 11px; letter-spacing: 2px; padding: 7px 4px 3px; border-bottom: 1px solid var(--green-dim); margin-bottom: 5px; text-transform: uppercase; }
/* Resource category headers */
.rl-cat-hd { font-size:10px; letter-spacing:2px; color:var(--green-dim); padding:6px 2px 2px; border-bottom:1px solid #0a1a0a; margin-bottom:3px; }
/* Resource items — horizontal layout */
.rl-item { padding:4px 2px 2px; margin-bottom:2px; border-bottom:1px solid #0a1a0a; }
.rl-row { display:flex; align-items:center; gap:4px; }
.rl-sym { font-size:10px; min-width:22px; flex-shrink:0; font-weight:bold; }
.rl-name { color:var(--green-mid); font-size:11px; flex:1; }
.rl-val { font-size:13px; font-weight:bold; min-width:44px; text-align:right; }
.rl-rate { color:var(--green-dim); font-size:10px; min-width:46px; text-align:right; }
.rl-worker-row { border-top:1px solid var(--green-dim); margin-top:3px; padding-top:5px; }
.rl-bar { height:3px; background:#0a1a0a; margin-top:2px; border-radius:2px; overflow:hidden; }
.rl-bar-fill { height:100%; background:var(--green-mid); transition:width 0.8s; border-radius:2px; }
.rl-bar-fill.amber { background:var(--amber); }
.rl-ms-row { margin-top: 8px; padding: 6px 4px; border: 1px solid #7a5100; background: rgba(255,171,0,0.05); }
.rl-ms-label { color: #7a5100; font-size: 11px; letter-spacing: 1px; }
.rl-ms-val { color: var(--amber); font-size: 16px; font-weight: bold; }

/* ===========================
   WORLD WRAPPER (tab-area만 포함)
   =========================== */
#ww { flex: 1; display: flex; flex-direction: column; overflow: hidden; min-width: 0; }

/* ===========================
   WORLD — 고정 전체화면 배경 레이어
   =========================== */
#world-bg {
  position: fixed;
  inset: 0;
  z-index: 0;
  overflow-x: auto;
  overflow-y: hidden;
  background: linear-gradient(to bottom, #000d03 0%, #011205 38%, #010900 65%, var(--bg) 100%);
  /* 기본: 비생산 탭에서는 흐릿하게 */
  opacity: 0.15;
  filter: blur(2px) brightness(0.5);
  transition: opacity 0.5s, filter 0.5s;
  pointer-events: none;
}
/* 생산 탭에서는 선명하게 + 드래그 가능 */
body.tab-production #world-bg {
  opacity: 0.5;
  filter: none;
  pointer-events: auto;
  cursor: grab;
}
body.tab-production #world-bg:active { cursor: grabbing; }
/* 발사 통제 탭에서는 좌측 자원 패널 숨김 */
body.tab-launch #res-left { display: none; }
#world-bg::-webkit-scrollbar { height: 6px; }
#world-bg::-webkit-scrollbar-track { background: #010800; border-top: 1px solid var(--green-dim); }
#world-bg::-webkit-scrollbar-thumb { background: var(--green-dim); border-radius: 3px; }

#world-scene {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 3200px;
  height: 220px;
}
#sky-layer { position: absolute; top: 0; left: 0; width: 100%; height: 160px; }
.star { position: absolute; width: 2px; height: 2px; background: var(--green-dim); opacity: 0.6; }
#buildings-layer { position: absolute; bottom: 32px; left: 0; width: 100%; }
#ground-line { position: absolute; bottom: 0; left: 0; width: 100%; height: 32px; background: linear-gradient(to bottom, #0a1a08, #020d04); border-top: 2px solid var(--green-dim); }
#workers-layer { position: absolute; bottom: 32px; left: 0; width: 100%; }

/* World buildings */
.world-building { position: absolute; bottom: 0; }
.wb-mine { width: 70px; height: 85px; background: #0a1808; border: 2px solid var(--green-dim); border-bottom: none; position: relative; }
.wb-mine::before { content: ''; position: absolute; top: -8px; left: 10px; right: 10px; height: 8px; background: #0a2010; border: 2px solid var(--green-dim); border-bottom: none; }
.wb-mine .conveyor { position: absolute; bottom: 20px; right: -20px; width: 22px; height: 8px; background: #0a1a08; border: 1px solid var(--green-dim); transform: rotate(-20deg); }
.mine-light { position: absolute; top: 6px; right: 8px; width: 6px; height: 6px; background: var(--amber); box-shadow: 0 0 6px var(--amber); animation: mine-blink 2s step-start infinite; }
@keyframes mine-blink { 0%,100% { opacity: 1; } 50% { opacity: 0.2; } }
.wb-refinery { width: 100px; height: 100px; display: flex; align-items: flex-end; gap: 6px; position: absolute; bottom: 0; }
.refinery-tank { width: 40px; background: #081408; border: 2px solid var(--green-dim); border-bottom: none; position: relative; }
.refinery-tank.tall { height: 90px; }
.refinery-tank.short { height: 65px; }
.refinery-tank::before { content: ''; position: absolute; top: -6px; left: -2px; right: -2px; height: 6px; background: #0a1a08; border: 2px solid var(--green-dim); }
.wb-research { width: 110px; height: 75px; background: #060f08; border: 2px solid var(--green-dim); border-bottom: none; position: relative; }
.wb-research::before { content: ''; position: absolute; top: -10px; left: 30px; right: 30px; height: 10px; background: #0a1808; border: 2px solid var(--green-dim); border-bottom: none; }
.research-windows { position: absolute; top: 10px; left: 6px; right: 6px; display: flex; flex-wrap: wrap; gap: 4px; }
.research-win { width: 16px; height: 14px; background: #0a1a10; border: 1px solid var(--green-dim); }
.research-win.lit { background: var(--green-dim); box-shadow: 0 0 4px var(--green-dim); }
.wb-ops { width: 90px; height: 70px; background: #060f08; border: 2px solid var(--green-dim); border-bottom: none; position: relative; }
.ops-windows { position: absolute; top: 8px; left: 4px; right: 4px; display: flex; flex-wrap: wrap; gap: 3px; }
.ops-win { width: 14px; height: 12px; background: #0a1a10; border: 1px solid var(--green-dim); }
.ops-win.lit { background: var(--green-dim); }
.ops-sign { position: absolute; bottom: 6px; left: 50%; transform: translateX(-50%); width: 40px; height: 6px; background: var(--green-dim); opacity: 0.6; }
.wb-eleclab { width: 90px; height: 70px; background: #060f08; border: 2px solid var(--green-dim); border-bottom: none; position: relative; }
.wb-solar { display: flex; align-items: flex-end; gap: 8px; position: absolute; bottom: 0; }
.solar-pole { width: 4px; height: 50px; background: var(--green-dim); }
.solar-panel { width: 30px; height: 20px; background: #060f20; border: 1px solid var(--green-dim); position: relative; top: -30px; }
.wb-launchpad { width: 80px; height: 110px; position: absolute; bottom: 0; }
.lp-gantry { position: absolute; top: 0; left: 10px; width: 4px; height: 80px; background: var(--green-dim); }
.lp-rocket { position: absolute; top: 10px; left: 16px; width: 20px; height: 60px; background: #0a2010; border: 1px solid var(--green); }
.lp-base { position: absolute; bottom: 0; left: 0; width: 80px; height: 16px; background: #0a1a08; border: 2px solid var(--green-dim); }

/* ===========================
   NAV TABS
   =========================== */
#nav-tabs {
  flex-shrink: 0;
  display: flex;
  border-bottom: var(--border);
  background: var(--panel-bg);
}
.nav-tab {
  flex: 0 0 auto;
  min-width: 90px;
  padding: 9px 18px;
  background: none;
  border: none;
  border-bottom: 3px solid transparent;
  color: var(--green-dim);
  font-family: var(--font);
  font-size: 13px;
  letter-spacing: 1px;
  cursor: pointer;
  text-transform: uppercase;
  transition: all 0.15s;
  text-align: center;
  border-right: var(--border);
}
.nav-tab:last-child { border-right: none; }
.nav-tab:hover { color: var(--green); }
.nav-tab.active { color: var(--green); border-bottom-color: var(--green); text-shadow: var(--glow-strong); background: rgba(0,230,118,0.04); }
.nav-tab.new-unlock { animation: tab-unlock 0.8s ease; }
@keyframes tab-unlock { 0% { color: var(--amber); text-shadow: 0 0 20px var(--amber); } 100% { color: var(--green); } }

/* ── Tab Unlock Flash Banner ── */
#tab-unlock-flash { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; pointer-events: none; text-align: center; }
#tab-unlock-flash.tuf-hidden { display: none; }
#tab-unlock-flash.tuf-visible { display: block; animation: tuf-in 0.3s ease, tuf-out 0.5s ease 2.1s forwards; }
.tuf-inner { background: rgba(0,0,0,0.92); border: 1px solid var(--amber); padding: 28px 48px; box-shadow: 0 0 60px rgba(255,171,0,0.3), inset 0 0 30px rgba(255,171,0,0.05); }
.tuf-top  { font-size: 11px; color: #7a5100; letter-spacing: 4px; margin-bottom: 10px; }
.tuf-main { font-size: 28px; color: var(--amber); letter-spacing: 6px; text-shadow: 0 0 30px var(--amber), 0 0 60px rgba(255,171,0,0.5); margin-bottom: 8px; animation: tuf-pulse 0.6s ease infinite alternate; }
.tuf-sub  { font-size: 12px; color: var(--green-mid); letter-spacing: 4px; }
@keyframes tuf-in  { 0% { opacity:0; transform:scale(0.85); } 100% { opacity:1; transform:scale(1); } }
@keyframes tuf-out { 0% { opacity:1; } 100% { opacity:0; } }
@keyframes tuf-pulse { 0% { text-shadow: 0 0 20px var(--amber); } 100% { text-shadow: 0 0 40px var(--amber), 0 0 80px rgba(255,171,0,0.6); } }

/* ===========================
   OFFLINE BANNER
   =========================== */
#offline-banner {
  display: none;
  background: rgba(255,171,0,0.08);
  border-bottom: 1px solid var(--amber);
  color: var(--amber);
  padding: 6px 14px;
  font-size: 13px;
  flex-shrink: 0;
}

/* ===========================
   TAB CONTENT AREA
   =========================== */
#tab-area { flex: 1; overflow-y: auto; }
.tab-pane { display: none; padding: 14px 12px; }
.tab-pane.active { display: block; }

/* Panels */
.panel { background: rgba(2,13,4,0.96); border: var(--border); padding: 12px 16px; margin-bottom: 12px; }
.panel-header { font-size: 15px; letter-spacing: 3px; color: var(--green); text-transform: uppercase; border-bottom: var(--border); padding-bottom: 8px; margin-bottom: 10px; text-shadow: var(--glow); }
.panel-header::before { content: '// '; }

/* Buttons */
.btn { background: none; border: 2px solid var(--green-dim); color: var(--green); font-family: var(--font); font-size: 14px; letter-spacing: 1px; padding: 7px 14px; cursor: pointer; text-transform: uppercase; transition: all 0.12s; }
.btn:hover:not(:disabled) { border-color: var(--green); text-shadow: var(--glow); }
.btn:disabled { opacity: 0.3; cursor: not-allowed; }
.btn-amber { border-color: var(--amber); color: var(--amber); }
.btn-sm { font-size: 12px; padding: 4px 10px; letter-spacing: 0; }
.btn-full { display: block; width: 100%; text-align: center; margin-top: 8px; }

/* v7a overlay button style */
.obtn { padding: 5px 11px; border: 1px solid var(--green); color: var(--green); cursor: pointer; font-family: var(--font); font-size: 13px; background: transparent; transition: background .13s, color .13s; white-space: nowrap; }
.obtn:hover { background: var(--green); color: var(--bg); }
.obtn.a { border-color: var(--amber); color: var(--amber); }
.obtn.a:hover { background: var(--amber); color: var(--bg); }
.obtn.off { opacity: .35; cursor: not-allowed; pointer-events: none; }

/* Sound button */
#sound-btn { background: none; border: 1px solid var(--green-dim); color: var(--green-dim); font-family: var(--font); font-size: 12px; letter-spacing: 1px; padding: 3px 8px; cursor: pointer; text-transform: uppercase; transition: all 0.12s; }
#sound-btn:hover { color: var(--green); border-color: var(--green); }
#bgm-prev-btn { font-size: 11px; padding: 3px 7px; border: 1px solid var(--green-dim); background: transparent; color: var(--green-mid); cursor: pointer; font-family: var(--font); transition: all 0.12s; }
#bgm-prev-btn:hover { color: var(--green); border-color: var(--green); }
#lang-btn { font-size: 11px; padding: 3px 8px; border: 1px solid var(--amber); background: transparent; color: var(--amber); cursor: pointer; font-family: var(--font); letter-spacing: 1px; transition: all 0.12s; }
#lang-btn:hover { color: #ffe080; border-color: #ffe080; }
#bgm-track-label { font-size: 11px; color: var(--green-dim); min-width: 80px; }

/* Progress bars */
.prog-wrap { border: 1px solid var(--green-dim); height: 8px; background: var(--bg); overflow: hidden; margin: 4px 0; }
.prog-fill { height: 100%; background: var(--green-mid); transition: width 0.3s; }
.prog-fill.amber { background: var(--amber); }

/* Notifications */
#notif { position: fixed; bottom: 40px; right: 20px; z-index: 8000; display: flex; flex-direction: column; gap: 7px; pointer-events: none; }
.notif-item { background: var(--panel-bg); border: 1px solid var(--green-dim); color: var(--green); font-size: 13px; padding: 7px 14px; text-shadow: var(--glow); animation: notif-in 0.2s ease, notif-out 0.4s ease 2.6s forwards; max-width: 320px; }
.notif-item.amber { border-color: var(--amber); color: var(--amber); }
.notif-item.red { border-color: var(--red); color: var(--red); }
@keyframes notif-in { from { opacity: 0; transform: translateX(40px); } to { opacity: 1; transform: none; } }
@keyframes notif-out { to { opacity: 0; transform: translateX(40px); } }

/* ===========================
   RIGHT PANEL
   =========================== */
#rp {
  width: 155px;
  background: var(--panel-bg);
  border-left: 1px solid var(--green-dim);
  overflow-y: auto;
  flex-shrink: 0;
  padding: 8px 6px;
  font-size: 12px;
}
#rp::-webkit-scrollbar { width: 3px; }
#rp::-webkit-scrollbar-thumb { background: var(--green-dim); }
.rph { color: var(--green-dim); font-size: 11px; letter-spacing: 2px; padding-bottom: 4px; border-bottom: 1px solid var(--green-dim); margin-bottom: 6px; text-transform: uppercase; }
.strow { padding: 4px 2px; border-bottom: 1px solid rgba(26,92,52,.4); margin-bottom: 4px; }
.stn { color: var(--white); font-size: 12px; }
.stl { color: var(--green-mid); font-size: 11px; margin-top: 1px; }
.sts { font-size: 11px; margin-top: 1px; }
.gbar { height: 5px; background: var(--green-dim); margin-top: 3px; border-radius: 2px; overflow: hidden; }
.gfill { height: 100%; background: var(--green); border-radius: 2px; transition: width 0.9s ease; }
.gfill.a { background: var(--amber); }

/* ===========================
   TICKER
   =========================== */
#ticker {
  flex-shrink: 0;
  background: var(--panel-bg);
  border-top: 1px solid var(--green-dim);
  height: 30px;
  display: flex;
  align-items: center;
  padding: 0 14px;
  font-size: 12px;
  color: var(--green-mid);
  white-space: nowrap;
  overflow: hidden;
}
#tki { display: inline-block; animation: tkrun 45s linear infinite; }
@keyframes tkrun { 0% { transform: translateX(100vw); } 100% { transform: translateX(-100%); } }
.tw { color: var(--amber); }
.to { color: var(--green); }
.ts { color: var(--green-dim); margin: 0 20px; }

/* ===========================
   ASCII WORLD BUILDINGS
   =========================== */
.world-bld {
  position: absolute;
  bottom: 0;
  font-family: var(--font);
  font-size: 11px;
  line-height: 1.25;
  color: var(--green-dim);
  white-space: pre;
  cursor: pointer;
  user-select: none;
  padding: 0;
  text-shadow: 0 0 4px rgba(0,230,118,0.25);
  transition: color 0.2s, opacity 0.2s, filter 0.2s, text-shadow 0.15s;
}
.world-bld:hover { color: var(--green); text-shadow: 0 0 10px #00e67680; }
.world-bld.active-bld { color: var(--green); text-shadow: 0 0 8px #00e67680; }

/* ── Building state classes ── */
.world-bld.wb-state-ghost  { opacity: 0.15; filter: sepia(1) hue-rotate(80deg) brightness(0.5); pointer-events: none; cursor: default; }
.world-bld.wb-state-idle   { opacity: 0.60; color: #2a5a38; }
.world-bld.wb-state-active { opacity: 1; color: var(--green); text-shadow: 0 0 8px rgba(0,230,118,0.55); }
.world-bld.wb-state-active:hover { text-shadow: 0 0 16px #00e676cc; }
.world-bld.wb-state-idle:hover { pointer-events: auto; opacity: 0.75; }

/* ── Add-on buildings ── */
.world-bld.wb-addon         { color: var(--amber); text-shadow: 0 0 6px rgba(255,171,0,0.4); }
.world-bld.wb-addon:hover   { color: #ffdd55; text-shadow: 0 0 14px rgba(255,171,0,0.8); }
.world-bld.wb-addon-ph      { opacity: 0.28; animation: addon-pulse 2s ease-in-out infinite; color: var(--amber); }
@keyframes addon-pulse { 0%,100%{opacity:0.2} 50%{opacity:0.4} }

/* ── Building overlay separator label ── */
.bov-sep-label { font-size:10px; color:var(--green-mid); padding:4px 10px 2px; letter-spacing:1px; border-top:1px solid #0a1a0a; margin-top:2px; }

/* Worker dots */
.wkr {
  position: absolute;
  color: var(--green);
  font-size: 11px;
  line-height: 1;
  text-shadow: 0 0 5px var(--green);
  bottom: 6px;
  pointer-events: none;
}

/* ===========================
   BUILDING HOVER OVERLAY
   =========================== */
/* ── Building overlay (2-panel) ── */
#bld-ov { position:fixed; display:none; z-index:9600; background:rgba(1,8,0,0.97); border:1px solid var(--green); box-shadow:0 0 22px rgba(0,230,118,0.18); font-family:var(--font); font-size:12px; color:var(--green); }
.bov-head { display:flex; justify-content:space-between; align-items:center; padding:7px 12px; border-bottom:1px solid var(--green-dim); }
.bov-head-name { color:var(--white); font-size:13px; }
.bov-head-meta { color:var(--green-dim); font-size:11px; }
.bov-body { display:flex; min-height:120px; }
.bov-acts-col { flex:1; border-right:1px solid #0a1a0a; overflow-y:auto; max-height:220px; }
.bov-desc-col { width:180px; flex-shrink:0; padding:10px; }
.bov-desc-hint { color:#1a3a1a; font-size:10px; line-height:1.7; }
.bov-desc-name { color:var(--green); font-size:12px; margin-bottom:5px; font-weight:bold; }
.bov-desc-body { color:var(--green-mid); font-size:11px; line-height:1.7; }
.bov-act { display:flex; align-items:center; gap:6px; padding:6px 10px; border-bottom:1px solid #0a1a0a; cursor:pointer; }
.bov-act:last-child { border-bottom:none; }
.bov-act:hover { background:rgba(0,230,118,0.05); }
.bov-act-label { flex:1; color:var(--white); font-size:12px; }
.bov-done .bov-act-label { color:var(--green-dim); }
.bov-locked .bov-act-label { color:#2a3a2a; }
.bov-need .bov-act-label { color:#2a4a2a; }
/* Worker assign/unassign rows — amber accent */
.bov-act.bov-worker { background:rgba(255,171,0,0.04); border-left:2px solid #7a5100; }
.bov-act.bov-worker:hover { background:rgba(255,171,0,0.09); }
.bov-act.bov-worker .bov-act-label { color:var(--amber); }
.bov-act.bov-worker .bov-act-btn:not(.dis) { border-color:var(--amber); color:var(--amber); }
.bov-act.bov-worker .bov-act-info { color:#a06800; }
.bov-act-btn { padding:2px 7px; font-size:10px; font-family:var(--font); background:transparent; border:1px solid var(--green-dim); color:var(--green-mid); cursor:pointer; white-space:nowrap; }
.bov-act-btn:hover:not(.dis) { border-color:var(--green); color:var(--green); }
.bov-act-btn.dis { border-color:#1a3a1a; color:#1a3a1a; cursor:default; }
.bov-act-info { font-size:10px; color:var(--green-dim); white-space:nowrap; }
.bov-act-info.red { color:var(--red); }
.bov-act-empty { padding:10px; color:#1a3a1a; font-size:11px; }
.bov-foot { padding:6px 10px 8px; border-top:1px solid #0a1a0a; }
.bov-buy-btn { display:block; width:100%; padding:5px 10px; font-family:var(--font); font-size:11px; background:transparent; border:1px solid var(--green-dim); color:var(--green-mid); cursor:pointer; text-align:left; }
.bov-buy-btn:hover:not(.dis) { border-color:var(--green); color:var(--green); }
.bov-buy-btn.dis { opacity:0.4; cursor:default; }
.bov-buy-cost { float:right; color:var(--green-dim); font-size:10px; }

/* ── Tech tooltip (research tab hover) ── */
#tech-tip { position:fixed; display:none; z-index:9700; background:rgba(1,8,0,0.97); border:1px solid var(--green); width:256px; padding:10px 12px; box-shadow:0 0 20px rgba(0,230,118,0.15); font-family:var(--font); font-size:12px; }
.tt-head { display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #0a2a0a; padding-bottom:6px; margin-bottom:6px; }
.tt-head > span:first-child { color:var(--green); font-size:13px; }
.tt-status { font-size:10px; letter-spacing:1px; }
.tt-ok   { color:var(--green); }
.tt-rdy  { color:var(--amber); }
.tt-lock { color:#2a3a2a; }
.tt-need { color:#1a4020; }
.tt-desc { color:var(--green-mid); font-size:11px; margin-bottom:8px; line-height:1.6; }
.tt-sub  { font-size:10px; color:var(--green-dim); letter-spacing:2px; text-transform:uppercase; margin:8px 0 4px; }
.tt-cost-row { display:flex; justify-content:space-between; font-size:11px; color:var(--green-mid); padding:2px 0; }
.tt-row  { font-size:11px; color:var(--green-dim); padding:2px 0; }
.tt-viz  { margin-top:8px; border:1px solid #3a2800; background:rgba(255,171,0,0.04); padding:7px 9px; }
.tt-viz-hd { font-size:10px; color:#7a5100; letter-spacing:2px; margin-bottom:4px; }
.tt-viz-bar { color:var(--amber); font-size:11px; font-family:var(--font); margin:1px 0; }
.tt-viz-stat { color:var(--amber); font-size:12px; margin-top:5px; letter-spacing:1px; text-shadow:var(--amber-glow); }

/* ===========================
   PRODUCTION TAB
   =========================== */
#prod-status { font-size: 13px; color: var(--green-mid); margin-bottom: 10px; border-bottom: var(--border); padding-bottom: 8px; }

/* ===========================
   ROCKET BUILD TAB (첫 번째 탭 — 우주선 제작 현황)
   =========================== */
.rc-layout { display:flex; gap:14px; align-items:flex-start; }
.rc-art-col { flex-shrink:0; text-align:center; min-width:120px; }
.rc-art-label { font-size:9px; letter-spacing:3px; color:var(--green-dim); margin-bottom:6px; }
.rc-art { font-size:12px; color:var(--green); line-height:1.35; margin:0; text-shadow:0 0 8px rgba(0,230,118,0.5); display:inline-block; text-align:left; }
.rc-phase-badge { font-size:10px; letter-spacing:2px; margin-top:8px; }
.rc-main-col { flex:1; min-width:0; }
.rc-section-hd { font-size:10px; letter-spacing:2px; color:var(--green-mid); border-bottom:1px solid var(--green-dim); padding-bottom:4px; margin-bottom:8px; }
.rc-build-rows { margin-bottom:12px; }
.rc-build-row { display:flex; align-items:center; gap:6px; margin-bottom:4px; }
.rc-bl { color:var(--green-dim); min-width:52px; font-size:10px; letter-spacing:1px; }
.rc-bar { color:var(--green); font-size:11px; flex:1; }
.rc-bv { color:var(--green-mid); font-size:10px; min-width:36px; text-align:right; }
.rc-next-obj { border:1px solid #3a2800; background:rgba(255,171,0,0.05); padding:8px 12px; font-size:12px; color:var(--amber); line-height:1.6; }
.rc-next-obj strong { color:var(--white); }
.rc-phases { display:flex; flex-direction:column; gap:4px; }
.rc-phase-row { display:flex; align-items:center; gap:6px; }
.rc-phase-name { color:var(--green-dim); font-size:10px; letter-spacing:1px; min-width:140px; }
.rc-phase-bar-wrap { flex:1; height:6px; border:1px solid var(--green-dim); background:var(--bg); overflow:hidden; }
.rc-phase-bar-fill { height:100%; background:var(--green-dim); transition:width 0.5s; }
.rc-phase-bar-fill.done { background:var(--green); box-shadow:0 0 4px var(--green); }
.rc-phase-pct { min-width:48px; text-align:right; font-size:10px; letter-spacing:1px; }
.rc-stats-col { flex-shrink:0; min-width:128px; background:var(--panel-bg); border:var(--border); padding:8px 10px; }
.rc-stat-hd { font-size:9px; letter-spacing:3px; color:var(--green-mid); border-bottom:var(--border); padding-bottom:4px; margin-bottom:6px; }
.rc-stat-row { display:flex; justify-content:space-between; font-size:11px; padding:3px 0; border-bottom:1px solid #0a1a0a; gap:4px; }
.rc-sl { color:var(--green-dim); }
.rc-sv { color:var(--green); text-align:right; }

/* ===========================
   RESEARCH TAB
   =========================== */
/* research layout — vertical scroll, no fixed height */
#research-layout { min-height: 0; }
.rsh-layout { display: flex; gap: 12px; align-items: flex-start; }
.rsh-sidebar { width: 210px; flex-shrink: 0; background: var(--panel-bg); border: var(--border); padding: 10px; }
.rsh-sb-hd { font-size: 10px; letter-spacing: 3px; color: var(--green-mid); text-transform: uppercase; border-bottom: var(--border); padding-bottom: 5px; margin-bottom: 8px; }
.rsh-sb-sub { font-size: 10px; letter-spacing: 2px; color: var(--green-dim); text-transform: uppercase; margin: 10px 0 4px; }
.rsh-stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-bottom: 6px; }
.rsh-stat { border: var(--border); padding: 5px; }
.rsh-stat-full { grid-column: span 2; }
.rsh-stat-l { font-size: 10px; color: var(--green-dim); }
.rsh-stat-v { font-size: 13px; color: var(--green); }
.rsh-src-row, .rsh-recent-row { display: flex; justify-content: space-between; font-size: 11px; color: var(--green-mid); padding: 2px 0; border-bottom: 1px solid #0a1a0a; }
.rsh-empty { font-size: 11px; color: #1a3a1a; }
.rsh-cards-area { flex: 1; min-width: 0; }
.rsh-tier { margin-bottom: 10px; border: var(--border); }
.rsh-tier-hd { font-size: 10px; letter-spacing: 3px; color: var(--green-mid); background: var(--panel-bg); padding: 6px 10px; text-transform: uppercase; border-bottom: var(--border); }
.rsh-card { border-bottom: 1px solid #0a1a0a; cursor: pointer; transition: background 0.1s; padding: 0 10px; }
.rsh-card:last-child { border-bottom: none; }
.rsh-card:hover { background: rgba(0,230,118,0.03); }
.rsh-card.open { background: rgba(0,200,100,0.05); }
.rsh-card.done .rsh-card-row { opacity: 0.55; }
.rsh-card-row { display: flex; align-items: center; gap: 8px; padding: 8px 0; }
.rsh-icon { color: var(--green-mid); font-size: 12px; min-width: 36px; }
.rsh-name { flex: 1; color: var(--white); font-size: 13px; }
.rsh-pills { display: flex; gap: 4px; flex-wrap: wrap; }
.rsh-cost-ok { font-size: 10px; color: var(--green-dim); }
.rsh-cost-ng { font-size: 10px; color: var(--red); }
.rsh-status { font-size: 10px; min-width: 72px; text-align: right; letter-spacing: 1px; }
.rsh-ok   { color: var(--green); }
.rsh-rdy  { color: var(--amber); }
.rsh-lock { color: #2a3a2a; }
.rsh-need { color: #1a4020; }
.rsh-arrow { font-size: 10px; color: var(--green-dim); min-width: 12px; }
.rsh-expand { padding: 10px 0 14px; border-top: 1px solid #0a2010; }
.rsh-det-desc { font-size: 12px; color: var(--green-mid); margin-bottom: 8px; }
.rsh-det-row { font-size: 11px; color: var(--green-dim); padding: 2px 0; }
.rsh-det-cost { display: flex; justify-content: space-between; font-size: 12px; color: var(--green-mid); padding: 2px 0; }
.rsh-det-sub { font-size: 10px; color: var(--green-dim); letter-spacing: 2px; text-transform: uppercase; margin: 8px 0 4px; }
.rsh-viz-box { margin-top: 10px; border: 1px solid #3a2800; background: rgba(255,171,0,0.04); padding: 8px 10px; }
.rsh-viz-hd { font-size: 10px; color: #7a5100; letter-spacing: 2px; margin-bottom: 5px; }
.rsh-viz-bar { color: var(--amber); font-size: 12px; font-family: var(--font); margin: 2px 0; }
.rsh-viz-stat { color: var(--amber); font-size: 13px; margin-top: 6px; letter-spacing: 1px; text-shadow: var(--amber-glow); }
#panel-right-research { width: 25%; flex-shrink: 0; background: var(--panel-bg); border-left: var(--border); display: flex; flex-direction: column; overflow: hidden; }
.r-panel-header { padding: 8px 12px; background: #041208; border-bottom: var(--border); font-size: 11px; letter-spacing: 3px; text-transform: uppercase; color: var(--green); text-shadow: var(--glow); }
.r-panel-header::before { content: '> '; }
.r-panel-scroll { flex: 1; overflow-y: auto; padding: 10px; }
.res-queue-card { border: var(--border); padding: 8px 10px; margin-bottom: 8px; background: #010f04; }
.rqc-title { font-size: 13px; color: var(--green); text-shadow: var(--glow); margin-bottom: 4px; }
.rqc-sub { font-size: 11px; color: var(--green-dim); letter-spacing: 1px; margin-bottom: 4px; }
.rqc-flash { font-size: 12px; color: var(--amber); text-shadow: var(--amber-glow); animation: pulse-amber 0.5s ease-in-out 3; }
@keyframes pulse-amber { 0%,100% { opacity: 1; } 50% { opacity: 0.4; } }
#tree-container { flex: 1; overflow: auto; padding: 14px; position: relative; }
.branch-headers { display: flex; gap: 4px; margin-bottom: 10px; min-width: 800px; }
.branch-header { flex: 1; text-align: center; padding: 5px; border: var(--border); background: #041208; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--green); text-shadow: var(--glow); }
.branch-header.locked { border-color: #1a1f1a; color: #3a4a3a; text-shadow: none; }
#tree-svg { display: block; min-width: 800px; }
.tech-node { cursor: pointer; }
.detail-tech-id { font-size: 11px; letter-spacing: 3px; color: var(--green-dim); text-transform: uppercase; margin-bottom: 2px; }
.detail-tech-name { font-size: 15px; color: var(--green); text-shadow: var(--glow-strong); margin-bottom: 2px; letter-spacing: 1px; }
.detail-divider { border: none; border-top: var(--border); margin: 8px 0; }
.status-badge { display: inline-block; padding: 3px 10px; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; border: 1px solid; margin-bottom: 8px; }
.status-complete { color: var(--green); border-color: var(--green); background: #011a0a; }
.status-available { color: var(--green); border-color: var(--green-mid); background: #010f04; }
.status-locked { color: #3a4a3a; border-color: #2a2f2a; background: #1a1f1a; }
.detail-row { display: flex; justify-content: space-between; font-size: 12px; padding: 3px 0; border-bottom: 1px solid #091608; }
.detail-row .dr-key { color: var(--green-dim); text-transform: uppercase; letter-spacing: 1px; font-size: 11px; }
.detail-row .dr-val { color: var(--green); text-align: right; }
.btn-research { display: block; width: 100%; margin-top: 12px; background: none; border: 2px solid var(--green-mid); color: var(--green); font-family: var(--font); font-size: 14px; letter-spacing: 2px; padding: 9px; cursor: pointer; text-transform: uppercase; transition: all 0.15s; }
.btn-research:hover:not(:disabled) { border-color: var(--green); text-shadow: var(--glow-strong); }
.btn-research:disabled { opacity: 0.3; cursor: not-allowed; }
.rp-section { margin-top: 12px; border-top: 1px solid #0d2016; padding-top: 10px; }
.rp-section-title { font-size: 11px; letter-spacing: 2px; color: var(--green-dim); text-transform: uppercase; margin-bottom: 6px; }
.lab-item { display: flex; justify-content: space-between; font-size: 12px; color: var(--green-mid); padding: 3px 0; border-bottom: 1px solid #091608; }
.lab-item .lab-rate { color: var(--green); text-shadow: var(--glow); }
.overview-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 8px; }
.ov-card { border: var(--border); background: #010f04; padding: 8px; text-align: center; }
.ov-num { font-size: 20px; color: var(--green); text-shadow: var(--glow-strong); line-height: 1.2; }
.ov-num.amber { color: var(--amber); text-shadow: var(--amber-glow); }
.ov-label { font-size: 11px; letter-spacing: 1px; text-transform: uppercase; color: var(--green-dim); margin-top: 2px; }

/* ===========================
   RESEARCH TAB v2 — horizontal card tree
   =========================== */
.rsh-layout2 { display:flex; height:100%; min-height:0; }
.rsh-tree-area { flex:1; overflow:auto; padding:10px 14px; }
.rsh-tier-row { display:flex; align-items:flex-start; gap:0; }
.rsh-tier-col { display:flex; flex-direction:column; gap:6px; min-width:132px; }
.rsh-tier-label2 { font-size:9px; letter-spacing:2px; color:var(--green-mid); text-transform:uppercase; padding:4px 6px; background:var(--panel-bg); border:var(--border); margin-bottom:2px; text-align:center; }
.rsh-tier-arrow { display:flex; align-items:flex-start; justify-content:center; width:26px; padding-top:34px; color:var(--green-dim); font-size:14px; flex-shrink:0; }
.rsh-card2 { border:1px solid var(--green-dim); padding:7px 8px; cursor:pointer; transition:border-color 0.12s,background 0.12s,box-shadow 0.12s; min-height:62px; display:flex; flex-direction:column; gap:3px; background:rgba(1,8,0,0.85); }
.rsh-card2:hover { border-color:var(--green); background:rgba(0,230,118,0.04); }
.rsh-card2.selected { border-color:var(--green); background:rgba(0,230,118,0.07); box-shadow:0 0 8px rgba(0,230,118,0.15); }
.rsh-card2.done { border-color:#1a4a2a; opacity:0.65; }
.rsh-card2.locked { border-color:#0f1a0f; cursor:default; opacity:0.45; }
.rsh-card2.available { animation:node-available-pulse 2s ease-in-out infinite; }
@keyframes node-available-pulse { 0%,100%{box-shadow:0 0 4px rgba(0,153,77,0.3)} 50%{box-shadow:0 0 10px rgba(0,230,118,0.45)} }
.rsh-c2-icon { font-size:14px; }
.rsh-c2-name { color:var(--white); font-size:10px; line-height:1.3; }
.rsh-c2-status { font-size:9px; letter-spacing:1px; margin-top:2px; }
/* Research detail panel (right side) */
.rsh-detail-panel { width:196px; flex-shrink:0; background:var(--panel-bg); border-left:var(--border); overflow-y:auto; padding:10px; }
.rdp-hd { font-size:10px; letter-spacing:3px; color:var(--green-mid); text-transform:uppercase; border-bottom:var(--border); padding-bottom:5px; margin-bottom:8px; }
.rdp-icon { font-size:22px; margin-bottom:4px; }
.rdp-name { font-size:13px; color:var(--green); text-shadow:var(--glow); margin-bottom:2px; }
.rdp-status { font-size:10px; letter-spacing:1px; margin-bottom:8px; }
.rdp-desc { font-size:11px; color:var(--green-mid); line-height:1.6; margin-bottom:8px; }
.rdp-sub { font-size:10px; letter-spacing:2px; color:var(--green-dim); text-transform:uppercase; margin:6px 0 3px; border-top:1px solid #0a1a0a; padding-top:5px; }
.rdp-cost-row { display:flex; justify-content:space-between; font-size:10px; color:var(--green-mid); padding:2px 0; border-bottom:1px solid #0a1a0a; }
.rdp-viz { margin-top:8px; border:1px solid #3a2800; background:rgba(255,171,0,0.04); padding:6px 8px; }
.rdp-viz-hd { font-size:9px; color:#7a5100; letter-spacing:2px; margin-bottom:3px; }
.rdp-viz-bar { color:var(--amber); font-size:10px; margin:1px 0; }
.rdp-viz-stat { color:var(--amber); font-size:11px; margin-top:3px; }
.rdp-btn { display:block; width:100%; margin-top:10px; background:none; border:1px solid var(--green-mid); color:var(--green); font-family:var(--font); font-size:12px; letter-spacing:1px; padding:7px; cursor:pointer; text-transform:uppercase; transition:all 0.15s; }
.rdp-btn:hover:not(:disabled) { border-color:var(--green); text-shadow:var(--glow); }
.rdp-btn:disabled { opacity:0.3; cursor:not-allowed; }
.rdp-empty { font-size:11px; color:#1a3a1a; line-height:1.8; }

/* ===========================
   ASSEMBLY TAB
   =========================== */
.assembly-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.rocket-art-wrap { text-align: center; padding: 10px; border: var(--border); background: var(--bg); min-height: 280px; display: flex; align-items: center; justify-content: center; }
#rocket-art-display { font-size: 13px; white-space: pre; line-height: 1.3; color: var(--green-dim); }
#rocket-art-display .done { color: var(--green); text-shadow: var(--glow); }
.parts-list-item { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #0e2a18; padding: 6px 0; font-size: 13px; gap: 8px; }
.part-done { color: var(--green); text-shadow: var(--glow); }
.part-pending { color: var(--green-dim); }
.quality-selector { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px; }
.q-btn { flex: 1; min-width: 100px; }
.q-btn.selected { border-color: var(--amber); color: var(--amber); box-shadow: 0 0 8px var(--amber); }
.slot-card { border: var(--border); background: var(--panel-bg); padding: 10px 14px; margin-bottom: 10px; }
.slot-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
.slot-title { font-size: 13px; color: var(--green); letter-spacing: 1px; }
.slot-state.idle { color: var(--green-mid); }
.slot-state.busy { color: var(--amber); }
.slot-state.ready { color: var(--green); text-shadow: var(--glow); }
.science-box { border: var(--border); background: var(--bg); padding: 10px 14px; font-size: 12px; color: var(--green-mid); margin-top: 10px; line-height: 1.7; }
.science-box .val { color: var(--green); }
.science-box .ms-val { color: var(--amber); }

/* ===========================
   LAUNCH TAB — V7D 3-COLUMN
   =========================== */
/* pane-launch 활성화 시 flex 3컬럼 */
#pane-launch.active { display: flex; height: 100%; padding: 0; overflow: hidden; }

/* 컬럼 공통 */
.lc-col { overflow-y: auto; overflow-x: hidden; flex-shrink: 0; }
.lc-col::-webkit-scrollbar { width: 3px; }
.lc-col::-webkit-scrollbar-thumb { background: var(--green-dim); }
.lc-col-left   { flex: 0 0 28%; max-width: 28%; border-right: 1px solid var(--green-dim); background: var(--panel-bg); }
.lc-col-center { flex: 0 0 44%; max-width: 44%; background: var(--bg); display: flex; flex-direction: column; overflow: hidden; }
.lc-col-right  { flex: 0 0 28%; max-width: 28%; border-left: 1px solid var(--green-dim); background: var(--panel-bg); }

/* LC 패널 (v7d 스타일) */
.lc-panel { padding: 8px 10px; border-bottom: 1px solid var(--green-dim); }
.lc-pnl-title { color: var(--green-dim); font-size: 10px; letter-spacing: .15em; text-transform: uppercase; margin-bottom: 5px; border-bottom: 1px solid var(--green-dim); padding-bottom: 3px; }
.lc-pnl-title.green { color: var(--green); text-shadow: var(--glow); border-bottom-color: var(--green-mid); }
.lc-pnl-title.amber { color: var(--amber); border-bottom-color: #5a3c00; }
.lc-pnl-title.cyan { color: #00cfff; border-bottom-color: #004466; }

/* 온보딩 퀘스트 패널 */
.lc-quest-main { margin-bottom: 8px; }
.lc-quest-main-title { color: var(--amber); font-size: 11px; font-weight: bold; margin-bottom: 3px; }
.lc-quest-main-desc { color: #8aaa8a; font-size: 10px; line-height: 1.5; }
.lc-quest-main-done { color: var(--green); font-size: 10px; letter-spacing: .1em; text-shadow: var(--glow); margin-top: 3px; }
.lc-quest-subs { display: flex; flex-direction: column; gap: 3px; }
.lc-quest-sub  { display: flex; align-items: center; gap: 6px; font-size: 10px; padding: 3px 0; border-bottom: 1px solid #0a1a0a; }
.lc-quest-sub:last-child { border-bottom: none; }
.lc-quest-sub .qs-icon { font-size: 12px; flex-shrink: 0; }
.lc-quest-sub .qs-text { flex: 1; color: #8aaa8a; }
.lc-quest-sub .qs-text.done { color: var(--green-dim); text-decoration: line-through; }
.lc-quest-sub .qs-chk  { font-size: 11px; flex-shrink: 0; }
.lc-quest-sub .qs-chk.done  { color: var(--green); text-shadow: var(--glow); }
.lc-quest-sub .qs-chk.todo  { color: #334433; }

/* GO/NO-GO 체크리스트 */
.chk-row { display: flex; align-items: center; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid #0d2010; font-size: 11px; }
.chk-row:last-child { border-bottom: none; }
.chk-name  { color: #8aaa8a; flex: 1; }
.chk-badge { font-size: 10px; padding: 1px 6px; border: 1px solid var(--green-mid); color: var(--green); background: rgba(0,230,118,.07); text-shadow: var(--glow); white-space: nowrap; }
.chk-badge.nogo { border-color: var(--red); color: var(--red); background: rgba(255,23,68,.08); text-shadow: none; }
.chk-all-go { background: rgba(0,230,118,.07); border: 1px solid var(--green); padding: 5px 8px; text-align: center; color: var(--green); font-size: 11px; letter-spacing: .1em; text-shadow: var(--glow); margin-top: 6px; animation: pulse-green 2.5s ease-in-out infinite; }
.chk-no-go  { background: rgba(255,23,68,.04); border: 1px solid #3a0a10; padding: 5px 8px; text-align: center; color: #8a3a3a; font-size: 11px; letter-spacing: .1em; margin-top: 6px; }
@keyframes pulse-green { 0%,100% { box-shadow: 0 0 4px #00e67660; } 50% { box-shadow: 0 0 14px #00e676bb, 0 0 28px #00e67640; } }

/* 데이터 행 */
.lc-drow     { display: flex; justify-content: space-between; align-items: center; font-size: 11px; padding: 2px 0; color: #8aaa8a; }
.lc-drow .v  { color: var(--green); text-shadow: var(--glow); }
.lc-drow .va { color: var(--amber); }

/* 중앙: pre-launch vs anim zone */
#lc-pre-launch { flex: 1; overflow-y: auto; display: flex; flex-direction: column; }
#lc-anim-zone  { flex: 1; overflow-y: auto; display: none; padding: 8px 12px; }
#lc-anim-zone.active { display: block; }

/* 로켓 디스플레이 */
.lc-rocket-disp { padding: 12px 0 6px; text-align: center; border-bottom: 1px solid var(--green-dim); flex-shrink: 0; }
pre.lc-rocket-art { display: inline-block; text-align: left; font-size: 11px; line-height: 1.35; color: var(--green); white-space: pre; text-shadow: 0 0 6px #00e676, 0 0 16px rgba(0,230,118,.5); letter-spacing: 0; }

/* 상태 바 */
.lc-sbar-wrap { padding: 8px 12px; border-bottom: 1px solid var(--green-dim); background: var(--panel-bg); flex-shrink: 0; }
.lc-sbar-row  { display: flex; align-items: center; gap: 6px; margin-bottom: 4px; }
.lc-sbar-lbl  { width: 60px; font-size: 10px; color: var(--green-mid); flex-shrink: 0; }
.lc-sbar-track { flex: 1; height: 8px; background: rgba(26,92,52,.35); border: 1px solid var(--green-dim); overflow: hidden; }
.lc-sbar-fill  { height: 100%; background: var(--green); box-shadow: 0 0 4px var(--green); transition: width .4s; }
.lc-sbar-fill.amber { background: var(--amber); box-shadow: 0 0 4px var(--amber); }
.lc-sbar-fill.red   { background: var(--red);   box-shadow: 0 0 4px var(--red); }
.lc-sbar-pct  { width: 34px; text-align: right; font-size: 10px; color: var(--green); flex-shrink: 0; }

/* 실패 확률 분석 */
.lc-fail-wrap { padding: 8px 12px; border-bottom: 1px solid var(--green-dim); flex-shrink: 0; }
.lc-fail-row  { display: flex; align-items: center; gap: 5px; margin-bottom: 4px; font-size: 10px; }
.lc-fail-name { width: 80px; color: #8aaa8a; flex-shrink: 0; }
.lc-fail-bar  { flex: 1; color: var(--red); font-size: 11px; letter-spacing: -1px; overflow: hidden; white-space: nowrap; }
.lc-fail-pct  { width: 30px; text-align: right; color: var(--amber); flex-shrink: 0; }
.lc-fail-lvl  { font-size: 9px; padding: 0 4px; border: 1px solid; flex-shrink: 0; }
.lc-fail-lvl.low  { border-color: var(--green-dim); color: var(--green-mid); }
.lc-fail-lvl.mid  { border-color: #5a3c00; color: var(--amber); }
.lc-fail-lvl.high { border-color: var(--red); color: var(--red); }

/* 발사 커밋 박스 */
#lc-commit-box { margin: 10px 12px 12px; border: 2px solid var(--amber); padding: 12px; background: #000d01; animation: pulse-amber 3s ease-in-out infinite; flex-shrink: 0; }
@keyframes pulse-amber { 0%,100% { box-shadow: 0 0 4px #ffab0060; border-color: var(--amber); } 50% { box-shadow: 0 0 20px #ffab00cc, 0 0 40px #ffab0040; border-color: #ffd050; } }
.lc-commit-hd    { color: var(--amber); font-size: 12px; letter-spacing: .15em; text-shadow: 0 0 8px #ffab0080; text-align: center; margin-bottom: 10px; }
.lc-commit-stats { display: flex; justify-content: space-around; margin-bottom: 12px; }
.lc-cs           { text-align: center; }
.lc-cs-val       { display: block; font-size: 20px; letter-spacing: .05em; margin-bottom: 2px; }
.lc-cs-val.green { color: var(--green); text-shadow: var(--glow-strong); }
.lc-cs-val.amber { color: var(--amber); text-shadow: 0 0 8px #ffab0080; }
.lc-cs-val.red   { color: var(--red);   text-shadow: 0 0 8px #ff174480; }
.lc-cs-label     { font-size: 9px; color: var(--green-dim); letter-spacing: .1em; }
#lc-btn-launch { display: block; width: 100%; padding: 10px 0; background: rgba(255,171,0,.08); border: 2px solid var(--amber); color: var(--amber); font-family: var(--font); font-size: 15px; letter-spacing: .2em; cursor: pointer; text-shadow: 0 0 8px #ffab0080; transition: background .2s; margin-bottom: 7px; }
#lc-btn-launch:hover:not(:disabled) { background: rgba(255,171,0,.2); }
#lc-btn-launch:disabled { opacity: .5; cursor: not-allowed; }
#lc-btn-abort  { display: block; width: 100%; padding: 6px 0; background: rgba(255,23,68,.07); border: 1px solid var(--red); color: var(--red); font-family: var(--font); font-size: 11px; letter-spacing: .15em; cursor: pointer; transition: background .2s; }
#lc-btn-abort:hover { background: rgba(255,23,68,.16); }

/* 이력 테이블 (우측) */
.lc-hist-table    { width: 100%; border-collapse: collapse; font-size: 10px; }
.lc-hist-table th { color: var(--green-dim); padding: 3px 5px; text-align: left; border-bottom: 1px solid var(--green-dim); }
.lc-hist-table td { padding: 4px 5px; border-bottom: 1px solid #0d1a0d; color: #8aaa8a; vertical-align: top; }

/* 통계 행 (우측) */
.lc-stat-row      { display: flex; justify-content: space-between; padding: 2px 0; font-size: 10px; color: #8aaa8a; }
.lc-stat-row .sv  { color: var(--green); }
.lc-stat-row .sva { color: var(--amber); }

/* 기존 animation 클래스 유지 */
.telemetry-wrap { border: var(--border); background: var(--bg); padding: 12px 14px; font-size: 13px; min-height: 120px; }
.telem-line { display: flex; align-items: center; gap: 8px; padding: 4px 0; border-bottom: 1px solid #0a1a0a; color: var(--green-mid); }
.telem-time  { color: var(--green-mid); min-width: 55px; font-size: 12px; }
.telem-event { min-width: 140px; color: var(--green); text-transform: uppercase; font-size: 12px; }
.telem-bar   { flex: 1; height: 6px; border: 1px solid var(--green-dim); }
.telem-bar-fill { height: 100%; background: var(--green-mid); transition: width 0.5s; }
.telem-pct   { color: var(--green); font-size: 12px; min-width: 38px; text-align: right; }
.launch-anim-wrap { text-align: center; padding: 14px; min-height: 150px; position: relative; overflow: hidden; border: var(--border); background: var(--bg); }
.launch-rocket-ascii { font-size: 12px; white-space: pre; color: var(--green); display: inline-block; }
.launch-rocket-ascii.launching { animation: rocket-launch 3s ease-in forwards; }
@keyframes rocket-launch { 0% { transform: translateY(0); } 100% { transform: translateY(-400px); } }
.exhaust-anim { font-size: 12px; white-space: pre; color: var(--amber); text-shadow: 0 0 6px var(--amber); display: inline-block; animation: exhaust-flicker 0.15s step-start infinite; }
@keyframes exhaust-flicker { 0%,100% { opacity: 1; } 50% { opacity: 0.4; } }
.launch-result { display: none; border: 1px solid var(--amber); background: rgba(255,171,0,0.05); padding: 14px; font-size: 13px; color: var(--amber); margin-top: 12px; }
.launch-result.show { display: block; }
.launch-result-title { font-size: 16px; letter-spacing: 3px; text-transform: uppercase; text-shadow: 0 0 12px var(--amber); margin-bottom: 8px; }
.launch-result-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 12px; margin-bottom: 10px; }
.launch-result-stat-lbl { color: var(--green-mid); }
.launch-result-stat-val { color: var(--amber); }

/* ===========================
   MISSION TAB
   =========================== */
.phase-row { display: flex; align-items: center; gap: 12px; padding: 7px 0; border-bottom: 1px solid #0e2a18; font-size: 13px; }
.phase-name { min-width: 180px; color: var(--green-mid); text-transform: uppercase; font-size: 12px; }
.phase-bar-wrap { flex: 1; height: 8px; border: 1px solid var(--green-dim); background: var(--bg); }
.phase-bar-fill { height: 100%; background: var(--green-mid); transition: width 0.5s; }
.phase-bar-fill.done { background: var(--green); }
.phase-status { min-width: 80px; font-size: 12px; text-align: right; color: var(--green-mid); }
.phase-status.done { color: var(--green); }
.phase-status.locked { color: #0e2a18; }
.history-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 8px; }
.history-table th { background: #021508; color: var(--green-mid); text-align: left; padding: 6px 10px; border: var(--border); letter-spacing: 1px; font-weight: normal; text-transform: uppercase; }
.history-table td { padding: 5px 10px; border: 1px solid #0e2a18; color: var(--green); }
.history-table tr:hover td { background: rgba(0,230,118,0.04); }
.prestige-panel { border: 1px solid var(--amber); background: rgba(255,171,0,0.04); padding: 14px; margin-top: 12px; }
.prestige-stat { font-size: 13px; color: var(--amber); margin-bottom: 8px; line-height: 1.7; }
/* ── Moonstone upgrade shop ── */
.ms-shop { border: 1px solid #2a3a00; background: rgba(0,230,118,0.03); padding: 14px; margin: 12px 0; }
.ms-shop-hd { font-size: 11px; letter-spacing: 2px; color: var(--amber); margin-bottom: 12px; display: flex; align-items: center; gap: 12px; }
.ms-balance { color: var(--amber); font-size: 14px; font-weight: bold; }
.ms-shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(148px, 1fr)); gap: 8px; }
.ms-card { border: 1px solid #1a3820; background: #030e05; padding: 10px; display: flex; flex-direction: column; gap: 4px; transition: border-color 0.15s; }
.ms-card.buyable { border-color: var(--amber); }
.ms-card.maxed { border-color: var(--green-mid); opacity: 0.6; }
.ms-card-icon { font-size: 18px; line-height: 1; }
.ms-card-name { font-size: 11px; color: var(--white); letter-spacing: 1px; font-weight: bold; }
.ms-card-desc { font-size: 10px; color: var(--green-mid); line-height: 1.5; flex: 1; }
.ms-card-footer { display: flex; align-items: center; justify-content: space-between; margin-top: 4px; }
.ms-card-owned { font-size: 10px; color: var(--green-dim); }
.ms-card-maxed { font-size: 10px; color: var(--green-mid); letter-spacing: 1px; }
.ms-card-btn { font-family: inherit; font-size: 11px; border: 1px solid var(--amber); background: rgba(255,171,0,0.08); color: var(--amber); padding: 3px 8px; cursor: pointer; letter-spacing: 1px; transition: background 0.15s; }
.ms-card-btn:hover:not(.disabled) { background: rgba(255,171,0,0.2); }
.ms-card-btn.disabled { border-color: #333; color: #555; cursor: not-allowed; }

/* ===========================
   LAUNCH OVERLAY
   =========================== */
#launch-overlay { display: none; position: fixed; inset: 0; background: rgba(1,8,0,0.97); z-index: 7000; align-items: center; justify-content: center; flex-direction: column; text-align: center; padding: 24px; }
#launch-overlay.show { display: flex; }
.lo-title { font-size: 28px; letter-spacing: 8px; text-transform: uppercase; color: var(--amber); text-shadow: 0 0 20px var(--amber); margin-bottom: 14px; }
.lo-rocket { font-size: 12px; white-space: pre; color: var(--amber); text-shadow: 0 0 6px #ffab0080; margin-bottom: 14px; animation: rocket-launch 4s ease-in forwards; }
.lo-stats { font-size: 15px; color: var(--green); margin-bottom: 18px; line-height: 2.2; text-shadow: var(--glow); }
.lo-ms { font-size: 20px; color: var(--amber); letter-spacing: 3px; margin-bottom: 24px; }
.lo-btns { display: flex; gap: 14px; justify-content: center; flex-wrap: wrap; }
</style>
</head>
<body>

<!-- ===========================
     TITLE SCREEN
     =========================== -->
<div id="title-screen">
  <div class="title-logo">MOON IDLE</div>
  <div class="title-subtitle">달 탐사 로켓 제작소 / LUNAR EXPLORATION SIM</div>
  <div id="boot-log"></div>
  <div id="save-strip">// 저장 데이터 확인 중...</div>
  <div class="title-btns">
    <button class="title-btn primary" id="new-game-btn" style="display:none">새 게임</button>
    <button class="title-btn" id="continue-btn" style="display:none">이어하기</button>
  </div>
  <div class="title-settings">
    <button class="title-btn-sm" id="title-snd-btn">SND:ON</button>
  </div>
</div>

<!-- Save Slot Modal -->
<div id="save-slot-modal"></div>

<!-- ===========================
     WORLD BACKGROUND (fixed, z-index 0 — renders behind everything)
     =========================== -->
<div id="world-bg">
  <div id="world-scene">
    <div id="sky-layer"></div>
    <div id="buildings-layer"></div>
    <div id="ground-line"></div>
    <div id="workers-layer"></div>
  </div>
</div>

<!-- ===========================
     APP (flex column, hidden until game starts)
     =========================== -->
<div id="app">

  <!-- ══ TAB UNLOCK FLASH BANNER ══ -->
  <div id="tab-unlock-flash" class="tuf-hidden"></div>

  <!-- ══ TOP BAR ══ -->
  <div id="topbar">
    <span class="logo">&#9654; MOON IDLE</span>
    <span class="sep">—</span>
    <span style="color:var(--green-mid);font-size:13px" data-i18n="title_subtitle">Lunar Rocket Facility</span>
    <span class="sep">|</span>
    <span class="clk" id="tb-clock">00:00:00</span>
    <span class="sep">|</span>
    <span class="mny">&#8361;&thinsp;<span id="tb-money">0</span></span>
    <span class="sep">|</span>
    <span class="sys">인원 <span id="tb-workers" style="color:var(--white)">0/0</span></span>
    <div class="tb-r">
      <button id="bgm-prev-btn" onclick="typeof BGM!=='undefined'&&BGM.next()" title="다음 BGM">BGM&#9664;&#9654;</button>
      <span id="bgm-track-label">[BGM: 앰비언트]</span>
      <button id="sound-btn">SND:ON</button>
      <button id="lang-btn" onclick="toggleLang()" title="Language / 언어">한국어</button>
    </div>
  </div>

  <!-- ══ NAV TABS (topbar 바로 아래) ══ -->
  <div id="nav-tabs">
    <button class="nav-tab active" id="nav-tab-launch" data-tab="launch" data-i18n="tab_launch">Launch Control</button>
    <button class="nav-tab" id="nav-tab-production" data-tab="production" data-i18n="tab_production">Production Hub</button>
    <button class="nav-tab" id="nav-tab-research" data-tab="research" data-i18n="tab_research">Research Lab</button>
    <button class="nav-tab" id="nav-tab-assembly" data-tab="assembly" data-i18n="tab_assembly" style="display:none">Assembly Bay</button>
    <button class="nav-tab" id="nav-tab-mission" data-tab="mission" data-i18n="tab_mission" style="display:none">Missions</button>
  </div>

  <!-- ══ OFFLINE BANNER ══ -->
  <div id="offline-banner"></div>

  <!-- ══ MAIN ROW ══ -->
  <div id="main">

    <!-- ── LEFT PANEL ── -->
    <div id="res-left">
      <div id="rl-inner"></div>
      <div id="rl-ms-box"></div>
    </div>

    <!-- ── CENTER (tab area) ── -->
    <div id="ww">

      <!-- TAB CONTENT AREA -->
      <div id="tab-area">

        <!-- ===== PRODUCTION TAB ===== -->
        <div class="tab-pane" id="pane-production">
          <div class="panel">
            <div class="panel-header">생산 허브</div>
            <div id="prod-status"></div>
            <div id="bld-grid"></div>
          </div>
        </div>

        <!-- ===== RESEARCH TAB ===== -->
        <div class="tab-pane" id="pane-research">
          <div id="research-layout">
            <div id="panel-left-research">
              <div class="r-panel-header">연구 현황</div>
              <div class="r-panel-scroll" id="research-left-content"></div>
            </div>
            <div id="panel-center-research">
              <div class="r-panel-header">기술 트리</div>
              <div id="tree-container">
                <div class="branch-headers" id="branch-headers"></div>
                <svg id="tree-svg" height="480"></svg>
              </div>
            </div>
            <div id="panel-right-research">
              <div class="r-panel-header">기술 상세</div>
              <div class="r-panel-scroll" id="research-right-content">
                <div id="tech-detail-panel"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- ===== ASSEMBLY TAB ===== -->
        <div class="tab-pane" id="pane-assembly">
          <div class="panel">
            <div class="panel-header">로켓 조립동</div>
            <div class="assembly-layout">
              <div>
                <div class="rocket-art-wrap"><pre id="rocket-art-display"></pre></div>
                <div class="panel" style="margin-top:10px">
                  <div class="panel-header">부품 현황</div>
                  <div id="parts-checklist"></div>
                </div>
                <div class="science-box" id="science-box"></div>
              </div>
              <div>
                <div class="panel">
                  <div class="panel-header">품질 등급</div>
                  <div class="quality-selector" id="quality-selector"></div>
                </div>
                <div class="panel" style="margin-top:10px">
                  <div class="panel-header">조립 슬롯</div>
                  <div id="assembly-slots-wrap"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ===== LAUNCH TAB (v7d 3-column) ===== -->
        <div class="tab-pane" id="pane-launch">

          <!-- ── LEFT: 체크리스트 + 온보딩 퀘스트 ── -->
          <div class="lc-col lc-col-left">
            <div class="lc-panel">
              <div class="lc-pnl-title green">PRE-LAUNCH GO / NO-GO</div>
              <div id="lc-checklist"></div>
            </div>
            <div class="lc-panel" id="lc-quest-panel">
              <div class="lc-pnl-title cyan">// MISSION OBJECTIVES</div>
              <div id="lc-quest"></div>
            </div>
          </div>

          <!-- ── CENTER: 로켓 아트 + 상태 바 + 실패 분석 + 커밋 박스 ── -->
          <div class="lc-col lc-col-center">
            <!-- 발사 전 정적 패널 -->
            <div id="lc-pre-launch">
              <div class="lc-rocket-disp">
                <pre class="lc-rocket-art" id="lc-rocket-pre">// STANDBY</pre>
              </div>
              <div class="lc-sbar-wrap" id="lc-sbar-wrap"></div>
              <div class="lc-fail-wrap" id="lc-fail-wrap"></div>
              <div id="lc-commit-box">
                <div class="lc-commit-hd">&#9474; LAUNCH COMMIT &#9474;</div>
                <div class="lc-commit-stats" id="lc-commit-stats"></div>
                <button id="lc-btn-launch" onclick="launchReady()" disabled>[ &#9658;&#9658; 발사 실행 ]</button>
                <button id="lc-btn-abort">[ ABORT ]</button>
              </div>
            </div>
            <!-- 발사 애니메이션 존 (launch.js가 toggle) -->
            <div id="lc-anim-zone">
              <div class="launch-anim-wrap" id="launch-anim-wrap">
                <div style="color:var(--green-mid);font-size:13px;">// 발사 대기 중</div>
              </div>
              <div id="telem-wrap"></div>
              <div class="launch-result" id="launch-result">
                <div class="launch-result-title">발사 성공</div>
                <div class="launch-result-stats" id="lr-stats"></div>
                <div id="lr-ms" style="color:var(--amber);font-size:15px;margin-bottom:10px;"></div>
              </div>
            </div>
          </div>

          <!-- ── RIGHT: 발사 이력 + 통계 ── -->
          <div class="lc-col lc-col-right">
            <div class="lc-panel">
              <div class="lc-pnl-title">발사 이력</div>
              <div id="lc-history"></div>
            </div>
            <div class="lc-panel">
              <div class="lc-pnl-title">통계</div>
              <div id="lc-stats-panel"></div>
            </div>
          </div>

        </div>

        <!-- ===== MISSION TAB ===== -->
        <div class="tab-pane" id="pane-mission">
          <div class="panel"><div class="panel-header">미션 진행 현황</div><div id="phase-progress-wrap"></div></div>
          <div id="ms-shop-wrap"></div>
          <div class="panel"><div class="panel-header">발사 기록</div><div id="history-wrap"></div></div>
          <div id="prestige-wrap"></div>
        </div>

      </div><!-- /#tab-area -->

    </div><!-- /#ww -->

    <!-- ── RIGHT PANEL ── -->
    <div id="rp">
      <div class="rph">&#9726; 인원</div>
      <div id="rp-workers">
        <div style="color:var(--green-mid);font-size:10px;line-height:1.6;padding:2px 0 8px">
          건물에 마우스를 오버하면 인원 배치 메뉴가 열립니다
        </div>
      </div>

      <div style="margin-top:8px;border-top:1px solid var(--green-dim);padding-top:8px">
        <div class="rph">&#9726; 문스톤</div>
        <div id="rp-ms" style="font-size:12px;color:var(--green-dim);margin-top:4px">아직 획득 없음</div>
      </div>

      <div style="margin-top:8px;border-top:1px solid var(--green-dim);padding-top:8px">
        <div class="rph">&#9726; 발사 기록</div>
        <div id="rp-launches" style="font-size:12px;color:var(--green-mid);margin-top:4px">0회</div>
      </div>

      <div style="margin-top:8px;border-top:1px solid var(--green-dim);padding-top:8px">
        <div class="rph">&#9726; 시스템</div>
        <div id="rp-sys" style="font-size:11px;color:var(--green);margin-top:4px">SYS: NOMINAL</div>
      </div>
    </div><!-- /#rp -->

  </div><!-- /#main -->

  <!-- ══ TICKER ══ -->
  <div id="ticker">
    <span id="tki">
      <span class="to">&gt;&gt; MOON IDLE 달 탐사 로켓 제작소 — 시스템 초기화 완료</span>
      <span class="ts">&#9632;</span>
      <span>&gt;&gt; 운영 센터에 인원을 배치하여 자금을 확보하세요</span>
      <span class="ts">&#9632;</span>
      <span class="tw">&gt;&gt; 연구소를 건설하면 연구 탭과 기술 트리가 해금됩니다</span>
      <span class="ts">&#9632;</span>
      <span>&gt;&gt; 태양광 어레이를 설치하면 전체 생산이 10%씩 증가합니다</span>
      <span class="ts">&#9632;</span>
      <span class="to">&gt;&gt; 발사대를 건설하고 로켓을 달로 쏘아올리세요!</span>
      <span class="ts">&#9632;</span>
    </span>
  </div>

</div><!-- /#app -->

<!-- ===========================
     LAUNCH OVERLAY (position:fixed)
     =========================== -->
<div id="launch-overlay">
  <div class="lo-title">// 달 탐사 성공</div>
  <pre class="lo-rocket" id="lo-rocket-art"></pre>
  <div class="lo-stats" id="lo-stats"></div>
  <div class="lo-ms" id="lo-ms"></div>
  <div class="lo-btns">
    <button class="btn btn-amber" id="btn-prestige">문스톤 획득 후 재시작</button>
    <button class="btn" id="btn-continue-game">계속 진행</button>
  </div>
</div>

<!-- NOTIFICATIONS -->
<div id="notif"></div>

<!-- BUILDING HOVER OVERLAY (dynamic innerHTML via openBldOv) -->
<div id="bld-ov"></div>

<!-- RESEARCH HOVER TOOLTIP -->
<div id="tech-tip"></div>

<!-- Hidden compat elements -->
<span id="ms-display" style="display:none"></span>

<script>
// ─── TOPBAR CLOCK ─────────────────────────────────────────────
(function tickClock() {
  const t = new Date();
  const el = document.getElementById('tb-clock');
  if (el) el.textContent =
    String(t.getHours()).padStart(2,'0') + ':' +
    String(t.getMinutes()).padStart(2,'0') + ':' +
    String(t.getSeconds()).padStart(2,'0');
  setTimeout(tickClock, 1000);
})();

// ─── TOPBAR MONEY / WORKERS (reads from global gs every 500ms) ────
setInterval(function() {
  if (typeof gs === 'undefined') return;
  const m = document.getElementById('tb-money');
  if (m) m.textContent = typeof fmt === 'function' ? fmt(gs.res.money || 0) : Math.floor(gs.res.money || 0).toLocaleString('ko-KR');
  const w = document.getElementById('tb-workers');
  if (w) {
    const total = gs.workers || 1;
    const assigned = typeof getTotalAssigned === 'function' ? getTotalAssigned() : 0;
    w.textContent = assigned + '/' + total + '명';
  }
  // Right panel
  const rpMs = document.getElementById('rp-ms');
  if (rpMs) rpMs.textContent = gs.moonstone > 0 ? '&#9670; ' + gs.moonstone + ' 문스톤' : '아직 획득 없음';
  const rpLaunches = document.getElementById('rp-launches');
  if (rpLaunches) rpLaunches.textContent = (gs.launches || 0) + '회';
}, 500);
</script>

<script src="js/game-data.js"></script>
<script src="js/game-state.js"></script>
<script src="js/i18n.js"></script>
<script src="js/unlock.js"></script>
<script src="js/world.js"></script>
<script src="js/tabs/production.js"></script>
<script src="js/tabs/research.js"></script>
<script src="js/tabs/assembly.js"></script>
<script src="js/tabs/launch.js"></script>
<script src="js/tabs/mission.js"></script>
<script src="js/audio-bgm.js"></script>
<script src="js/main.js"></script>
</body>
</html>
