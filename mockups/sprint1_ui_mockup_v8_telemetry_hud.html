<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MoonIdle — Launch Facility Telemetry HUD</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #060606;
    --panel-bg: rgba(255,255,255,0.04);
    --border: rgba(255,255,255,0.12);
    --border-strong: rgba(255,255,255,0.2);
    --text-primary: #e8e8e8;
    --text-secondary: #8a8a8a;
    --text-dim: #555;
    --accent: #00a8e8;
    --accent-glow: rgba(0,168,232,0.25);
    --warning: #ff5500;
    --warning-glow: rgba(255,85,0,0.2);
    --success: #00d97e;
    --success-glow: rgba(0,217,126,0.2);
    --red: #ff2222;
    --red-glow: rgba(255,34,34,0.2);
    --font: 'Inter', sans-serif;
  }

  html, body {
    width: 100%;
    height: 100%;
    background: var(--bg);
    color: var(--text-primary);
    font-family: var(--font);
    font-size: 12px;
    line-height: 1.4;
    overflow: hidden;
    user-select: none;
  }

  /* ── LAYOUT SHELL ─────────────────────────────── */
  #app {
    display: flex;
    flex-direction: column;
    width: 100vw;
    height: 100vh;
  }

  /* ── TOP BAR ──────────────────────────────────── */
  #topbar {
    height: 40px;
    min-height: 40px;
    display: flex;
    align-items: stretch;
    border-bottom: 1px solid var(--border);
    background: rgba(0,0,0,0.6);
    flex-shrink: 0;
    z-index: 10;
  }

  .tb-cell {
    display: flex;
    align-items: center;
    padding: 0 18px;
    border-right: 1px solid var(--border);
    white-space: nowrap;
  }
  .tb-cell:last-child { border-right: none; margin-left: auto; }
  .tb-cell.center { flex: 1; justify-content: center; border-right: 1px solid var(--border); }

  .tb-label {
    font-size: 10px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-right: 8px;
  }
  .tb-value {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.08em;
    color: var(--text-primary);
  }
  .tb-accent { color: var(--accent); }
  .tb-timer {
    font-size: 13px;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.1em;
    color: var(--success);
  }
  .status-dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--success);
    margin-right: 8px;
    box-shadow: 0 0 6px var(--success);
    animation: pulse 2s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* ── MAIN BODY ────────────────────────────────── */
  #main {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  /* ── SIDEBAR SHARED ───────────────────────────── */
  .sidebar {
    display: flex;
    flex-direction: column;
    border-right: 1px solid var(--border);
    overflow-y: auto;
    overflow-x: hidden;
    flex-shrink: 0;
  }
  .sidebar::-webkit-scrollbar { width: 3px; }
  .sidebar::-webkit-scrollbar-track { background: transparent; }
  .sidebar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }

  #left-sidebar { width: 220px; }
  #right-sidebar { width: 280px; border-right: none; border-left: 1px solid var(--border); }

  /* ── SECTION HEADER ───────────────────────────── */
  .sec-header {
    padding: 8px 14px 6px;
    font-size: 9px;
    font-weight: 700;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    color: var(--accent);
    border-bottom: 1px solid var(--border);
    background: rgba(0,168,232,0.04);
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
  }
  .sec-header::before {
    content: '';
    display: inline-block;
    width: 2px; height: 10px;
    background: var(--accent);
    flex-shrink: 0;
  }

  /* ── PIPELINE ─────────────────────────────────── */
  #pipeline-list {
    padding: 10px 0;
    position: relative;
  }

  .pipeline-stage {
    display: flex;
    align-items: flex-start;
    padding: 7px 14px;
    gap: 10px;
    position: relative;
  }

  .stage-connector {
    position: absolute;
    left: 20px;
    top: -8px;
    bottom: -8px;
    width: 1px;
    background: var(--border);
    z-index: 0;
  }
  .pipeline-stage:first-child .stage-connector { top: 50%; }
  .pipeline-stage:last-child .stage-connector { bottom: 50%; }

  .stage-dot {
    width: 14px; height: 14px;
    border-radius: 50%;
    border: 1.5px solid var(--border-strong);
    background: var(--bg);
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    position: relative;
    z-index: 1;
    margin-top: 2px;
  }
  .stage-dot.complete {
    border-color: var(--success);
    background: rgba(0,217,126,0.12);
    box-shadow: 0 0 8px var(--success-glow);
  }
  .stage-dot.complete::after {
    content: '';
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--success);
  }
  .stage-dot.active {
    border-color: var(--accent);
    background: rgba(0,168,232,0.1);
    box-shadow: 0 0 8px var(--accent-glow);
    animation: pulse-border 2s ease-in-out infinite;
  }
  .stage-dot.active::after {
    content: '';
    width: 4px; height: 4px;
    border-radius: 50%;
    background: var(--accent);
  }
  @keyframes pulse-border {
    0%, 100% { box-shadow: 0 0 8px var(--accent-glow); }
    50% { box-shadow: 0 0 16px rgba(0,168,232,0.5); }
  }

  .stage-info { flex: 1; min-width: 0; }
  .stage-num {
    font-size: 9px;
    color: var(--text-dim);
    letter-spacing: 0.1em;
    font-weight: 600;
  }
  .stage-name {
    font-size: 11px;
    color: var(--text-primary);
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .stage-name.dim { color: var(--text-dim); }

  .stage-progress-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 4px;
  }
  .progress-bar {
    flex: 1;
    height: 3px;
    background: rgba(255,255,255,0.06);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 0.3s ease;
  }
  .fill-complete { background: var(--success); }
  .fill-active { background: var(--accent); }
  .fill-locked { background: transparent; }

  .stage-pct {
    font-size: 9px;
    font-weight: 700;
    letter-spacing: 0.05em;
    font-variant-numeric: tabular-nums;
    min-width: 32px;
    text-align: right;
  }
  .pct-complete { color: var(--success); }
  .pct-active { color: var(--accent); }
  .pct-locked { color: var(--text-dim); }

  .stage-badge {
    font-size: 8px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    font-weight: 700;
    padding: 1px 5px;
    border-radius: 2px;
    margin-top: 3px;
    display: inline-block;
  }
  .badge-complete { color: var(--success); border: 1px solid rgba(0,217,126,0.3); background: rgba(0,217,126,0.06); }
  .badge-active { color: var(--accent); border: 1px solid rgba(0,168,232,0.3); background: rgba(0,168,232,0.06); }
  .badge-locked { color: var(--text-dim); border: 1px solid rgba(255,255,255,0.06); }

  /* ── PRODUCTION RATES ─────────────────────────── */
  #prod-rates {
    padding: 10px 14px;
    border-top: 1px solid var(--border);
  }
  .rate-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 4px 0;
    border-bottom: 1px solid rgba(255,255,255,0.04);
  }
  .rate-row:last-child { border-bottom: none; }
  .rate-material { font-size: 10px; color: var(--text-secondary); }
  .rate-value { font-size: 10px; font-weight: 600; color: var(--success); font-variant-numeric: tabular-nums; }

  /* ── CENTER ───────────────────────────────────── */
  #center {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  #schematic-panel {
    flex: 1;
    border-bottom: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  #schematic-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    position: relative;
    overflow: hidden;
  }

  /* ── ROCKET SVG SCHEMATIC ─────────────────────── */
  #rocket-schematic {
    display: flex;
    align-items: center;
    gap: 30px;
  }

  .schematic-labels-left {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0;
  }
  .schematic-labels-right {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 0;
  }

  .callout {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 3px 0;
    position: relative;
  }
  .callout-left {
    flex-direction: row-reverse;
  }
  .callout-text {
    font-size: 9px;
    letter-spacing: 0.08em;
    line-height: 1.2;
    text-align: right;
  }
  .callout-left .callout-text { text-align: right; }
  .callout-right .callout-text { text-align: left; }
  .callout-label {
    font-size: 8px;
    font-weight: 700;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    display: block;
  }
  .callout-sub {
    font-size: 8px;
    color: var(--text-dim);
    display: block;
  }
  .callout-line {
    width: 28px;
    height: 1px;
    background: var(--border-strong);
    flex-shrink: 0;
  }
  .callout-dot {
    width: 4px; height: 4px;
    border-radius: 50%;
    background: var(--accent);
    flex-shrink: 0;
  }

  /* ── TELEMETRY PANEL ──────────────────────────── */
  #telemetry-panel {
    height: 200px;
    min-height: 200px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    flex-shrink: 0;
  }

  #telem-header {
    padding: 6px 14px;
    font-size: 9px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(0,0,0,0.3);
  }
  .telem-id { color: var(--accent); font-weight: 700; }
  .telem-date { color: var(--text-secondary); }
  .telem-result {
    font-size: 9px;
    font-weight: 700;
    color: var(--warning);
    letter-spacing: 0.1em;
    padding: 2px 8px;
    border: 1px solid rgba(255,85,0,0.4);
    background: rgba(255,85,0,0.08);
  }

  #flight-graph {
    flex: 1;
    padding: 12px 18px 8px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .graph-bars {
    display: flex;
    align-items: flex-end;
    gap: 3px;
    height: 80px;
    border-bottom: 1px solid var(--border);
    border-left: 1px solid var(--border);
    padding: 0 0 0 4px;
  }

  .graph-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    flex: 1;
  }
  .graph-bar {
    width: 100%;
    max-width: 28px;
    border-radius: 1px 1px 0 0;
    transition: height 0.3s ease;
  }
  .bar-nominal { background: var(--accent); opacity: 0.7; }
  .bar-max { background: var(--success); }
  .bar-descend { background: var(--warning); opacity: 0.8; }
  .bar-abort { background: var(--red); opacity: 0.7; }
  .graph-t {
    font-size: 8px;
    color: var(--text-dim);
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.04em;
  }

  .graph-annotations {
    display: flex;
    gap: 18px;
    flex-wrap: wrap;
  }
  .annotation {
    font-size: 9px;
    color: var(--text-dim);
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .ann-dot {
    width: 6px; height: 6px;
    border-radius: 1px;
    flex-shrink: 0;
  }

  .graph-note {
    font-size: 9px;
    color: var(--warning);
    padding: 4px 8px;
    background: rgba(255,85,0,0.06);
    border-left: 2px solid var(--warning);
  }

  /* ── RIGHT SIDEBAR ────────────────────────────── */
  #right-sidebar .sec-header { flex-shrink: 0; }

  /* ── DATA TABLE ───────────────────────────────── */
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 10px;
  }
  .data-table th {
    font-size: 8px;
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--text-dim);
    text-align: left;
    padding: 5px 8px;
    border-bottom: 1px solid var(--border);
    background: rgba(255,255,255,0.02);
  }
  .data-table td {
    padding: 5px 8px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    font-variant-numeric: tabular-nums;
    vertical-align: middle;
  }
  .data-table tr:last-child td { border-bottom: none; }
  .data-table tr:hover td { background: rgba(255,255,255,0.02); }

  .mat-name { color: var(--text-primary); font-weight: 500; }
  .mat-stock { color: var(--text-secondary); text-align: right; }
  .mat-needed { color: var(--text-dim); text-align: right; }
  .mat-status { text-align: right; }

  .status-ok { color: var(--success); font-size: 9px; font-weight: 700; }
  .status-warn { color: var(--warning); font-size: 9px; font-weight: 700; }
  .status-crit { color: var(--red); font-size: 9px; font-weight: 700; }

  /* ── MISSION HISTORY TABLE ────────────────────── */
  .mission-icon-x { color: var(--red); font-weight: 700; }
  .mission-icon-warn { color: var(--warning); font-weight: 700; }
  .mission-icon-dots { color: var(--accent); font-weight: 700; }
  .mission-result-fail { color: var(--red); }
  .mission-result-partial { color: var(--warning); }
  .mission-result-prep { color: var(--accent); }

  /* ── STATS ────────────────────────────────────── */
  #stats-panel {
    padding: 10px 12px;
    border-top: 1px solid var(--border);
  }
  .stat-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
  }
  .stat-cell {
    background: var(--bg);
    padding: 7px 9px;
  }
  .stat-cell.full { grid-column: 1 / -1; }
  .stat-label {
    font-size: 8px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 2px;
  }
  .stat-value {
    font-size: 11px;
    font-weight: 600;
    font-variant-numeric: tabular-nums;
    color: var(--text-primary);
  }
  .stat-value.accent { color: var(--accent); }
  .stat-value.warn { color: var(--warning); }
  .stat-sub {
    font-size: 9px;
    color: var(--text-dim);
    margin-top: 1px;
  }

  /* ── BOTTOM BAR ───────────────────────────────── */
  #bottombar {
    height: 52px;
    min-height: 52px;
    display: flex;
    align-items: center;
    border-top: 1px solid var(--border);
    background: rgba(0,0,0,0.5);
    flex-shrink: 0;
    gap: 0;
    z-index: 10;
  }

  .bb-section {
    display: flex;
    align-items: center;
    height: 100%;
    padding: 0 18px;
    border-right: 1px solid var(--border);
    gap: 12px;
  }
  .bb-section:last-child { border-right: none; }
  .bb-section.grow { flex: 1; }

  .btn-abort {
    font-family: var(--font);
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--red);
    background: rgba(255,34,34,0.08);
    border: 1px solid rgba(255,34,34,0.4);
    padding: 7px 18px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .btn-abort:hover {
    background: rgba(255,34,34,0.15);
    box-shadow: 0 0 12px var(--red-glow);
  }

  .btn-launch {
    font-family: var(--font);
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: #fff;
    background: rgba(0,168,232,0.18);
    border: 1px solid var(--accent);
    padding: 7px 22px;
    cursor: pointer;
    transition: all 0.15s ease;
    box-shadow: 0 0 8px var(--accent-glow);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .btn-launch:hover {
    background: rgba(0,168,232,0.3);
    box-shadow: 0 0 18px rgba(0,168,232,0.4);
  }
  .btn-launch .arrow { color: var(--accent); }

  .bb-warning {
    font-size: 9px;
    color: var(--warning);
    letter-spacing: 0.08em;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .warn-icon { font-size: 10px; }

  .bb-sys-checks {
    display: flex;
    gap: 14px;
  }
  .sys-check {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
  }
  .sys-check-label {
    font-size: 7px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text-dim);
  }
  .sys-check-val {
    font-size: 9px;
    font-weight: 700;
  }
  .sys-go { color: var(--success); }
  .sys-no { color: var(--red); }
  .sys-nd { color: var(--warning); }

  .bb-prog {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
  }
  .bb-prog-label {
    font-size: 8px;
    color: var(--text-dim);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }
  .bb-prog-bar {
    height: 4px;
    background: rgba(255,255,255,0.06);
    border-radius: 2px;
    overflow: hidden;
  }
  .bb-prog-fill {
    height: 100%;
    width: 57%;
    background: var(--accent);
    border-radius: 2px;
  }

  /* ── LAUNCH OVERLAY ───────────────────────────── */
  #launch-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    pointer-events: none;
    transition: background 0.3s ease;
  }
  #launch-overlay.active {
    background: rgba(0,0,0,0.92);
    pointer-events: all;
  }

  #countdown-box {
    text-align: center;
    opacity: 0;
    transform: scale(0.95);
    transition: all 0.3s ease;
  }
  #launch-overlay.active #countdown-box {
    opacity: 1;
    transform: scale(1);
  }

  .cd-label {
    font-size: 11px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 12px;
  }
  #cd-number {
    font-size: 88px;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
    color: #fff;
    line-height: 1;
    letter-spacing: -0.02em;
  }
  #cd-number.flash {
    animation: flash-red 0.5s ease;
  }
  @keyframes flash-red {
    0%, 100% { color: #fff; }
    50% { color: var(--red); text-shadow: 0 0 40px var(--red); }
  }

  /* ── SPLIT ANIMATION ──────────────────────────── */
  #split-left, #split-right {
    position: fixed;
    top: 0; bottom: 0;
    width: 50vw;
    background: var(--bg);
    z-index: 900;
    transition: transform 1.5s cubic-bezier(0.77,0,0.18,1);
    pointer-events: none;
    opacity: 0;
  }
  #split-left { left: 0; transform: translateX(-100vw); }
  #split-right { right: 0; transform: translateX(100vw); }

  #split-left.slide, #split-right.slide {
    opacity: 1;
    transform: translateX(0);
  }
  #split-left.open { transform: translateX(-100vw); }
  #split-right.open { transform: translateX(100vw); }

  /* ── LAUNCH CENTER DISPLAY ────────────────────── */
  #launch-display {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 950;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.5s ease;
  }
  #launch-display.visible {
    opacity: 1;
    pointer-events: all;
  }

  #rocket-anim-wrap {
    position: relative;
    width: 100px;
    height: 200px;
    margin-bottom: 24px;
  }

  #rocket-anim {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    animation: none;
  }
  #rocket-anim.flying {
    animation: rocket-fly 4s ease-in forwards;
  }
  @keyframes rocket-fly {
    0%   { bottom: 0; opacity: 1; }
    80%  { bottom: 180px; opacity: 1; }
    100% { bottom: 220px; opacity: 0; }
  }

  #exhaust {
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 12px;
    opacity: 0;
  }
  #rocket-anim.flying #exhaust {
    opacity: 1;
    animation: exhaust-anim 0.1s linear infinite;
  }
  @keyframes exhaust-anim {
    0% { transform: translateX(-50%) scaleY(1); }
    50% { transform: translateX(-50%) scaleY(1.3); }
    100% { transform: translateX(-50%) scaleY(1); }
  }

  #telem-scroll {
    font-size: 11px;
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.08em;
    color: var(--text-secondary);
    text-align: center;
    min-height: 20px;
    margin-bottom: 24px;
    max-width: 500px;
  }
  #telem-scroll .telem-line { display: none; }
  #telem-scroll .telem-line.show { display: block; }
  .telem-nominal { color: var(--text-secondary); }
  .telem-warn { color: var(--warning); font-weight: 700; }
  .telem-lost { color: var(--red); font-weight: 700; }

  #mission-result {
    text-align: center;
    max-width: 600px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.5s ease;
  }
  #mission-result.show {
    opacity: 1;
    transform: translateY(0);
  }
  .result-headline {
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--red);
    margin-bottom: 10px;
  }
  .result-detail {
    font-size: 11px;
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 8px;
  }
  .result-cause {
    font-size: 10px;
    color: var(--warning);
    padding: 6px 14px;
    border: 1px solid rgba(255,85,0,0.3);
    background: rgba(255,85,0,0.06);
    display: inline-block;
    margin-bottom: 20px;
    letter-spacing: 0.05em;
  }

  .btn-close {
    font-family: var(--font);
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--text-secondary);
    background: transparent;
    border: 1px solid var(--border-strong);
    padding: 8px 24px;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .btn-close:hover {
    color: var(--text-primary);
    border-color: var(--text-secondary);
    background: rgba(255,255,255,0.04);
  }

  /* ── PANEL WRAPPER ────────────────────────────── */
  .panel-block {
    border-top: 1px solid var(--border);
    overflow: hidden;
  }
  .panel-block:first-child { border-top: none; }

  .table-wrap {
    overflow-x: auto;
    overflow-y: hidden;
  }
  .table-wrap::-webkit-scrollbar { height: 2px; }
  .table-wrap::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); }

  /* utility */
  .text-right { text-align: right !important; }
  .text-center { text-align: center !important; }
  .nowrap { white-space: nowrap; }
  .mono { font-variant-numeric: tabular-nums; }

  /* ── RESPONSIVE EDGE CASE ─────────────────────── */
  @media (max-width: 1100px) {
    #left-sidebar { width: 190px; }
    #right-sidebar { width: 240px; }
  }
</style>
</head>
<body>

<div id="app">

  <!-- ── TOP BAR ──────────────────────────────────── -->
  <div id="topbar">
    <div class="tb-cell">
      <div class="status-dot"></div>
      <span class="tb-value tb-accent" style="letter-spacing:0.15em;font-size:10px;">MOON IDLE LAUNCH FACILITY</span>
    </div>
    <div class="tb-cell center">
      <span class="tb-label">VEHICLE</span>
      <span class="tb-value">BETA mk.2</span>
      <span style="margin: 0 14px; color: var(--border-strong);">|</span>
      <span class="tb-label">STAGE</span>
      <span class="tb-value" style="color:var(--warning);">03 / 07 — 조립 57%</span>
    </div>
    <div class="tb-cell">
      <span class="tb-label">T+</span>
      <span class="tb-timer" id="timer">00:00:00</span>
    </div>
    <div class="tb-cell">
      <span class="tb-label">MISSION</span>
      <span class="tb-value">ML-004</span>
    </div>
  </div>

  <!-- ── MAIN ─────────────────────────────────────── -->
  <div id="main">

    <!-- LEFT SIDEBAR: MANUFACTURING PIPELINE -->
    <div class="sidebar" id="left-sidebar">

      <div class="sec-header">Manufacturing Pipeline</div>

      <div id="pipeline-list">

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot complete"></div>
          <div class="stage-info">
            <div class="stage-num">01</div>
            <div class="stage-name">원자재 정제</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-complete" style="width:100%"></div></div>
              <span class="stage-pct pct-complete">100%</span>
            </div>
            <span class="stage-badge badge-complete">Complete</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot complete"></div>
          <div class="stage-info">
            <div class="stage-num">02</div>
            <div class="stage-name">구조물 제작</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-complete" style="width:100%"></div></div>
              <span class="stage-pct pct-complete">100%</span>
            </div>
            <span class="stage-badge badge-complete">Complete</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot active"></div>
          <div class="stage-info">
            <div class="stage-num">03</div>
            <div class="stage-name">추진 계통 조립</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-active" style="width:57%"></div></div>
              <span class="stage-pct pct-active">57%</span>
            </div>
            <span class="stage-badge badge-active">In Progress</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot"></div>
          <div class="stage-info">
            <div class="stage-num">04</div>
            <div class="stage-name dim">항전 탑재</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-locked" style="width:0%"></div></div>
              <span class="stage-pct pct-locked">0%</span>
            </div>
            <span class="stage-badge badge-locked">Locked</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot"></div>
          <div class="stage-info">
            <div class="stage-num">05</div>
            <div class="stage-name dim">정적 연소 시험</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-locked" style="width:0%"></div></div>
              <span class="stage-pct pct-locked">0%</span>
            </div>
            <span class="stage-badge badge-locked">Locked</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot"></div>
          <div class="stage-info">
            <div class="stage-num">06</div>
            <div class="stage-name dim">단 통합</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-locked" style="width:0%"></div></div>
              <span class="stage-pct pct-locked">0%</span>
            </div>
            <span class="stage-badge badge-locked">Locked</span>
          </div>
        </div>

        <div class="pipeline-stage">
          <div class="stage-connector"></div>
          <div class="stage-dot"></div>
          <div class="stage-info">
            <div class="stage-num">07</div>
            <div class="stage-name dim">발사 준비</div>
            <div class="stage-progress-row">
              <div class="progress-bar"><div class="progress-fill fill-locked" style="width:0%"></div></div>
              <span class="stage-pct pct-locked">0%</span>
            </div>
            <span class="stage-badge badge-locked">Locked</span>
          </div>
        </div>

      </div><!-- /pipeline-list -->

      <div class="sec-header" style="margin-top: auto; border-top: 1px solid var(--border);">Production Rates</div>
      <div id="prod-rates">
        <div class="rate-row">
          <span class="rate-material">Al-7075</span>
          <span class="rate-value">+42 kg/min</span>
        </div>
        <div class="rate-row">
          <span class="rate-material">CFRP</span>
          <span class="rate-value">+8.3 kg/min</span>
        </div>
        <div class="rate-row">
          <span class="rate-material">LOX</span>
          <span class="rate-value" style="color:var(--accent);">+127 L/min</span>
        </div>
        <div class="rate-row">
          <span class="rate-material">RP-1</span>
          <span class="rate-value" style="color:var(--accent);">+93 L/min</span>
        </div>
      </div>

    </div><!-- /left-sidebar -->

    <!-- CENTER -->
    <div id="center">

      <!-- SCHEMATIC PANEL -->
      <div id="schematic-panel">
        <div class="sec-header">Vehicle Schematic — Beta mk.2 (조립 57%)</div>
        <div id="schematic-area">
          <div id="rocket-schematic">

            <!-- LEFT CALLOUTS -->
            <div class="schematic-labels-left">
              <div class="callout callout-left" style="margin-bottom:6px;">
                <div class="callout-text">
                  <span class="callout-label">Nosecone</span>
                  <span class="callout-sub">Al-7075 페어링 쉘</span>
                </div>
                <div class="callout-line"></div>
                <div class="callout-dot"></div>
              </div>
              <div class="callout callout-left" style="margin-bottom:22px;">
                <div class="callout-text">
                  <span class="callout-label">Payload Bay</span>
                  <span class="callout-sub">320kg LEO 적재하중</span>
                </div>
                <div class="callout-line"></div>
                <div class="callout-dot"></div>
              </div>
              <div class="callout callout-left" style="margin-bottom:16px;">
                <div class="callout-text">
                  <span class="callout-label">LOX Tank</span>
                  <span class="callout-sub">액체산소 −183°C, 4.8t</span>
                </div>
                <div class="callout-line"></div>
                <div class="callout-dot"></div>
              </div>
              <div class="callout callout-left" style="margin-bottom:16px;">
                <div class="callout-text">
                  <span class="callout-label">Intertank</span>
                  <span class="callout-sub">CFRP 구조체</span>
                </div>
                <div class="callout-line"></div>
                <div class="callout-dot"></div>
              </div>
              <div class="callout callout-left" style="margin-bottom:16px;">
                <div class="callout-text">
                  <span class="callout-label">RP-1 Tank</span>
                  <span class="callout-sub">케로신, 3.2t</span>
                </div>
                <div class="callout-line"></div>
                <div class="callout-dot"></div>
              </div>
            </div>

            <!-- ROCKET SVG -->
            <svg width="80" height="280" viewBox="0 0 80 280" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;">
              <!-- Nosecone -->
              <path d="M40 8 L55 52 L25 52 Z" stroke="#00a8e8" stroke-width="1" fill="rgba(0,168,232,0.06)"/>
              <!-- Nosecone base line -->
              <line x1="25" y1="52" x2="55" y2="52" stroke="rgba(255,255,255,0.2)" stroke-width="0.75"/>
              <!-- Payload Bay -->
              <rect x="27" y="52" width="26" height="30" stroke="rgba(255,255,255,0.18)" stroke-width="1" fill="rgba(255,255,255,0.02)"/>
              <!-- Payload hatching -->
              <line x1="27" y1="60" x2="53" y2="60" stroke="rgba(255,255,255,0.06)" stroke-width="0.5"/>
              <line x1="27" y1="68" x2="53" y2="68" stroke="rgba(255,255,255,0.06)" stroke-width="0.5"/>
              <line x1="27" y1="76" x2="53" y2="76" stroke="rgba(255,255,255,0.06)" stroke-width="0.5"/>
              <!-- Interstage ring -->
              <rect x="24" y="82" width="32" height="6" rx="1" stroke="rgba(255,255,255,0.25)" stroke-width="1" fill="rgba(0,168,232,0.04)"/>
              <!-- LOX Tank -->
              <rect x="26" y="88" width="28" height="58" rx="2" stroke="#00a8e8" stroke-width="1" fill="rgba(0,168,232,0.05)"/>
              <!-- LOX level indicator -->
              <rect x="27" y="89" width="26" height="4" fill="rgba(0,168,232,0.25)"/>
              <!-- LOX label -->
              <text x="40" y="122" font-family="Inter,sans-serif" font-size="7" fill="rgba(0,168,232,0.6)" text-anchor="middle" letter-spacing="0.08em">LOX</text>
              <!-- Intertank -->
              <rect x="28" y="146" width="24" height="12" rx="1" stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="rgba(255,255,255,0.03)"/>
              <line x1="28" y1="152" x2="52" y2="152" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/>
              <!-- RP-1 Tank -->
              <rect x="26" y="158" width="28" height="52" rx="2" stroke="rgba(255,165,0,0.5)" stroke-width="1" fill="rgba(255,165,0,0.04)"/>
              <text x="40" y="187" font-family="Inter,sans-serif" font-size="7" fill="rgba(255,165,0,0.5)" text-anchor="middle" letter-spacing="0.08em">RP-1</text>
              <!-- Engine section -->
              <path d="M26 210 L20 240 L60 240 L54 210 Z" stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="rgba(255,255,255,0.02)"/>
              <!-- Engine nozzles -->
              <path d="M23 240 L18 268 L29 268 L27 240 Z" stroke="rgba(255,255,255,0.15)" stroke-width="0.75" fill="rgba(255,85,0,0.06)"/>
              <path d="M32 240 L30 265 L38 265 L37 240 Z" stroke="rgba(255,255,255,0.15)" stroke-width="0.75" fill="rgba(255,85,0,0.06)"/>
              <path d="M43 240 L42 265 L50 265 L48 240 Z" stroke="rgba(255,255,255,0.15)" stroke-width="0.75" fill="rgba(255,85,0,0.06)"/>
              <path d="M51 240 L51 268 L62 268 L57 240 Z" stroke="rgba(255,255,255,0.15)" stroke-width="0.75" fill="rgba(255,85,0,0.06)"/>
              <!-- Grid fins -->
              <rect x="14" y="170" width="11" height="8" stroke="rgba(255,255,255,0.2)" stroke-width="0.75" fill="none"/>
              <line x1="17" y1="170" x2="17" y2="178" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
              <line x1="20" y1="170" x2="20" y2="178" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
              <rect x="55" y="170" width="11" height="8" stroke="rgba(255,255,255,0.2)" stroke-width="0.75" fill="none"/>
              <line x1="58" y1="170" x2="58" y2="178" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
              <line x1="61" y1="170" x2="61" y2="178" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/>
              <!-- Center axis line (dashed) -->
              <line x1="40" y1="4" x2="40" y2="280" stroke="rgba(255,255,255,0.05)" stroke-width="0.5" stroke-dasharray="4,4"/>
              <!-- Assembly progress overlay (dim out incomplete section) -->
              <rect x="20" y="158" width="40" height="120" fill="rgba(6,6,6,0.5)" stroke="none"/>
              <text x="40" y="222" font-family="Inter,sans-serif" font-size="6.5" fill="rgba(255,85,0,0.45)" text-anchor="middle" letter-spacing="0.06em">조립 중</text>
            </svg>

            <!-- RIGHT CALLOUTS -->
            <div class="schematic-labels-right">
              <div style="height:32px;"></div><!-- spacer -->
              <div class="callout callout-right" style="margin-bottom:46px;">
                <div class="callout-dot"></div>
                <div class="callout-line"></div>
                <div class="callout-text">
                  <span class="callout-label">Engine Section</span>
                  <span class="callout-sub">인코넬 718 연소실</span>
                </div>
              </div>
              <div class="callout callout-right" style="margin-bottom:0px;margin-top:44px;">
                <div class="callout-dot"></div>
                <div class="callout-line"></div>
                <div class="callout-text">
                  <span class="callout-label">4× TVC Nozzles</span>
                  <span class="callout-sub">Ti-6Al-4V 소재</span>
                </div>
              </div>
            </div>

          </div><!-- /rocket-schematic -->
        </div><!-- /schematic-area -->
      </div><!-- /schematic-panel -->

      <!-- TELEMETRY PANEL -->
      <div id="telemetry-panel">
        <div id="telem-header">
          <span><span class="telem-id">ML-003</span> &nbsp;/&nbsp; <span class="telem-date">2024.12.15</span> &nbsp;/&nbsp; BETA mk.1</span>
          <span>최대고도 <strong style="color:var(--warning)">89.4 km</strong> &nbsp;|&nbsp; Δv 2,970 m/s &nbsp;|&nbsp; 비행시간 135s</span>
          <span class="telem-result">△ 준성공 — 제어 상실</span>
        </div>
        <div id="flight-graph">
          <div class="graph-bars" id="graph-bars">
            <!-- Bars: T+0 0m, T+30 15km, T+60 45km, T+90 78km, T+105 89.4km, T+120 72km, T+135 abort -->
            <div class="graph-col">
              <div class="graph-bar bar-nominal" style="height:0px;min-height:2px;"></div>
              <span class="graph-t">T+0</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-nominal" style="height:13px;"></div>
              <span class="graph-t">T+30</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-nominal" style="height:40px;"></div>
              <span class="graph-t">T+60</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-nominal" style="height:69px;"></div>
              <span class="graph-t">T+90</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-max" style="height:79px;"></div>
              <span class="graph-t">T+105</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-descend" style="height:64px;"></div>
              <span class="graph-t">T+120</span>
            </div>
            <div class="graph-col">
              <div class="graph-bar bar-abort" style="height:24px;"></div>
              <span class="graph-t">T+135</span>
            </div>
          </div>
          <div class="graph-annotations">
            <div class="annotation"><div class="ann-dot" style="background:var(--accent);opacity:0.7;"></div>정상 비행</div>
            <div class="annotation"><div class="ann-dot" style="background:var(--success);"></div>최대 고도 89.4km</div>
            <div class="annotation"><div class="ann-dot" style="background:var(--warning);"></div>하강 시작</div>
            <div class="annotation"><div class="ann-dot" style="background:var(--red);opacity:0.7;"></div>임무 중단</div>
            <div style="flex:1;"></div>
            <div class="graph-note">T+105s 자이로센서 오작동 감지 → 제어 손실 → 자폭 명령</div>
          </div>
        </div>
      </div><!-- /telemetry-panel -->

    </div><!-- /center -->

    <!-- RIGHT SIDEBAR -->
    <div class="sidebar" id="right-sidebar">

      <!-- MATERIAL INVENTORY -->
      <div class="panel-block">
        <div class="sec-header">Material Inventory</div>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>소재</th>
                <th class="text-right">재고</th>
                <th class="text-right">필요</th>
                <th class="text-right">상태</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="mat-name">Al-7075</td>
                <td class="mat-stock">2,340 kg</td>
                <td class="mat-needed">4,800 kg</td>
                <td class="mat-status"><span class="status-warn">⚠ 부족</span></td>
              </tr>
              <tr>
                <td class="mat-name">CFRP</td>
                <td class="mat-stock">187 kg</td>
                <td class="mat-needed">640 kg</td>
                <td class="mat-status"><span class="status-warn">⚠ 부족</span></td>
              </tr>
              <tr>
                <td class="mat-name">Ti-6Al-4V</td>
                <td class="mat-stock">89 kg</td>
                <td class="mat-needed">210 kg</td>
                <td class="mat-status"><span class="status-warn">⚠ 부족</span></td>
              </tr>
              <tr>
                <td class="mat-name">인코넬 718</td>
                <td class="mat-stock">34 kg</td>
                <td class="mat-needed">88 kg</td>
                <td class="mat-status"><span class="status-warn">⚠ 부족</span></td>
              </tr>
              <tr>
                <td class="mat-name">LOX</td>
                <td class="mat-stock">3,200 L</td>
                <td class="mat-needed">4,800 L</td>
                <td class="mat-status"><span class="status-warn">⚠ 부족</span></td>
              </tr>
              <tr>
                <td class="mat-name">RP-1</td>
                <td class="mat-stock">2,860 L</td>
                <td class="mat-needed">3,200 L</td>
                <td class="mat-status"><span class="status-ok">✓ 충분</span></td>
              </tr>
              <tr>
                <td class="mat-name">GH2</td>
                <td class="mat-stock">450 L</td>
                <td class="mat-needed">180 L</td>
                <td class="mat-status"><span class="status-ok">✓ 충분</span></td>
              </tr>
              <tr>
                <td class="mat-name">에폭시 수지</td>
                <td class="mat-stock" style="color:var(--red);">12 kg</td>
                <td class="mat-needed">45 kg</td>
                <td class="mat-status"><span class="status-crit">✗ 매우 부족</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- MISSION HISTORY -->
      <div class="panel-block">
        <div class="sec-header">Mission History</div>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th style="width:18px;"></th>
                <th>ID</th>
                <th>날짜</th>
                <th>기체</th>
                <th class="text-right">최대고도</th>
                <th class="text-right">Δv</th>
                <th>결과</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="mission-icon-x">✗</span></td>
                <td class="nowrap" style="color:var(--text-secondary);">ML-001</td>
                <td style="color:var(--text-dim);">D+07</td>
                <td style="color:var(--text-dim);">Alpha mk.1</td>
                <td class="text-right mono" style="color:var(--text-secondary);">2.3 km</td>
                <td class="text-right mono" style="color:var(--text-secondary);">842 m/s</td>
                <td class="mission-result-fail" style="font-size:9px;">구조 파손</td>
              </tr>
              <tr>
                <td><span class="mission-icon-x">✗</span></td>
                <td class="nowrap" style="color:var(--text-secondary);">ML-002</td>
                <td style="color:var(--text-dim);">D+18</td>
                <td style="color:var(--text-dim);">Alpha mk.2</td>
                <td class="text-right mono" style="color:var(--text-secondary);">12.7 km</td>
                <td class="text-right mono" style="color:var(--text-secondary);">1,840 m/s</td>
                <td class="mission-result-fail" style="font-size:9px;">엔진 정지</td>
              </tr>
              <tr>
                <td><span class="mission-icon-warn">△</span></td>
                <td class="nowrap" style="color:var(--warning);">ML-003</td>
                <td style="color:var(--text-dim);">D+35</td>
                <td style="color:var(--text-dim);">Beta mk.1</td>
                <td class="text-right mono" style="color:var(--warning);">89.4 km</td>
                <td class="text-right mono" style="color:var(--text-secondary);">2,970 m/s</td>
                <td class="mission-result-partial" style="font-size:9px;">제어 상실</td>
              </tr>
              <tr>
                <td><span class="mission-icon-dots">…</span></td>
                <td class="nowrap" style="color:var(--accent);">ML-004</td>
                <td style="color:var(--text-dim);">준비중</td>
                <td style="color:var(--text-dim);">Beta mk.2</td>
                <td class="text-right mono" style="color:var(--text-dim);">—</td>
                <td class="text-right mono" style="color:var(--text-dim);">—</td>
                <td class="mission-result-prep" style="font-size:9px;">조립 57%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- STATISTICS -->
      <div class="panel-block">
        <div class="sec-header">Statistics</div>
        <div id="stats-panel">
          <div class="stat-grid">
            <div class="stat-cell">
              <div class="stat-label">총 발사 시도</div>
              <div class="stat-value">3 <span style="font-size:9px;color:var(--text-dim);font-weight:400;">회</span></div>
            </div>
            <div class="stat-cell">
              <div class="stat-label">성공 / 준성공 / 실패</div>
              <div class="stat-value"><span style="color:var(--red);">0</span> / <span style="color:var(--warning);">1</span> / <span style="color:var(--red);">2</span></div>
            </div>
            <div class="stat-cell full">
              <div class="stat-label">최대 도달 고도</div>
              <div class="stat-value warn">89.4 km <span style="font-size:9px;color:var(--text-dim);font-weight:400;">— Kármán선까지 10.6km 미달</span></div>
            </div>
            <div class="stat-cell">
              <div class="stat-label">최고 달성 속도</div>
              <div class="stat-value accent">2,340 m/s</div>
            </div>
            <div class="stat-cell">
              <div class="stat-label">누적 비행시간</div>
              <div class="stat-value">847 <span style="font-size:9px;color:var(--text-dim);font-weight:400;">초</span></div>
            </div>
            <div class="stat-cell full">
              <div class="stat-label">총 소모 추진제</div>
              <div class="stat-value">11.2 t</div>
              <div class="stat-sub">LOX + RP-1 합산</div>
            </div>
          </div>
        </div>
      </div>

    </div><!-- /right-sidebar -->

  </div><!-- /main -->

  <!-- ── BOTTOM BAR ──────────────────────────────── -->
  <div id="bottombar">
    <div class="bb-section">
      <button class="btn-abort" onclick="handleAbort()">ABORT</button>
    </div>
    <div class="bb-section">
      <div class="bb-sys-checks">
        <div class="sys-check">
          <span class="sys-check-label">추진</span>
          <span class="sys-check-val sys-nd">N/D</span>
        </div>
        <div class="sys-check">
          <span class="sys-check-label">항전</span>
          <span class="sys-check-val sys-nd">N/D</span>
        </div>
        <div class="sys-check">
          <span class="sys-check-label">구조</span>
          <span class="sys-check-val sys-go">GO</span>
        </div>
        <div class="sys-check">
          <span class="sys-check-label">연료</span>
          <span class="sys-check-val sys-no">NO</span>
        </div>
        <div class="sys-check">
          <span class="sys-check-label">통신</span>
          <span class="sys-check-val sys-go">GO</span>
        </div>
        <div class="sys-check">
          <span class="sys-check-label">기상</span>
          <span class="sys-check-val sys-go">GO</span>
        </div>
      </div>
    </div>
    <div class="bb-section grow">
      <div class="bb-prog">
        <div class="bb-prog-label">조립 진행률 — 03 추진 계통 조립</div>
        <div class="bb-prog-bar"><div class="bb-prog-fill"></div></div>
      </div>
      <div class="bb-warning">
        <span class="warn-icon">⚠</span>
        발사 전 모든 시스템 검사 완료 필요 — 현재 4/7 단계 미완료
      </div>
    </div>
    <div class="bb-section">
      <button class="btn-launch" onclick="initLaunch()">
        LAUNCH NOW <span class="arrow">▶</span>
      </button>
    </div>
  </div>

</div><!-- /app -->

<!-- SPLIT PANELS -->
<div id="split-left"></div>
<div id="split-right"></div>

<!-- LAUNCH OVERLAY (countdown) -->
<div id="launch-overlay">
  <div id="countdown-box">
    <div class="cd-label">LAUNCH COMMIT</div>
    <div id="cd-number">T−10</div>
    <div style="margin-top:14px;font-size:10px;color:var(--text-dim);letter-spacing:0.2em;">ML-004 / BETA mk.2</div>
  </div>
</div>

<!-- LAUNCH DISPLAY (rocket + telemetry) -->
<div id="launch-display">

  <div id="rocket-anim-wrap">
    <svg id="rocket-anim" width="40" height="80" viewBox="0 0 40 80" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- Body -->
      <path d="M20 2 L30 30 L10 30 Z" stroke="#00a8e8" stroke-width="1.5" fill="rgba(0,168,232,0.12)"/>
      <rect x="10" y="30" width="20" height="34" rx="2" stroke="rgba(255,255,255,0.4)" stroke-width="1" fill="rgba(255,255,255,0.04)"/>
      <!-- Fins -->
      <path d="M10 54 L4 70 L10 64 Z" stroke="rgba(255,255,255,0.3)" stroke-width="1" fill="rgba(0,168,232,0.08)"/>
      <path d="M30 54 L36 70 L30 64 Z" stroke="rgba(255,255,255,0.3)" stroke-width="1" fill="rgba(0,168,232,0.08)"/>
      <!-- Nozzle -->
      <path d="M13 64 L10 78 L30 78 L27 64 Z" stroke="rgba(255,255,255,0.2)" stroke-width="1" fill="rgba(255,85,0,0.08)"/>
      <!-- Exhaust group -->
      <g id="exhaust">
        <ellipse cx="20" cy="80" rx="6" ry="12" fill="rgba(255,140,0,0.6)"/>
        <ellipse cx="20" cy="80" rx="3" ry="7" fill="rgba(255,220,80,0.8)"/>
      </g>
    </svg>
  </div>

  <div id="telem-scroll">
    <div class="telem-line telem-nominal" id="tl-0">ALT: 0 m &nbsp;|&nbsp; Vvel: 0 m/s &nbsp;|&nbsp; T+0</div>
    <div class="telem-line telem-nominal" id="tl-1">ALT: 1,200 m &nbsp;|&nbsp; Vvel: 184 m/s &nbsp;|&nbsp; T+8</div>
    <div class="telem-line telem-nominal" id="tl-2">ALT: 8,400 m &nbsp;|&nbsp; Vvel: 623 m/s &nbsp;|&nbsp; T+22</div>
    <div class="telem-line telem-nominal" id="tl-3">ALT: 23,700 m &nbsp;|&nbsp; Vvel: 1,104 m/s &nbsp;|&nbsp; T+44</div>
    <div class="telem-line telem-nominal" id="tl-4">ALT: 51,200 m &nbsp;|&nbsp; Vvel: 1,680 m/s &nbsp;|&nbsp; T+71</div>
    <div class="telem-line telem-nominal" id="tl-5">ALT: 71,400 m &nbsp;|&nbsp; Vvel: 1,940 m/s &nbsp;|&nbsp; T+88</div>
    <div class="telem-line telem-nominal" id="tl-6">ALT: 84,200 m &nbsp;|&nbsp; Vvel: 1,820 m/s &nbsp;|&nbsp; T+100</div>
    <div class="telem-line telem-nominal" id="tl-7">ALT: 91,800 m &nbsp;|&nbsp; Vvel: 1,410 m/s &nbsp;|&nbsp; T+110</div>
    <div class="telem-line telem-warn" id="tl-8">⚠ ANOMALY DETECTED — RP-1 라인 압력 강하 감지</div>
    <div class="telem-line telem-warn" id="tl-9">ALT: 87,300 m (↓) &nbsp;|&nbsp; 추력 47% 감소 &nbsp;|&nbsp; T+118</div>
    <div class="telem-line telem-lost" id="tl-10">⛔ VEHICLE LOST — 연료 계통 이상 확인</div>
  </div>

  <div id="mission-result">
    <div class="result-headline">ML-004 임무 종료</div>
    <div class="result-detail">
      최대 고도 <strong style="color:var(--warning);">91.8 km</strong> 달성 &nbsp;—&nbsp; Kármán선까지 <strong style="color:var(--red);">8.6 km</strong> 미달<br>
      비행시간 T+118s &nbsp;|&nbsp; 최대 속도 1,940 m/s &nbsp;|&nbsp; 최대 Δv 3,210 m/s
    </div>
    <div class="result-cause">비행 종료 원인: 연료 계통 이상 — RP-1 라인 누설 (T+110s 발생)</div>
    <button class="btn-close" onclick="resetLaunch()">CLOSE — RETURN TO FACILITY</button>
  </div>

</div><!-- /launch-display -->

<script>
  /* ── TIMER ─────────────────────────────── */
  let timerEl = document.getElementById('timer');
  let timerStart = Date.now();
  let timerInterval = setInterval(() => {
    let elapsed = Math.floor((Date.now() - timerStart) / 1000);
    let h = String(Math.floor(elapsed / 3600)).padStart(2, '0');
    let m = String(Math.floor((elapsed % 3600) / 60)).padStart(2, '0');
    let s = String(elapsed % 60).padStart(2, '0');
    timerEl.textContent = h + ':' + m + ':' + s;
  }, 1000);

  /* ── LAUNCH SEQUENCE ────────────────────── */
  let launching = false;

  function handleAbort() {
    if (launching) return;
    let btn = document.querySelector('.btn-abort');
    btn.style.boxShadow = '0 0 20px rgba(255,34,34,0.5)';
    btn.textContent = 'ABORTED';
    setTimeout(() => {
      btn.style.boxShadow = '';
      btn.textContent = 'ABORT';
    }, 1500);
  }

  function initLaunch() {
    if (launching) return;
    launching = true;

    let overlay = document.getElementById('launch-overlay');
    let cdNum = document.getElementById('cd-number');

    // Step 1: Show countdown overlay
    overlay.classList.add('active');

    let count = 10;
    cdNum.textContent = 'T−' + count;

    let cdInterval = setInterval(() => {
      count--;
      if (count > 0) {
        cdNum.textContent = 'T−' + count;
        cdNum.classList.remove('flash');
        void cdNum.offsetWidth; // reflow
        cdNum.classList.add('flash');
      } else {
        cdNum.textContent = 'T−0';
        cdNum.classList.remove('flash');
        void cdNum.offsetWidth;
        cdNum.classList.add('flash');
        clearInterval(cdInterval);
        setTimeout(() => doLaunchSplit(overlay), 600);
      }
    }, 1000);
  }

  function doLaunchSplit(overlay) {
    // Hide overlay
    overlay.classList.remove('active');

    let splitL = document.getElementById('split-left');
    let splitR = document.getElementById('split-right');
    let display = document.getElementById('launch-display');

    // Apply the visible panels covering screen
    splitL.classList.add('slide');
    splitR.classList.add('slide');

    // After transition settles (~100ms), open them
    setTimeout(() => {
      splitL.classList.add('open');
      splitR.classList.add('open');

      // Show launch display
      display.classList.add('visible');

      // Animate rocket
      let rocketEl = document.getElementById('rocket-anim');
      rocketEl.classList.add('flying');

      // Stream telemetry lines
      streamTelemetry();

    }, 200);
  }

  function streamTelemetry() {
    let lines = document.querySelectorAll('.telem-line');
    let delays = [0, 600, 1200, 1800, 2600, 3200, 3800, 4400, 5000, 5600, 6200];

    lines.forEach((line, i) => {
      setTimeout(() => {
        // hide all, show current
        lines.forEach(l => l.classList.remove('show'));
        line.classList.add('show');
      }, delays[i] || (i * 600));
    });

    // After all telemetry, show result
    setTimeout(() => {
      document.getElementById('mission-result').classList.add('show');
    }, 7200);
  }

  function resetLaunch() {
    launching = false;

    let splitL = document.getElementById('split-left');
    let splitR = document.getElementById('split-right');
    let display = document.getElementById('launch-display');
    let overlay = document.getElementById('launch-overlay');
    let result = document.getElementById('mission-result');
    let rocketEl = document.getElementById('rocket-anim');

    display.classList.remove('visible');
    result.classList.remove('show');

    splitL.classList.remove('open');
    splitR.classList.remove('open');

    setTimeout(() => {
      splitL.classList.remove('slide');
      splitR.classList.remove('slide');
      rocketEl.classList.remove('flying');
      document.querySelectorAll('.telem-line').forEach(l => l.classList.remove('show'));
      overlay.classList.remove('active');
    }, 1600);
  }
</script>
</body>
</html>
