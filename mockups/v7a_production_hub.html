<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOON IDLE — 생산 허브 v7a</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:        #010800;
    --panel-bg:  #020d04;
    --green:     #00e676;
    --green-dim: #1a5c34;
    --green-mid: #00994d;
    --amber:     #ffab00;
    --red:       #ff1744;
    --white:     #c8ffd4;
    --font: 'Share Tech Mono', monospace;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--green);
    font-family: var(--font);
    font-size: 15px;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
    display: flex;
    flex-direction: column;
  }

  /* CRT scanlines */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent 0px,
      transparent 2px,
      rgba(0,0,0,0.09) 2px,
      rgba(0,0,0,0.09) 4px
    );
    pointer-events: none;
    z-index: 9998;
  }

  /* CRT vignette */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background: radial-gradient(ellipse at center,
      transparent 50%,
      rgba(0,0,0,0.65) 100%
    );
    pointer-events: none;
    z-index: 9997;
  }

  @keyframes crt-flicker {
    0%,90%,94%,100% { opacity: 1; }
    91%  { opacity: 0.93; }
    92%  { opacity: 1; }
    95%  { opacity: 0.88; }
    96%  { opacity: 1; }
  }

  #app {
    display: flex;
    flex-direction: column;
    height: 100vh;
    animation: crt-flicker 10s infinite;
  }

  /* ══ TOP BAR ═══════════════════════════════════ */
  #topbar {
    background: var(--panel-bg);
    border-bottom: 2px solid var(--green-dim);
    padding: 7px 18px;
    display: flex;
    align-items: center;
    gap: 14px;
    font-size: 16px;
    flex-shrink: 0;
    white-space: nowrap;
    overflow: hidden;
  }
  #topbar .logo  { color: var(--green); font-size: 18px; font-weight: bold; letter-spacing: 1px; }
  #topbar .sep   { color: var(--green-dim); }
  #topbar .clk   { color: var(--white);  font-size: 15px; min-width: 80px; }
  #topbar .mny   { color: var(--amber);  font-size: 18px; font-weight: bold; }
  #topbar .sys   { color: var(--green-mid); font-size: 14px; margin-left: auto; }

  /* ══ MAIN ══════════════════════════════════════ */
  #main {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  /* ══ LEFT PANEL ════════════════════════════════ */
  #lp {
    width: 22%;
    min-width: 210px;
    max-width: 272px;
    background: var(--panel-bg);
    border-right: 1px solid var(--green-dim);
    overflow-y: auto;
    overflow-x: hidden;
    flex-shrink: 0;
    padding: 8px;
  }
  #lp::-webkit-scrollbar { width: 4px; }
  #lp::-webkit-scrollbar-track { background: var(--bg); }
  #lp::-webkit-scrollbar-thumb { background: var(--green-dim); }

  .sh {
    color: var(--green-dim);
    font-size: 12px;
    letter-spacing: 2px;
    padding: 7px 4px 3px;
    border-bottom: 1px solid var(--green-dim);
    margin-bottom: 5px;
    text-transform: uppercase;
  }

  .rr { padding: 3px 4px; margin-bottom: 5px; }

  .rn {
    color: var(--white);
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .rv {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 4px;
  }

  .ra       { font-size: 15px; color: var(--green); font-weight: bold; }
  .ra.money { font-size: 19px; color: var(--amber); }
  .ra.warn  { color: var(--amber); }
  .ra.crit  { color: var(--red); }
  .rrate    { font-size: 12px; color: var(--green-mid); }

  .gbar {
    height: 6px;
    background: var(--green-dim);
    margin-top: 3px;
    border-radius: 3px;
    overflow: hidden;
  }
  .gfill {
    height: 100%;
    background: var(--green);
    border-radius: 3px;
    transition: width 0.9s ease;
  }
  .gfill.a { background: var(--amber); }
  .gfill.r { background: var(--red); }

  .tag {
    display: inline-block;
    font-size: 11px;
    padding: 0 5px;
    margin-top: 2px;
    border: 1px solid;
    letter-spacing: 1px;
  }
  .tag.low  { color: var(--amber); border-color: var(--amber); }
  .tag.crit { color: var(--red);   border-color: var(--red); }

  /* ══ WORLD CONTAINER ═══════════════════════════ */
  #ww {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
  }

  #ws {
    flex: 1;
    overflow-x: auto;
    overflow-y: hidden;
    cursor: grab;
  }
  #ws:active { cursor: grabbing; }
  #ws::-webkit-scrollbar { height: 8px; }
  #ws::-webkit-scrollbar-track { background: var(--bg); border-top: 1px solid var(--green-dim); }
  #ws::-webkit-scrollbar-thumb { background: var(--green-dim); border-radius: 4px; }

  #world {
    width: 2800px;
    height: 400px;
    position: relative;
    background: linear-gradient(180deg,
      #000d03 0%,
      #011205 38%,
      #010900 65%,
      #010800 100%
    );
  }

  #ground {
    position: absolute;
    bottom: 52px;
    left: 0;
    width: 100%;
    height: 16px;
    font-family: var(--font);
    font-size: 14px;
    color: var(--green-dim);
    white-space: nowrap;
    letter-spacing: 0;
    line-height: 16px;
    overflow: hidden;
    pointer-events: none;
  }

  /* ══ BUILDINGS ═════════════════════════════════ */
  .bld {
    position: absolute;
    bottom: 67px;
    font-family: var(--font);
    font-size: 14px;
    line-height: 1.45;
    color: var(--green);
    cursor: pointer;
    white-space: pre;
    user-select: none;
    z-index: 10;
    transition: filter 0.12s;
  }
  .bld:hover {
    filter: brightness(1.5) drop-shadow(0 0 8px var(--green));
  }
  .bld.amber       { color: var(--amber); }
  .bld.amber:hover { filter: brightness(1.5) drop-shadow(0 0 8px var(--amber)); }
  .bld.under       { color: var(--green-dim); }
  .bld.add-b       { color: var(--green-dim); }
  .bld.add-b:hover { color: var(--green-mid); filter: brightness(1.3); }

  @keyframes smoke-rise {
    0%   { transform: translateY(0)     translateX(0);    opacity: .85; }
    50%  { transform: translateY(-15px) translateX(4px);  opacity: .42; }
    100% { transform: translateY(-30px) translateX(-3px); opacity: 0;   }
  }
  .smoke {
    position: absolute;
    font-family: var(--font);
    font-size: 14px;
    color: var(--green-dim);
    pointer-events: none;
    z-index: 20;
    animation: smoke-rise 1.9s ease-out infinite;
  }

  .wkr {
    position: absolute;
    bottom: 66px;
    font-size: 17px;
    line-height: 1;
    pointer-events: none;
    z-index: 15;
  }

  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: var(--green);
    border-radius: 50%;
    pointer-events: none;
  }

  /* ══ UPGRADE OVERLAY ═══════════════════════════ */
  #ov {
    position: fixed;
    display: none;
    z-index: 9500;
    font-family: var(--font);
    font-size: 14px;
    color: var(--green);
    background: rgba(1,8,0,0.98);
    border: 1px solid var(--green);
    min-width: 300px;
    max-width: 370px;
    box-shadow: 0 0 26px rgba(0,230,118,0.20);
  }

  .ovl  { padding: 5px 12px; white-space: pre; font-size: 14px; }
  .ovsp { border-top: 1px solid var(--green-dim); }
  .ovhd { color: var(--white); font-size: 15px; }
  .ovsb { color: var(--green-mid); font-size: 13px; }
  .ovco { color: var(--amber); }
  .ovef { color: var(--green); font-size: 13px; }
  .ovbt { display: flex; gap: 6px; padding: 5px 10px 7px; flex-wrap: wrap; }

  .obtn {
    padding: 5px 11px;
    border: 1px solid var(--green);
    color: var(--green);
    cursor: pointer;
    font-family: var(--font);
    font-size: 13px;
    background: transparent;
    transition: background .13s, color .13s;
    white-space: nowrap;
  }
  .obtn:hover             { background: var(--green); color: var(--bg); }
  .obtn.a                 { border-color: var(--amber); color: var(--amber); }
  .obtn.a:hover           { background: var(--amber); color: var(--bg); }
  .obtn.r                 { border-color: var(--red); color: var(--red); }
  .obtn.r:hover           { background: var(--red); color: var(--bg); }
  .obtn.off               { opacity: .38; cursor: not-allowed; pointer-events: none; }

  /* ══ RIGHT PANEL ════════════════════════════════ */
  #rp {
    width: 155px;
    background: var(--panel-bg);
    border-left: 1px solid var(--green-dim);
    overflow-y: auto;
    flex-shrink: 0;
    padding: 8px 6px;
    font-size: 13px;
  }
  #rp::-webkit-scrollbar { width: 3px; }
  #rp::-webkit-scrollbar-thumb { background: var(--green-dim); }

  .rph {
    color: var(--green-dim);
    font-size: 12px;
    letter-spacing: 2px;
    padding-bottom: 4px;
    border-bottom: 1px solid var(--green-dim);
    margin-bottom: 6px;
  }
  .strow {
    padding: 4px 2px;
    border-bottom: 1px solid rgba(26,92,52,.4);
    margin-bottom: 4px;
  }
  .stn { color: var(--white);     font-size: 13px; }
  .stl { color: var(--green-mid); font-size: 11px; margin-top: 1px; }
  .sts { font-size: 11px; }

  /* ══ TICKER ═════════════════════════════════════ */
  #ticker {
    background: var(--panel-bg);
    border-top: 1px solid var(--green-dim);
    padding: 5px 14px;
    font-size: 13px;
    color: var(--green-mid);
    white-space: nowrap;
    overflow: hidden;
    flex-shrink: 0;
  }
  #tki {
    display: inline-block;
    animation: tkrun 40s linear infinite;
  }
  @keyframes tkrun {
    0%   { transform: translateX(100vw); }
    100% { transform: translateX(-100%); }
  }
  .tw { color: var(--amber); }
  .to { color: var(--green); }
  .ts { color: var(--green-dim); margin: 0 20px; }

  .flash {
    position: fixed;
    top: 58px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--panel-bg);
    font-family: var(--font);
    font-size: 16px;
    padding: 8px 22px;
    z-index: 9999;
    pointer-events: none;
    transition: opacity .5s;
    border: 1px solid;
  }
  .flash.g { color: var(--green);  border-color: var(--green); }
  .flash.a { color: var(--amber);  border-color: var(--amber); }
  .flash.r { color: var(--red);    border-color: var(--red);   }
</style>
</head>
<body>
<div id="app">

<!-- ╔══ TOP BAR ══╗ -->
<div id="topbar">
  <span class="logo">&#9654; MOON IDLE</span>
  <span class="sep">—</span>
  <span style="color:var(--green-mid)">생산 &amp; 자원</span>
  <span class="sep">|</span>
  <span class="clk" id="clk">00:00:00</span>
  <span class="sep">|</span>
  <span class="mny">&#128176; &#8361;&thinsp;<span id="top-money">48,200</span></span>
  <span class="sep">|</span>
  <span class="sys">SYS:<span id="sys-st" style="color:var(--green-mid)">NOMINAL</span></span>
</div>

<!-- ╔══ MAIN ══╗ -->
<div id="main">

<!-- ══ LEFT PANEL ══ -->
<div id="lp">

  <div class="sh">&#9726; 자금</div>
  <div class="rr">
    <div class="rn">기금 (FUND)</div>
    <div class="rv">
      <span class="ra money">&#8361;&thinsp;<span id="r-money">48,200</span></span>
      <span class="rrate" style="color:var(--amber)">(+<span id="r-money-rate">320</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill a" id="g-money" style="width:62%"></div></div>
  </div>

  <div class="sh">&#9726; 원자재</div>

  <div class="rr">
    <div class="rn">철광석 (Iron Ore)</div>
    <div class="rv">
      <span class="ra"><span id="r-iron">8,420</span></span>
      <span class="rrate">(+<span id="r-iron-rate">320</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-iron" style="width:71%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">보크사이트 (Bauxite)</div>
    <div class="rv">
      <span class="ra"><span id="r-bauxite">3,180</span></span>
      <span class="rrate">(+<span id="r-bauxite-rate">180</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-bauxite" style="width:44%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">구리 (Copper)</div>
    <div class="rv">
      <span class="ra"><span id="r-copper">2,050</span></span>
      <span class="rrate">(+<span id="r-copper-rate">95</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-copper" style="width:38%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">알루미늄 (Aluminum)</div>
    <div class="rv">
      <span class="ra"><span id="r-aluminum">1,640</span></span>
      <span class="rrate">(+<span id="r-aluminum-rate">76</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-aluminum" style="width:29%"></div></div>
  </div>

  <div class="sh">&#9726; 정제 소재</div>

  <div class="rr">
    <div class="rn">강철 (Steel)</div>
    <div class="rv">
      <span class="ra"><span id="r-steel">2,840</span></span>
      <span class="rrate">(+<span id="r-steel-rate">228</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-steel" style="width:55%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">Al-7075</div>
    <div class="rv">
      <span class="ra"><span id="r-al7075">920</span></span>
      <span class="rrate">(+<span id="r-al7075-rate">54</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-al7075" style="width:33%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">Cu배선 (Cu Wire)</div>
    <div class="rv">
      <span class="ra"><span id="r-cuwire">680</span></span>
      <span class="rrate">(+<span id="r-cuwire-rate">42</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-cuwire" style="width:28%"></div></div>
  </div>

  <div class="sh">&#9726; 첨단 소재</div>

  <div class="rr">
    <div class="rn">CFRP</div>
    <div class="rv">
      <span class="ra"><span id="r-cfrp">340</span></span>
      <span class="rrate">(+<span id="r-cfrp-rate">18</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-cfrp" style="width:22%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">Inconel 718</div>
    <div class="rv">
      <span class="ra"><span id="r-inconel">210</span></span>
      <span class="rrate">(+<span id="r-inconel-rate">12</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-inconel" style="width:18%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">Ti-6Al-4V</div>
    <div class="rv">
      <span class="ra"><span id="r-titanium">155</span></span>
      <span class="rrate">(+<span id="r-titanium-rate">8</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-titanium" style="width:14%"></div></div>
  </div>

  <div class="sh">&#9726; 추진제</div>

  <div class="rr">
    <div class="rn">LOX (액체 산소)</div>
    <div class="rv">
      <span class="ra warn"><span id="r-lox">183</span></span>
      <span class="rrate">(+<span id="r-lox-rate">22</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill a" id="g-lox" style="width:24%"></div></div>
    <span class="tag low">LOW</span>
  </div>

  <div class="rr">
    <div class="rn">RP-1 (케로신)</div>
    <div class="rv">
      <span class="ra"><span id="r-rp1">520</span></span>
      <span class="rrate">(+<span id="r-rp1-rate">30</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill" id="g-rp1" style="width:48%"></div></div>
  </div>

  <div class="rr">
    <div class="rn">GH2 (기체 수소)</div>
    <div class="rv">
      <span class="ra crit"><span id="r-gh2">42</span></span>
      <span class="rrate">(+<span id="r-gh2-rate">5</span>/s)</span>
    </div>
    <div class="gbar"><div class="gfill r" id="g-gh2" style="width:8%"></div></div>
    <span class="tag crit">CRITICAL</span>
  </div>

</div><!-- /lp -->

<!-- ══ WORLD ══ -->
<div id="ww">
<div id="ws">
<div id="world">

<!-- Stars (injected by JS) -->

<!-- ── Iron Mine  x=20 ── -->
<pre class="bld" id="b0"
  data-key="iron-mine" data-name="철광석 광산" data-level="2"
  data-cost="8000"  data-mat="강철 300kg"
  data-effect="채굴속도 +40%  출력 ×1.3" data-staff="1/2"
  style="left:20px">  [철광석 광산 Lv.2]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; IRON    &#9553;
  &#9553; MINE    &#9553;
  &#9553; &#9619;&#9619;&#9619;&#9618;&#9618;&#9618; &#9553;
  &#9553; 320/s   &#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;
    &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;
   &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;
  /\/\/\/\/\</pre>

<!-- ── Bauxite Mine  x=200 ── -->
<pre class="bld" id="b1"
  data-key="bauxite-mine" data-name="보크사이트 광산" data-level="1"
  data-cost="5500"  data-mat="강철 200kg"
  data-effect="채굴속도 +30%  출력 ×1.2" data-staff="1/2"
  style="left:200px">  [보크사이트 Lv.1]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; BAUXIT  &#9553;
  &#9553; MINE    &#9553;
  &#9553; &#9619;&#9619;&#9618;&#9618;&#9618;&#9618; &#9553;
  &#9553; 180/s   &#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;
    &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;
   &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;</pre>

<!-- ── Add Mine placeholder  x=390 ── -->
<pre class="bld add-b" id="b2"
  data-key="add-mine" data-name="광산 추가" data-level="0"
  data-cost="15000" data-mat="" data-effect="새 채굴 슬롯 개방" data-staff="0/0"
  style="left:390px; bottom:92px">  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
  &#9474; + ADD  &#9474;
  &#9474;  MINE  &#9474;
  &#9474; [&#8361;15k] &#9474;
  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</pre>

<!-- ── Smelter  x=510 ── -->
<pre class="bld" id="b3"
  data-key="smelter" data-name="제련소" data-level="3"
  data-cost="12000" data-mat="강철 500kg"
  data-effect="효율 +15%  속도 ×1.2" data-staff="2/3"
  style="left:510px">   [제련소 Lv.3]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; SMELTER&#9553;
  &#9553; Fe&#8594;Steel&#9553;
  &#9553; &#9619;&#9619;&#9619;&#9619;&#9619;&#9618;&#9618; &#9553;
  &#9553; &#54952;&#50984; 71%&#9553;
  &#9568;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9571;
  &#9553; &#9553;&#9553;     &#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre>

<!-- Smelter smoke -->
<span class="smoke" id="sma" style="left:548px; bottom:298px">o</span>
<span class="smoke" id="smb" style="left:556px; bottom:290px; animation-delay:.65s">&#176;</span>

<!-- ── Alloy Plant  x=720 ── -->
<pre class="bld" id="b4"
  data-key="alloy" data-name="합금공장" data-level="2"
  data-cost="18000" data-mat="Al-7075 200kg"
  data-effect="처리량 +25%  효율 +10%" data-staff="2/3"
  style="left:720px">  [합금공장 Lv.2]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; ALLOY     &#9553;
  &#9553; PLANT     &#9553;
  &#9553; Al&#8594;Al-7075&#9553;
  &#9553; &#9619;&#9619;&#9619;&#9618;&#9618;&#9618;&#9618;&#9618;&#9618; &#9553;
  &#9568;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9571;
  &#9553;<span id="conv">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>&#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre>

<!-- ── CFRP Plant  x=960 ── -->
<pre class="bld" id="b5"
  data-key="cfrp" data-name="CFRP 시설" data-level="1"
  data-cost="25000" data-mat="Inconel 718  100kg"
  data-effect="경화속도 +20%  수율 +12%" data-staff="1/2"
  style="left:960px">  [CFRP 시설 Lv.1]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; CFRP EXT&#9553;
  &#9553; /////////&#9553;
  &#9553; =========&#9553;
  &#9553; 140&#176;C CURE&#9553;
  &#9553; &#9619;&#9619;&#9618;&#9618;&#9618;&#9618;&#9618;&#9618;&#9618; &#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre>

<!-- ── Propellant Storage  x=1165 ── -->
<pre class="bld amber" id="b6"
  data-key="propellant" data-name="추진제 저장고" data-level="2"
  data-cost="22000" data-mat="Ti-6Al-4V 80kg"
  data-effect="저장용량 ×2  냉각효율 +30%" data-staff="1/2"
  style="left:1165px">  [추진제 저장 Lv.2]
  &#9556;&#9552;&#9552;&#9552;&#9559;  &#9556;&#9552;&#9552;&#9552;&#9559;  &#9556;&#9552;&#9552;&#9552;&#9559;
  &#9553;LOX&#9553;  &#9553;RP1&#9553;  &#9553;GH2&#9553;
  &#9553; - &#9553;  &#9553;   &#9553;  &#9553; ! &#9553;
  &#9553;183&#9553;  &#9553;520&#9553;  &#9553; 42&#9553;
  &#9562;&#9552;&#9552;&#9552;&#9565;  &#9562;&#9552;&#9552;&#9552;&#9565;  &#9562;&#9552;&#9552;&#9552;&#9565;
  [CRYO][PUMP][HIGH-P]</pre>

<!-- ── Add Production placeholder  x=1415 ── -->
<pre class="bld add-b" id="b7"
  data-key="add-prod" data-name="생산시설 추가" data-level="0"
  data-cost="30000" data-mat="" data-effect="새 생산 슬롯 개방" data-staff="0/0"
  style="left:1415px; bottom:92px">  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
  &#9474;+ PROD  &#9474;
  &#9474; FACIL  &#9474;
  &#9474; [&#8361;30k] &#9474;
  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</pre>

<!-- ── Assembly Hall  x=1570 ── -->
<pre class="bld" id="b8"
  data-key="assembly" data-name="조립공장" data-level="2"
  data-cost="35000" data-mat="CFRP 150kg  Inconel 80kg"
  data-effect="조립속도 +35%  정밀도 +20%" data-staff="2/3"
  style="left:1570px"> [조립공장 Lv.2]
  &#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
  &#9553; ASSEMBLY   &#9553;
  &#9553; HALL       &#9553;
  &#9553;     *      &#9553;
  &#9553;    /|\     &#9553;
  &#9553;   / | \    &#9553;
  &#9553;  |ENGINE|  &#9553;
  &#9553; BETA mk.2  &#9553;
  &#9553; 57% &#9619;&#9619;&#9619;&#9618;&#9618;&#9618; &#9553;
  &#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre>

<!-- ── Launch Pad Alpha  x=1900 ── -->
<pre class="bld" id="b9"
  data-key="pad-alpha" data-name="발사대 Alpha" data-level="2"
  data-cost="50000" data-mat="강철 1000kg  Ti-6Al-4V 200kg"
  data-effect="발사 성공률 +15%  탑재량 +500kg" data-staff="2/3"
  style="left:1900px">   [발사대 Alpha]
  &#9553;     &#9553;
  &#9553;  &#9580;&#9472;&#9580; &#9553;
  &#9553;     &#9553;
       /|\
      / | \
     / BETA\
    /_mk.2__\
   | ENGINE |
   |_________|
  &#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;</pre>

<!-- ── Launch Pad Beta (under construction)  x=2230 ── -->
<pre class="bld under" id="b10"
  data-key="pad-beta" data-name="발사대 Beta" data-level="0"
  data-cost="0" data-mat="" data-effect="건설 완료 시 발사 가능" data-staff="0/0"
  style="left:2230px">  [발사대 Beta - 건설중]
  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
  &#9474; &#9608;&#9608;&#9608;&#9608;&#9608;&#9619;&#9619;&#9619;&#9619;&#9619; &#9474;
  &#9474;  건설 중...  &#9474;
  &#9474;     48%      &#9474;
  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
  = = = = = = = =</pre>

<!-- ── Add Launch Pad placeholder  x=2520 ── -->
<pre class="bld add-b" id="b11"
  data-key="add-pad" data-name="발사대 추가" data-level="0"
  data-cost="80000" data-mat="" data-effect="새 발사 슬롯 개방" data-staff="0/0"
  style="left:2520px; bottom:92px">  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
  &#9474;+ PAD   &#9474;
  &#9474; SITE   &#9474;
  &#9474; [&#8361;80k] &#9474;
  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</pre>

<!-- Ground -->
<div id="ground">&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;</div>

<!-- Workers -->
<span class="wkr" id="wk0" style="left:80px;  color:var(--green)">&#9679;</span>
<span class="wkr" id="wk1" style="left:395px; color:var(--amber)">&#9679;</span>
<span class="wkr" id="wk2" style="left:700px; color:var(--green)">&#9679;</span>
<span class="wkr" id="wk3" style="left:1180px;color:var(--green-dim)">&#9679;</span>
<span class="wkr" id="wk4" style="left:1850px;color:var(--amber)">&#9679;</span>

</div><!-- /world -->
</div><!-- /ws -->
</div><!-- /ww -->

<!-- ══ RIGHT PANEL ══ -->
<div id="rp">

  <div class="rph">&#9726; 직원</div>

  <div class="strow">
    <div class="stn">김엔지니어</div>
    <div class="stl">&#8594; 제련소</div>
    <div class="sts" style="color:var(--green)">&#9679; 작업 중</div>
  </div>

  <div class="strow">
    <div class="stn">이박사</div>
    <div class="stl">&#8594; 합금공장</div>
    <div class="sts" style="color:var(--green)">&#9679; 작업 중</div>
  </div>

  <div class="strow">
    <div class="stn">박매니저</div>
    <div class="stl">&#8594; 조립공장</div>
    <div class="sts" style="color:var(--amber)">&#9679; 순찰 중</div>
  </div>

  <div class="strow">
    <div class="stn">최기사</div>
    <div class="stl">&#8594; 미배치</div>
    <div class="sts" style="color:var(--green-dim)">&#9679; 대기</div>
  </div>

  <div style="margin-top:8px">
    <button class="obtn a" style="width:100%;font-size:12px;padding:5px 4px">[고용] +직원</button>
  </div>

  <div style="margin-top:10px;border:1px solid var(--green-dim);padding:6px 4px">
    <div style="color:var(--green-dim);font-size:11px;letter-spacing:1px">전체 효율</div>
    <div style="color:var(--green);font-size:19px;font-weight:bold">73.4%</div>
    <div class="gbar" style="margin-top:4px">
      <div class="gfill a" style="width:73.4%"></div>
    </div>
  </div>

  <div style="margin-top:12px;border-top:1px solid var(--green-dim);padding-top:8px">
    <div class="rph">&#9726; 발사 현황</div>
    <div style="font-size:12px;color:var(--green-mid);margin-top:4px">BETA mk.2</div>
    <div style="font-size:13px;color:var(--green)">조립 57%</div>
    <div class="gbar" style="margin-top:4px">
      <div class="gfill" style="width:57%"></div>
    </div>
    <div style="font-size:11px;color:var(--green-dim);margin-top:4px">ETA: 42분</div>
  </div>

  <div style="margin-top:12px;border-top:1px solid var(--green-dim);padding-top:8px">
    <div class="rph">&#9726; 빠른 액션</div>
    <button class="obtn" style="width:100%;font-size:11px;padding:4px;margin:2px 0">[긴급 주문]</button>
    <button class="obtn a" style="width:100%;font-size:11px;padding:4px;margin:2px 0">[LOX 보충]</button>
    <button class="obtn" style="width:100%;font-size:11px;padding:4px;margin:2px 0">[시설 점검]</button>
  </div>

</div><!-- /rp -->
</div><!-- /main -->

<!-- ══ TICKER ══ -->
<div id="ticker">
  <span id="tki">
    <span class="tw">&gt;&gt; LOX 재고 부족 경고 — 추진제 저장고 보충 필요</span>
    <span class="ts">&#9632;</span>
    <span class="to">&gt;&gt; 합금공장 효율 업그레이드 가능 — &#8361;18,000 / Al-7075 200kg</span>
    <span class="ts">&#9632;</span>
    <span>&gt;&gt; BETA mk.2 조립 57% 진행 중 — 완성까지 약 42분</span>
    <span class="ts">&#9632;</span>
    <span class="tw">&gt;&gt; GH2 잔량 위험 수준 — 즉각 조치 요망</span>
    <span class="ts">&#9632;</span>
    <span class="to">&gt;&gt; 발사대 Beta 건설 진행률 48% — 예상 완공 72시간</span>
    <span class="ts">&#9632;</span>
    <span>&gt;&gt; 제련소 Lv.3 운영 중 — 일일 강철 생산 19,584kg</span>
    <span class="ts">&#9632;</span>
  </span>
</div>

</div><!-- /app -->

<!-- ══ UPGRADE OVERLAY ══ -->
<div id="ov">
  <div class="ovl ovhd" id="ov-title">&#9553; &nbsp;</div>
  <div class="ovl ovsb" id="ov-sub">&nbsp;</div>
  <div class="ovsp"></div>
  <div class="ovl" id="ov-upg-row" style="padding-bottom:2px">
    <button class="obtn" id="ov-upg">[&#9650; 업그레이드]</button>
  </div>
  <div class="ovl ovco" id="ov-cost">&nbsp;</div>
  <div class="ovl ovco" id="ov-mat">&nbsp;</div>
  <div class="ovl ovef" id="ov-eff">&nbsp;</div>
  <div class="ovsp"></div>
  <div class="ovl" id="ov-strow">
    <span style="color:var(--green-mid)">직원 배치: </span><span id="ov-st">—</span>
  </div>
  <div class="ovbt">
    <button class="obtn" onclick="closeOv()">[닫기]</button>
    <button class="obtn r" id="ov-demo" onclick="demolish()">[철거 -50%]</button>
  </div>
</div>

<script>
// ─── STATE ─────────────────────────────────────────────────────
const S = {
  money: 48200,
  mRate: 320,
  res: {
    iron:     {v:8420,  r:320, max:50000},
    bauxite:  {v:3180,  r:180, max:20000},
    copper:   {v:2050,  r:95,  max:15000},
    aluminum: {v:1640,  r:76,  max:12000},
    steel:    {v:2840,  r:228, max:20000},
    al7075:   {v:920,   r:54,  max:8000},
    cuwire:   {v:680,   r:42,  max:5000},
    cfrp:     {v:340,   r:18,  max:3000},
    inconel:  {v:210,   r:12,  max:2000},
    titanium: {v:155,   r:8,   max:1500},
    lox:      {v:183,   r:22,  max:2000},
    rp1:      {v:520,   r:30,  max:3000},
    gh2:      {v:42,    r:5,   max:1000},
  }
};
let hovEl = null;

// ─── UTILS ─────────────────────────────────────────────────────
const fmt = n => Math.floor(n).toLocaleString('ko-KR');

// ─── CLOCK ─────────────────────────────────────────────────────
function tickClock() {
  const t = new Date();
  document.getElementById('clk').textContent =
    String(t.getHours()).padStart(2,'0') + ':' +
    String(t.getMinutes()).padStart(2,'0') + ':' +
    String(t.getSeconds()).padStart(2,'0');
}
setInterval(tickClock, 1000); tickClock();

// ─── RESOURCE TICK ─────────────────────────────────────────────
const RM = [
  ['iron',    'r-iron',    'g-iron'],
  ['bauxite', 'r-bauxite', 'g-bauxite'],
  ['copper',  'r-copper',  'g-copper'],
  ['aluminum','r-aluminum','g-aluminum'],
  ['steel',   'r-steel',   'g-steel'],
  ['al7075',  'r-al7075',  'g-al7075'],
  ['cuwire',  'r-cuwire',  'g-cuwire'],
  ['cfrp',    'r-cfrp',    'g-cfrp'],
  ['inconel', 'r-inconel', 'g-inconel'],
  ['titanium','r-titanium','g-titanium'],
  ['lox',     'r-lox',     'g-lox'],
  ['rp1',     'r-rp1',     'g-rp1'],
  ['gh2',     'r-gh2',     'g-gh2'],
];

function resTick() {
  S.money = Math.min(S.money + S.mRate, 9999999999);
  syncMoney();
  const mg = document.getElementById('g-money');
  if (mg) mg.style.width = Math.min((S.money/200000)*100,100)+'%';

  for (const [k, rId, gId] of RM) {
    const o = S.res[k];
    o.v = Math.min(o.v + o.r, o.max);
    const re = document.getElementById(rId);
    const ge = document.getElementById(gId);
    if (re) re.textContent = fmt(o.v);
    if (ge) ge.style.width = ((o.v/o.max)*100).toFixed(1)+'%';
  }
}
setInterval(resTick, 1000);

// ─── STARS ─────────────────────────────────────────────────────
(function(){
  const w = document.getElementById('world');
  for (let i = 0; i < 90; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left    = (Math.random()*2800).toFixed(0)+'px';
    s.style.top     = (Math.random()*175).toFixed(0)+'px';
    s.style.opacity = (0.15 + Math.random()*0.55).toFixed(2);
    w.appendChild(s);
  }
})();

// ─── SMOKE ─────────────────────────────────────────────────────
const SC = [' ', '.', '\u00b0', 'o', 'O', '\u00b0', 'o', ' '];
let si = 0;
setInterval(() => {
  si = (si+1) % SC.length;
  const a = document.getElementById('sma');
  const b = document.getElementById('smb');
  if (a) a.textContent = SC[si];
  if (b) b.textContent = SC[(si+3)%SC.length];
}, 400);

// ─── CONVEYOR ──────────────────────────────────────────────────
const CF = [
  '>>>>>>>>>',
  '\u2192>>>>>>>>',
  '\u2192\u2192>>>>>>>',
  '\u2192\u2192\u2192>>>>>>',
  '\u2192\u2192\u2192\u2192>>>>>',
  '\u2192\u2192\u2192\u2192\u2192>>>>',
  '\u2192\u2192\u2192\u2192\u2192\u2192>>>',
  '\u2192\u2192\u2192\u2192\u2192\u2192\u2192>>',
  '\u2192\u2192\u2192\u2192\u2192\u2192\u2192\u2192>',
];
let ci = 0;
setInterval(() => {
  ci = (ci+1) % CF.length;
  const el = document.getElementById('conv');
  if (el) el.textContent = CF[ci];
}, 110);

// ─── WORKERS ───────────────────────────────────────────────────
const WK = [
  {id:'wk0', from:45,   to:185,  spd:1.3, x:80,   dir:1},
  {id:'wk1', from:350,  to:490,  spd:1.0, x:395,  dir:1},
  {id:'wk2', from:600,  to:925,  spd:1.6, x:700,  dir:1},
  {id:'wk3', from:1050, to:1400, spd:0.7, x:1180, dir:1},
  {id:'wk4', from:1750, to:2200, spd:1.2, x:1850, dir:1},
];
setInterval(() => {
  for (const w of WK) {
    w.x += w.dir * w.spd * 2;
    if (w.x >= w.to)   { w.x = w.to;   w.dir = -1; }
    if (w.x <= w.from) { w.x = w.from; w.dir =  1; }
    const el = document.getElementById(w.id);
    if (el) el.style.left = Math.round(w.x)+'px';
  }
}, 50);

// ─── OVERLAY ───────────────────────────────────────────────────
const ov = document.getElementById('ov');

function openOv(el) {
  hovEl = el;
  const isAdd   = el.classList.contains('add-b');
  const isUnder = el.classList.contains('under');
  const level   = parseInt(el.dataset.level  || '0');
  const cost    = parseInt(el.dataset.cost   || '0');
  const name    = el.dataset.name  || el.dataset.key || '?';
  const mat     = el.dataset.mat   || '';
  const effect  = el.dataset.effect|| '';
  const staff   = el.dataset.staff || '—';

  document.getElementById('ov-title').textContent =
    '\u2553 ' + name + (level > 0 ? ' Lv.' + level : '');
  document.getElementById('ov-sub').textContent =
    '\u2553 ' + (isAdd ? '\uc2e0\uaddc \uac74\uc124' :
                 isUnder ? '\uac74\uc124 \uc911 48%' : '\uc6b4\uc601 \uc911');
  document.getElementById('ov-cost').textContent =
    cost > 0 ? '\ube44\uc6a9: \u20a9 ' + fmt(cost) : '';
  document.getElementById('ov-mat').textContent  =
    mat    ? '\uc18c\uc7ac: ' + mat    : '';
  document.getElementById('ov-eff').textContent  =
    effect ? '\ud6a8\uacfc: ' + effect : '';
  document.getElementById('ov-st').textContent   = staff + '\uba85';

  const srow = document.getElementById('ov-strow');
  const demo = document.getElementById('ov-demo');
  srow.style.display = (isAdd || isUnder) ? 'none' : '';
  demo.style.display = (isAdd || isUnder) ? 'none' : '';

  const btn = document.getElementById('ov-upg');
  if (isAdd) {
    btn.textContent = '[\u002b \uac74\uc124 \uc2dc\uc791]';
    btn.className   = 'obtn' + (S.money >= cost ? '' : ' off');
    btn.onclick     = () => purchase(cost);
  } else if (isUnder || level === 0) {
    btn.textContent = '[\uac74\uc124 \uc644\ub8cc \ub300\uae30]';
    btn.className   = 'obtn off';
    btn.onclick     = null;
  } else {
    btn.textContent = '[\u25b2 \uc5c5\uadf8\ub808\uc774\ub4dc \u2192 Lv.' + (level+1) + ']';
    btn.className   = 'obtn' + (S.money >= cost ? '' : ' off');
    btn.onclick     = () => upgrade(el, cost);
  }

  // Position near building, but stay in viewport
  const r   = el.getBoundingClientRect();
  const oW  = 340, oH = 230;
  let lx = r.left;
  let ty = r.top - oH - 8;
  if (lx + oW > window.innerWidth  - 6) lx = window.innerWidth  - oW - 6;
  if (lx < 4) lx = 4;
  if (ty < 40) ty = r.bottom + 6;
  ov.style.left    = lx + 'px';
  ov.style.top     = ty + 'px';
  ov.style.display = 'block';
}

function closeOv() {
  ov.style.display = 'none';
  hovEl = null;
}

function upgrade(el, cost) {
  if (S.money < cost) { flash('\uc790\uae08 \ubd80\uc871!', 'r'); return; }
  S.money -= cost;
  syncMoney();
  const newLv = (parseInt(el.dataset.level)||0) + 1;
  el.dataset.level = newLv;
  el.dataset.cost  = Math.floor(cost * 1.8);
  const btn = document.getElementById('ov-upg');
  btn.textContent = '[UPGRADING...]';
  btn.className   = 'obtn off';
  setTimeout(() => { flash('\uc5c5\uadf8\ub808\uc774\ub4dc \uc644\ub8cc!','g'); closeOv(); }, 1400);
}

function purchase(cost) {
  if (S.money < cost) { flash('\uc790\uae08 \ubd80\uc871!','r'); return; }
  S.money -= cost;
  syncMoney();
  flash('\uac74\uc124 \uc2dc\uc791!','g');
  closeOv();
}

function demolish() {
  if (!hovEl) return;
  const cost   = parseInt(hovEl.dataset.cost || '0');
  const refund = Math.floor(cost * 0.5);
  S.money += refund;
  syncMoney();
  flash('\ucca0\uac70 \uc644\ub8cc \u2014 \u20a9' + fmt(refund) + ' \ud658\ubd88', 'a');
  closeOv();
}

function syncMoney() {
  const v = fmt(S.money);
  const a = document.getElementById('r-money');
  const b = document.getElementById('top-money');
  if (a) a.textContent = v;
  if (b) b.textContent = v;
}

function flash(msg, cls) {
  const d = document.createElement('div');
  d.className = 'flash ' + cls;
  d.textContent = msg;
  document.body.appendChild(d);
  setTimeout(() => { d.style.opacity = '0'; }, 1100);
  setTimeout(() => { d.remove(); }, 1700);
}

// ─── BUILDING EVENTS ───────────────────────────────────────────
let ovTmr;
document.querySelectorAll('.bld').forEach(el => {
  el.addEventListener('mouseenter', () => { clearTimeout(ovTmr); openOv(el); });
  el.addEventListener('mouseleave', () => {
    ovTmr = setTimeout(() => { if (!ov.matches(':hover')) closeOv(); }, 160);
  });
});
ov.addEventListener('mouseenter', () => clearTimeout(ovTmr));
ov.addEventListener('mouseleave', closeOv);
document.addEventListener('keydown', e => { if (e.key==='Escape') closeOv(); });

// ─── SCROLL DRAG ───────────────────────────────────────────────
const ws = document.getElementById('ws');
let drag=false, dragX, dragSL;
ws.addEventListener('mousedown', e => {
  if (e.target.closest('.bld')) return;
  drag=true; dragX=e.pageX-ws.offsetLeft; dragSL=ws.scrollLeft;
  ws.style.cursor='grabbing';
});
document.addEventListener('mouseup', () => { drag=false; ws.style.cursor='grab'; });
ws.addEventListener('mousemove', e => {
  if (!drag) return;
  e.preventDefault();
  ws.scrollLeft = dragSL - (e.pageX - ws.offsetLeft - dragX) * 1.4;
});

// ─── SYS STATUS ────────────────────────────────────────────────
const SYS = ['NOMINAL','NOMINAL','NOMINAL','WARN:LOX','NOMINAL','CRIT:GH2','NOMINAL','NOMINAL'];
let syi = 0;
setInterval(() => {
  syi = (syi+1) % SYS.length;
  const el = document.getElementById('sys-st');
  if (!el) return;
  const m = SYS[syi];
  el.textContent = m;
  el.style.color = m==='NOMINAL'      ? 'var(--green-mid)' :
                   m.startsWith('CRIT')? 'var(--red)'      : 'var(--amber)';
}, 3200);
</script>
</body>
</html>
