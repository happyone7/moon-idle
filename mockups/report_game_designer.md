# MoonIdle 기획팀장 개선 제안서

**작성자**: 기획팀장 (game-designer)
**작성일**: 2026-02-20
**분석 대상 브랜치**: sprint/1
**분석 파일**: game-data.js / game-state.js / research.js / assembly.js / launch.js / world.js

---

## 1. 게임 전체 평가

### 강점

**1. 코어 루프 구조의 명확성**
생산(Production) → 연구(Research) → 조립(Assembly) → 발사(Launch) 순서가 직관적이다. 각 탭이 단계적으로 언락되는 구조는 플레이어에게 점진적인 목표를 제공하며, 온보딩 퀘스트(sub missions 7단계)가 초반 진입 장벽을 낮춰 준다.

**2. 콘텐츠 깊이**
건물 13종 + 건물별 named 업그레이드 + 레벨 업그레이드(슬롯) + A/B 애드온 선택이 층위별로 분리되어 있다. 단순 클릭형 방치형 게임 대비 의사결정 밀도가 높다.

**3. 인원 배치 시스템의 독창성**
단순 "건물 N개 보유 → 생산량 N배" 공식을 탈피하여, 인원(Worker)을 슬롯에 배치해야만 생산이 발생하는 메커니즘은 자원 배분의 전략성을 부여한다. 방치형 장르에서 보기 드문 구조다.

**4. 로켓 공학 시뮬레이션 요소**
`getRocketScience()` 함수가 ISP, 건조질량, 추진제 질량, 추력, 델타-V, TWR, 신뢰도를 실제 치손킨-치오르코프스키 공식 기반으로 계산한다. 테마의 리얼리티가 게임 수치에 직접 반영되어 있어, 우주 테마에 관심 있는 플레이어에게 강한 흡인력을 줄 수 있다.

**5. 문스톤 재투자 루프**
`getMoonstoneMult()` → 전체 생산량 +5%/문스톤. 발사 횟수(launches/4)마다 보너스 증가로, 장기 플레이 보상이 누적된다.

---

### 약점

**1. 초반 자금 생산 병목 — 치명적**
게임 시작 시 `ops_center` 하나뿐인데 인원 1명만 존재한다. `ops_center.baseRate = 25/s`이지만, 인원 1명 기준 첫 번째 유의미한 구매(mine: money:100)까지 4초, 연구소(research_lab: money:300)까지 12초면 가능하다. 그러나 `supply_depot(money:500, metal:200)`, `extractor(money:500, metal:200)` 같은 2단계 건물은 금속 의존도 때문에 자금-금속 교차 병목이 발생한다. mine(metal:1.2/s)이 느려 사실상 플레이어가 수분간 아무것도 못 하는 구간이 생긴다.

**2. 연구 포인트(RP) 수급 구조의 심각한 문제**
`research_lab.baseRate = 0.5 RP/s`(인원 1명 기준). 첫 연구인 `hire_worker_1`은 RP:20, `basic_prod`은 RP:10이지만, 연구소를 산 직후 한 명밖에 없는 인원을 연구소에 배치하면 ops_center 수익이 0이 된다. 이 딜레마가 설명 없이 플레이어에게 노출된다.

**3. 조립 → 발사 원클릭 완결이지만 보상 공식이 불투명**
`getMoonstoneReward()`에서 `Math.floor((sci.altitude / 20) * q.rewardMult) + fusionBonus + Math.floor(gs.launches / 4)`로 계산되는데, PROTO-MK1 기준 고도는 `clamp(deltaV * 22, 0, 400)`이므로 초반 고도 ≈ 138km → 보상 ≈ Math.floor(138/20 * 1.0) = 6문스톤. 이 공식이 UI에 노출되지 않아 플레이어가 "왜 이만큼 받는지" 이해하기 어렵다.

**4. 신뢰도(Reliability) 페널티 부재**
`getRocketScience()` 계산에서 신뢰도는 표시만 되고, 실제 발사 성공/실패 판정이 없다. `_runLaunchAnimation()`에서 성공/실패 분기가 없으므로 신뢰도를 올릴 동기가 약하다. 숫자는 있지만 결과에 영향을 주지 않는다.

**5. 오프라인 보상의 무의미한 상한선**
`calcOffline()`에서 `Math.min((now - gs.lastTick) / 1000, 8 * 3600)` — 최대 8시간 오프라인 생산만 인정한다. 방치형 게임 표준으로는 적절하지만, 조립 완료(assembly job)는 오프라인 중 `updateAssemblyJobs(now)` 호출로 완료 처리가 되는 반면 문스톤 지급은 이루어지지 않는다. 오프라인 중 발사 처리는 없다.

**6. 인원 상한 확장이 단선적**
Worker 증가 경로: `housing` 건설(+1) → `hire_worker_1` 연구(+1) → `hsg_dorm`(+2) → `hsg_welfare`(+3) → `hsg_township`(+5). 최대 인원 합계 = 1 + 1 + 2 + 3 + 5 = 12명. 건물이 13종이고 슬롯 업그레이드를 고려하면 인원이 항상 부족하므로, 배분 최적화가 전략의 전부가 될 수 있다.

---

## 2. 핵심 루프 분석

### 루프 흐름도

```
[자금 생산] → [건물 구매] → [연구 포인트 생산] → [연구 완료]
     ↑               ↓                                    ↓
     └──────────────────────────────────────────[새 건물/멀티플라이어 언락]
                                                          ↓
                                             [로켓 부품 제작 (5종)]
                                                          ↓
                                             [조립 슬롯에서 조립 대기]
                                                          ↓
                                                   [발사 → 문스톤]
                                                          ↓
                                             [전체 생산량 +5%/문스톤]
```

### 루프별 분석

**생산 루프 (Production)**
- 인원 배치 → 건물 생산. 생산량 = `baseRate * assigned * prodMult * globalMult * moonstoneMult * solarBonus * bldProdMult * bldUpgradeMult * addonMult`
- 멀티플라이어 체인이 7단계나 중첩되어 있어 수치 투명성이 낮다. 플레이어가 단일 건물의 실제 생산량을 직관적으로 파악하기 어렵다.
- `solar_array`의 +10%/개 보너스는 전체 생산에 곱해지지만, 보너스 건물이라 인원 배치가 필요 없다. 이는 다른 건물과 비교했을 때 성능 대비 비용(money:800, electronics:200)이 지나치게 강하다.

**연구 루프 (Research)**
- 6개 티어, 16개 연구 노드가 선행 연구 DAG 구조로 연결됨.
- TIER-0(기초) → TIER-5(임무)까지 선형 의존성이 강해 "어느 경로로 먼저 투자할까"의 선택지가 제한적이다.
- `alloy` 연구(research:150, metal:500)가 `rocket_eng`의 선행이고, `drill` 연구의 선행이기도 해서, 금속 500을 모으는 시간이 중반 진행의 주요 병목이 된다.

**조립 루프 (Assembly)**
- 부품 5종 제작(즉시) → 조립 슬롯에서 타이머 대기(30~240초) → 발사 준비 상태
- `craftPart()` 함수가 `if (gs.parts[pid]) { notify('이미 제작됨'); return; }` 조건으로, 부품이 이미 있으면 재제작이 불가능하다. 즉, 복수 슬롯을 동시에 운용하려면 슬롯마다 부품 세트가 필요하지만 현재 데이터 구조상 `gs.parts`는 0/1 플래그다. 슬롯 2개 이상 운용 시 첫 슬롯 발사 후 두 번째 슬롯 시작이 가능한 구조이지만, 부품 인벤토리 개념 자체가 바이너리라 "연속 조립" 흐름이 매끄럽지 않다.

**발사 루프 (Launch)**
- 텔레메트리 애니메이션(3.5초) → 결과 패널 → 문스톤 획득
- 문스톤 획득이 `pendingLaunchMs`에만 기록되고, 실제로 `gs.moonstone`에 더해지는 코드가 launch.js 내에서 확인되지 않는다. (`_showLaunchOverlay`에서 "획득 예정"으로 표시되는데 확인 버튼 없이 자동 지급인지 수동 확인인지 불명확하다.)

---

## 3. 밸런싱 이슈

### 3-1. 초반 자금 생산량 vs 건물 비용

| 시점 | 자금 생산 (ops_center 1개, 인원 1명) | 목표 비용 | 대기 시간 |
|------|--------------------------------------|-----------|-----------|
| 게임 시작 | 25/s | mine: 100 | 4초 |
| mine 구매 후 | 25/s (금속 추가) | research_lab: 300 | 12초 |
| research_lab 구매 후 | 25/s + RP 0.5/s | basic_prod: RP 10 | RP 20초 |
| 연구 2개 완료 후 | 25/s | supply_depot: money:500 + metal:200 | 자금 20초 + 금속 ≈ 167초 |

**문제**: `supply_depot` 건설에 필요한 `metal:200`을 mine(1.2/s) 1개로 모으려면 약 167초(2.8분)가 필요하다. 초반에 자금은 넘쳐도 금속이 병목이 되는 구간이 2~3분 지속된다. 방치형 게임 기준으로 초반 2~3분의 대기는 신규 플레이어 이탈 임계점이다.

**권장 조정**:
- `mine.baseRate`: 1.2/s → **2.0/s** (+67%)
- 또는 `extractor.baseCost.metal`: 200 → **100** (진입 장벽 완화)

### 3-2. 연구 포인트 수급 타이밍

| 연구 | RP 비용 | research_lab 1개(0.5/s) 기준 적립 시간 |
|------|---------|----------------------------------------|
| hire_worker_1 | 20 | 40초 |
| basic_prod | 10 | 20초 |
| drill | 50 | 100초 (1.7분) |
| fuel_chem | 60 + metal:50 | 120초 RP + 금속 병목 |
| electronics_basics | 80 | 160초 (2.7분) |
| alloy | 150 + metal:500 | 300초 RP + 금속 **417초** (7분) |
| rocket_eng | 200 + metal:300 | 400초 RP + 금속 250초 |

**문제**: `alloy` 연구는 RP 비용보다 metal:500이 실질 병목이다. R&D 센터(research_lab × 여러 개 + 업그레이드) 없이 RP가 부족해서 막히는 구간은 TIER-2 이전까지다. 그러나 metal:500은 extractor(3.5/s) 기준으로도 143초가 필요하다.

**권장 조정**:
- `alloy.cost.metal`: 500 → **300** (연구 진입 완화)
- `r_and_d` 언락을 `alloy` 선행에서 독립시켜 `microchip` 완료 후에도 가능하도록 경로 분기 추가

### 3-3. 조립 슬롯 vs 부품 제작 시간

| 품질 등급 | 조립 시간 | 부품 제작 조건 |
|-----------|-----------|----------------|
| PROTO-MK1 | 30초 | 즉시 (클릭) |
| STD-MK2 | 60초 | costMult:2.0 |
| ADV-MK3 | 120초 | costMult:4.0 |
| ELITE-MK4 | 240초 | costMult:8.0 |

**조립 비용 계산식**: `PARTS 비용 합 × quality.costMult × 0.32`

PROTO-MK1 기준 조립 비용:
- engine: metal:80, fuel:40, electronics:20
- fueltank: metal:60, fuel:60
- control: electronics:80, research:30
- hull: metal:100
- payload: electronics:40, research:50

합계: metal:240, fuel:100, electronics:140, research:80 → × 1.0 × 0.32

실제 조립 비용: metal:76, fuel:32, electronics:44, research:25 (소수점 버림 적용)

**문제**: 부품 제작과 조립은 별개 비용 체계인데, `craftPart()`는 즉시 완료이고 조립은 타이머다. 부품을 만들고 "조립 시작" 버튼을 누르는 두 단계 액션의 이유가 플레이어에게 불명확하다. 특히 부품은 발사 후에도 사라지지 않아 다음 조립에 재사용되는 것처럼 보이지만, `abortAssembly()` 호출 시 부품이 반환되지 않는다.

**현재 슬롯 수 계산**: `1 + gs.buildings.launch_pad + slotBonus + getAddonSlotBonus()`
- 기본 1슬롯, 발사대 1개당 +1, `multipad` 연구 +1, VIF 애드온 +1, VIF 자동화 업그레이드 +1
- 최대 슬롯: 5슬롯 (발사대 다수 + 연구 + 애드온)이지만 발사대 비용(money:5000, metal:2000, electronics:500)을 생각하면 실질적으로 2~3슬롯이 현실적인 최대치

---

## 4. 프로그레션 개선안

### 4-1. 언락 타이밍 조정

**현재 문제**: `tab_research`가 기본값 `false`이지만 게임 시작부터 `research_lab`을 살 수 있고, 연구소를 사도 자동으로 탭이 열리지 않는다. (world.js의 `checkAutoUnlocks` 참조 코드가 있지만 실제 구현은 확인 필요)

**제안 언락 타임라인**:

| 단계 | 조건 | 언락 내용 | 예상 플레이 시간 |
|------|------|-----------|----------------|
| 0단계 | 게임 시작 | Housing, Ops Center, Research Lab 표시 | 0분 |
| 1단계 | ops_center에 인원 1명 배치 | 생산 탭 튜토리얼 완료 안내 | 0~1분 |
| 2단계 | research_lab 구매 | 연구 탭 언락 | 1~2분 |
| 3단계 | basic_prod 연구 완료 | mine 언락 | 2~3분 |
| 4단계 | alloy 연구 완료 | rocket_eng 가시화, 조립 탭 예고 | 8~12분 |
| 5단계 | rocket_eng 연구 완료 | 조립 탭 언락 | 12~15분 |
| 6단계 | 첫 조립 완료 | 발사 탭 완전 활성화 | 15~20분 |
| 7단계 | 첫 발사 성공 | 미션 탭 언락 | 20~25분 |

**권장 신규 언락 조건 추가**:
- `tab_research` 자동 언락을 `research_lab` 구매 시 즉시 트리거 (현재 코드는 manual unlock으로 보임)

### 4-2. 신규 마일스톤 제안

**마일스톤 1: "첫 금속 생산" (mine 1개 구매)**
- 보상: RP +5 즉시 지급
- 목적: 초반 "채굴기를 샀다" 피드백 강화

**마일스톤 2: "로켓 설계도 완성" (5개 부품 전부 제작 완료)**
- 보상: 조립 시간 -10% (1회성 영구 버프)
- 목적: 조립 준비 단계의 성취감 부여

**마일스톤 3: "궤도 돌입" (고도 200km 이상 달성)**
- 보상: 문스톤 +5 보너스
- 목적: PROTO에서 STD 품질로의 업그레이드 동기 제공

**마일스톤 4: "달 탐사 시작" (발사 10회 누적)**
- 보상: 전체 생산 +10% 영구 버프
- 목적: 장기 반복 플레이 보상

**마일스톤 5: "산업 단지 완성" (모든 건물 종류 1개씩 보유)**
- 보상: 인원 +2 무료 지급
- 목적: 컨텐츠 탐색 유도

**마일스톤 6: "ELITE 클래스 발사" (ELITE-MK4 품질로 첫 발사)**
- 보상: 문스톤 획득량 +20% 영구 버프
- 목적: 최고 등급 제작에 대한 강한 동기 부여

---

## 5. 방치형 특화 개선

### 5-1. 오프라인 보상 시스템 개선

**현재**: `calcOffline()`에서 자원 생산만 일괄 보상. 조립 완료는 처리되지만 발사는 불가.

**문제점**:
1. 오프라인 중 조립이 완료되어도 문스톤을 자동으로 받지 못한다
2. "오프라인 N분 — 자원 생산 완료" 배너만 표시되어 자세한 내역을 알 수 없다
3. 8시간 상한이 존재하지만 이를 플레이어에게 알리지 않는다

**개선 제안**:

```
오프라인 복귀 보상 정산 화면 (신규 추가):
┌─────────────────────────────┐
│ // 오프라인 복귀 보고서      │
│ 경과 시간: 3h 24m           │
│                              │
│ 자원 수익:                   │
│  ₩ +45,200                  │
│  Fe +1,840                   │
│  LOX +720                    │
│  PCB +330                    │
│                              │
│ 조립 완료: STD-MK2 ×1       │
│ 자동 발사: 1회 실행          │
│ 문스톤 획득: +8개            │
│                              │
│ [ 확인 ]                     │
└─────────────────────────────┘
```

**자동 발사 로직 추가 제안**:
오프라인 중 조립이 완료된 슬롯은 자동으로 발사 처리(신뢰도 기반 성공률 계산)하여 문스톤을 지급. 이는 방치형 게임의 핵심 보상인 "돌아왔을 때 진행되어 있는 느낌"을 강화한다.

### 5-2. 장기 방치 최적화 인터페이스

**현재 문제**: 인원 배치가 매번 수동이라 세션 복귀 시 재배치 필요.

**개선 제안**: "인원 자동 배치 프리셋" 기능 추가
- 슬롯마다 배치 비율(예: "연구소 50%, 광산 30%, 정제소 20%")을 저장
- 복귀 시 프리셋 자동 적용

### 5-3. 오프라인 방치 최적화를 위한 "생산 자동화" 연구 노드 효과 강화

현재 `automation` 연구(research:200, electronics:200)의 효과가 "전체 생산 ×1.5"인데, 방치 게임의 핵심 연구임에도 단순 배율 증가에 그친다.

**개선 제안**: `automation` 연구 완료 시 추가로
- "인원 자동 재배치" 기능 언락 (세션 복귀 시 이전 배치 기억)
- 조립 슬롯 "자동 재시작" 옵션 언락 (발사 후 즉시 다음 조립 시작)

### 5-4. 푸시 알림 / 탭 숨김 알림

현재 `tab_title` 갱신 기능이 없다. 브라우저 탭 제목에 "조립 완료 - MoonIdle" 같이 표시하면 방치 중 복귀 유도가 가능하다.

**개선 제안**: `document.title` 동적 업데이트
- 조립 완료 시: "[발사 준비] MoonIdle"
- 평상시: "MoonIdle | [생산량/s]"

---

## 6. 우선순위 TOP 5 실행 과제

### TASK-1 (최우선): 발사 신뢰도 실패 처리 구현

**문제**: 신뢰도 수치가 표시만 될 뿐 결과에 영향을 주지 않아 게임의 핵심 긴장감이 없다.

**구현 방향**:
```
launchFromSlot() 내:
  const rollSuccess = Math.random() * 100 < sci.reliability;
  if (rollSuccess) {
    gs.moonstone += earned;
    // 성공 애니메이션
  } else {
    // 폭발 애니메이션
    // 부품 일부 손실 또는 다음 발사 신뢰도 패널티
  }
```
**효과**: 신뢰도 강화 업그레이드들(reliability 연구, pad_reinforce, ctrl_ai 등)에 실질적 의미 부여. "98% 신뢰도를 달성해야 안전하다"는 긴장감이 핵심 게임플레이가 됨.

**예상 공수**: 프로그래밍팀장 0.5일

---

### TASK-2 (긴급): 문스톤 지급 코드 확인 및 수정

**문제**: `_showLaunchOverlay()`에서 `"문스톤 +N개 획득 예정"`으로만 표시되고, `gs.moonstone += earned` 코드가 launch.js 내에서 확인되지 않는다. (다른 파일에 있을 가능성 있으나 제공된 파일 범위 내 미확인)

**확인 필요**:
- `pendingLaunchMs` 변수를 실제로 소비하는 로직 위치
- 오버레이 닫기 버튼 클릭 시 문스톤 지급 여부

**예상 공수**: 프로그래밍팀장 0.25일 (확인 및 수정)

---

### TASK-3 (중요): 초반 밸런스 조정 패치

구체적 수치 변경:

| 항목 | 현재 | 변경 제안 | 이유 |
|------|------|-----------|------|
| `mine.baseRate` | 1.2/s | 2.0/s | 초반 금속 병목 해소 |
| `alloy.cost.metal` | 500 | 300 | 중반 병목 완화 |
| `research_lab.baseRate` | 0.5/s | 0.8/s | RP 수급 정상화 |
| PROTO-MK1 `timeSec` | 30s | 20s | 첫 조립 체험 속도 개선 |
| `ops_center.baseRate` | 25/s | 30/s | 초반 자금 흐름 개선 |

**예상 공수**: 기획팀장 0.25일 (SO 수치 변경)

---

### TASK-4 (중요): 오프라인 복귀 정산 화면 구현

**구현 내용**:
1. `calcOffline()` 반환값을 상세 내역 객체로 확장
2. 복귀 시 "오프라인 보고서" 모달 표시
3. 조립 완료 슬롯 자동 발사 처리 + 문스톤 지급
4. 내역 확인 후 [확인] 버튼으로 닫기

**효과**: 방치형 게임의 핵심 만족감("돌아왔더니 많이 쌓여 있다") 강화. 재방문율 직결.

**예상 공수**: 프로그래밍팀장 1일, UI팀장 0.5일

---

### TASK-5 (개선): 인원 배치 UX 개선 + 프리셋 기능

**구현 내용**:
1. 인원 배치 현황을 Production 탭 상단에 한눈에 보이는 요약 패널로 추가
2. "전체 철수" 버튼 추가 (재배치를 쉽게 하기 위한)
3. "저장된 배치 프리셋" 기능 추가 (최소 1개 슬롯)

**효과**: 건물 호버 오버레이로만 인원을 조정하는 현재 구조는 전체 배치 현황 파악이 어렵다. 요약 패널로 전략적 의사결정 지원.

**예상 공수**: UI팀장 1일

---

## 부록: 로켓 보상 공식 시각화 제안

현재 문스톤 보상 공식: `floor((altitude / 20) * rewardMult) + fusionBonus + floor(launches / 4)`

이를 조립 탭의 Science Box에 아래와 같이 표시하면 플레이어 이해도가 높아진다:

```
// 보상 계산 분석
기준 고도: 138 km
고도 점수: floor(138 / 20) = 6
품질 배율: ×1.0 (PROTO-MK1)
핵융합 보너스: +0
발사 누적 보너스: +floor(0/4) = 0
-----------------------
예상 문스톤: 6개
```

---

*본 제안서는 sprint/1 브랜치 코드 분석 기준이며, 총괄PD 검토 후 sprint/2 계획에 반영 요청*
